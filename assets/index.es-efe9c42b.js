import{r as ym,g as ld,c as Sr,e as Lr,d as _m,N as nu,f as Ol,_ as mm}from"./index-4c8bc759.js";import{t as bm}from"./tslib.es6-c2094241.js";var su={},zo={},Ue={},fd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(f,g){var w=f>>>16&65535,S=f&65535,T=g>>>16&65535,j=g&65535;return S*j+(w*j+S*T<<16>>>0)|0}n.mul=Math.imul||e;function r(f,g){return f+g|0}n.add=r;function s(f,g){return f-g|0}n.sub=s;function a(f,g){return f<<g|f>>>32-g}n.rotl=a;function l(f,g){return f<<32-g|f>>>g}n.rotr=l;function p(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}n.isInteger=Number.isInteger||p,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(f){return n.isInteger(f)&&f>=-n.MAX_SAFE_INTEGER&&f<=n.MAX_SAFE_INTEGER}})(fd);Object.defineProperty(Ue,"__esModule",{value:!0});var dd=fd;function wm(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Ue.readInt16BE=wm;function Em(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Ue.readUint16BE=Em;function Dm(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Ue.readInt16LE=Dm;function Sm(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Ue.readUint16LE=Sm;function pd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>8,e[r+1]=n>>>0,e}Ue.writeUint16BE=pd;Ue.writeInt16BE=pd;function gd(n,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e}Ue.writeUint16LE=gd;Ue.writeInt16LE=gd;function qc(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Ue.readInt32BE=qc;function zc(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Ue.readUint32BE=zc;function Bc(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Ue.readInt32LE=Bc;function Hc(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Ue.readUint32LE=Hc;function To(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>24,e[r+1]=n>>>16,e[r+2]=n>>>8,e[r+3]=n>>>0,e}Ue.writeUint32BE=To;Ue.writeInt32BE=To;function Fo(n,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=n>>>0,e[r+1]=n>>>8,e[r+2]=n>>>16,e[r+3]=n>>>24,e}Ue.writeUint32LE=Fo;Ue.writeInt32LE=Fo;function Im(n,e){e===void 0&&(e=0);var r=qc(n,e),s=qc(n,e+4);return r*4294967296+s-(s>>31)*4294967296}Ue.readInt64BE=Im;function xm(n,e){e===void 0&&(e=0);var r=zc(n,e),s=zc(n,e+4);return r*4294967296+s}Ue.readUint64BE=xm;function Om(n,e){e===void 0&&(e=0);var r=Bc(n,e),s=Bc(n,e+4);return s*4294967296+r-(r>>31)*4294967296}Ue.readInt64LE=Om;function Cm(n,e){e===void 0&&(e=0);var r=Hc(n,e),s=Hc(n,e+4);return s*4294967296+r}Ue.readUint64LE=Cm;function vd(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),To(n/4294967296>>>0,e,r),To(n>>>0,e,r+4),e}Ue.writeUint64BE=vd;Ue.writeInt64BE=vd;function yd(n,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Fo(n>>>0,e,r),Fo(n/4294967296>>>0,e,r+4),e}Ue.writeUint64LE=yd;Ue.writeInt64LE=yd;function Am(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,a=1,l=n/8+r-1;l>=r;l--)s+=e[l]*a,a*=256;return s}Ue.readUintBE=Am;function Pm(n,e,r){if(r===void 0&&(r=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,a=1,l=r;l<r+n/8;l++)s+=e[l]*a,a*=256;return s}Ue.readUintLE=Pm;function Rm(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!dd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var a=1,l=n/8+s-1;l>=s;l--)r[l]=e/a&255,a*=256;return r}Ue.writeUintBE=Rm;function Nm(n,e,r,s){if(r===void 0&&(r=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!dd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var a=1,l=s;l<s+n/8;l++)r[l]=e/a&255,a*=256;return r}Ue.writeUintLE=Nm;function Tm(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e)}Ue.readFloat32BE=Tm;function Fm(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(e,!0)}Ue.readFloat32LE=Fm;function $m(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e)}Ue.readFloat64BE=$m;function Um(n,e){e===void 0&&(e=0);var r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(e,!0)}Ue.readFloat64LE=Um;function Mm(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n),e}Ue.writeFloat32BE=Mm;function Lm(n,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(r,n,!0),e}Ue.writeFloat32LE=Lm;function jm(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n),e}Ue.writeFloat64BE=jm;function qm(n,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(r,n,!0),e}Ue.writeFloat64LE=qm;var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});function zm(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Ir.wipe=zm;Object.defineProperty(zo,"__esModule",{value:!0});var Zt=Ue,Kc=Ir,Bm=20;function Hm(n,e,r){for(var s=1634760805,a=857760878,l=2036477234,p=1797285236,f=r[3]<<24|r[2]<<16|r[1]<<8|r[0],g=r[7]<<24|r[6]<<16|r[5]<<8|r[4],w=r[11]<<24|r[10]<<16|r[9]<<8|r[8],S=r[15]<<24|r[14]<<16|r[13]<<8|r[12],T=r[19]<<24|r[18]<<16|r[17]<<8|r[16],j=r[23]<<24|r[22]<<16|r[21]<<8|r[20],P=r[27]<<24|r[26]<<16|r[25]<<8|r[24],M=r[31]<<24|r[30]<<16|r[29]<<8|r[28],H=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],C=e[15]<<24|e[14]<<16|e[13]<<8|e[12],$=s,D=a,x=l,m=p,c=f,_=g,k=w,G=S,oe=T,ce=j,ge=P,R=M,z=H,le=K,te=ie,W=C,ee=0;ee<Bm;ee+=2)$=$+c|0,z^=$,z=z>>>32-16|z<<16,oe=oe+z|0,c^=oe,c=c>>>32-12|c<<12,D=D+_|0,le^=D,le=le>>>32-16|le<<16,ce=ce+le|0,_^=ce,_=_>>>32-12|_<<12,x=x+k|0,te^=x,te=te>>>32-16|te<<16,ge=ge+te|0,k^=ge,k=k>>>32-12|k<<12,m=m+G|0,W^=m,W=W>>>32-16|W<<16,R=R+W|0,G^=R,G=G>>>32-12|G<<12,x=x+k|0,te^=x,te=te>>>32-8|te<<8,ge=ge+te|0,k^=ge,k=k>>>32-7|k<<7,m=m+G|0,W^=m,W=W>>>32-8|W<<8,R=R+W|0,G^=R,G=G>>>32-7|G<<7,D=D+_|0,le^=D,le=le>>>32-8|le<<8,ce=ce+le|0,_^=ce,_=_>>>32-7|_<<7,$=$+c|0,z^=$,z=z>>>32-8|z<<8,oe=oe+z|0,c^=oe,c=c>>>32-7|c<<7,$=$+_|0,W^=$,W=W>>>32-16|W<<16,ge=ge+W|0,_^=ge,_=_>>>32-12|_<<12,D=D+k|0,z^=D,z=z>>>32-16|z<<16,R=R+z|0,k^=R,k=k>>>32-12|k<<12,x=x+G|0,le^=x,le=le>>>32-16|le<<16,oe=oe+le|0,G^=oe,G=G>>>32-12|G<<12,m=m+c|0,te^=m,te=te>>>32-16|te<<16,ce=ce+te|0,c^=ce,c=c>>>32-12|c<<12,x=x+G|0,le^=x,le=le>>>32-8|le<<8,oe=oe+le|0,G^=oe,G=G>>>32-7|G<<7,m=m+c|0,te^=m,te=te>>>32-8|te<<8,ce=ce+te|0,c^=ce,c=c>>>32-7|c<<7,D=D+k|0,z^=D,z=z>>>32-8|z<<8,R=R+z|0,k^=R,k=k>>>32-7|k<<7,$=$+_|0,W^=$,W=W>>>32-8|W<<8,ge=ge+W|0,_^=ge,_=_>>>32-7|_<<7;Zt.writeUint32LE($+s|0,n,0),Zt.writeUint32LE(D+a|0,n,4),Zt.writeUint32LE(x+l|0,n,8),Zt.writeUint32LE(m+p|0,n,12),Zt.writeUint32LE(c+f|0,n,16),Zt.writeUint32LE(_+g|0,n,20),Zt.writeUint32LE(k+w|0,n,24),Zt.writeUint32LE(G+S|0,n,28),Zt.writeUint32LE(oe+T|0,n,32),Zt.writeUint32LE(ce+j|0,n,36),Zt.writeUint32LE(ge+P|0,n,40),Zt.writeUint32LE(R+M|0,n,44),Zt.writeUint32LE(z+H|0,n,48),Zt.writeUint32LE(le+K|0,n,52),Zt.writeUint32LE(te+ie|0,n,56),Zt.writeUint32LE(W+C|0,n,60)}function _d(n,e,r,s,a){if(a===void 0&&(a=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<r.length)throw new Error("ChaCha: destination is shorter than source");var l,p;if(a===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");l=new Uint8Array(16),p=l.length-e.length,l.set(e,p)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");l=e,p=a}for(var f=new Uint8Array(64),g=0;g<r.length;g+=64){Hm(f,l,n);for(var w=g;w<g+64&&w<r.length;w++)s[w]=r[w]^f[w-g];km(l,0,p)}return Kc.wipe(f),a===0&&Kc.wipe(l),s}zo.streamXOR=_d;function Km(n,e,r,s){return s===void 0&&(s=0),Kc.wipe(r),_d(n,e,r,r,s)}zo.stream=Km;function km(n,e,r){for(var s=1;r--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var md={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});function Vm(n,e,r){return~(n-1)&e|n-1&r}Ti.select=Vm;function Gm(n,e){return(n|0)-(e|0)-1>>>31&1}Ti.lessOrEqual=Gm;function bd(n,e){if(n.length!==e.length)return 0;for(var r=0,s=0;s<n.length;s++)r|=n[s]^e[s];return 1&r-1>>>8}Ti.compare=bd;function Wm(n,e){return n.length===0||e.length===0?!1:bd(n,e)!==0}Ti.equal=Wm;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ti,r=Ir;n.DIGEST_LENGTH=16;var s=function(){function p(f){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var w=f[2]|f[3]<<8;this._r[1]=(g>>>13|w<<3)&8191;var S=f[4]|f[5]<<8;this._r[2]=(w>>>10|S<<6)&7939;var T=f[6]|f[7]<<8;this._r[3]=(S>>>7|T<<9)&8191;var j=f[8]|f[9]<<8;this._r[4]=(T>>>4|j<<12)&255,this._r[5]=j>>>1&8190;var P=f[10]|f[11]<<8;this._r[6]=(j>>>14|P<<2)&8191;var M=f[12]|f[13]<<8;this._r[7]=(P>>>11|M<<5)&8065;var H=f[14]|f[15]<<8;this._r[8]=(M>>>8|H<<8)&8191,this._r[9]=H>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return p.prototype._blocks=function(f,g,w){for(var S=this._fin?0:2048,T=this._h[0],j=this._h[1],P=this._h[2],M=this._h[3],H=this._h[4],K=this._h[5],ie=this._h[6],C=this._h[7],$=this._h[8],D=this._h[9],x=this._r[0],m=this._r[1],c=this._r[2],_=this._r[3],k=this._r[4],G=this._r[5],oe=this._r[6],ce=this._r[7],ge=this._r[8],R=this._r[9];w>=16;){var z=f[g+0]|f[g+1]<<8;T+=z&8191;var le=f[g+2]|f[g+3]<<8;j+=(z>>>13|le<<3)&8191;var te=f[g+4]|f[g+5]<<8;P+=(le>>>10|te<<6)&8191;var W=f[g+6]|f[g+7]<<8;M+=(te>>>7|W<<9)&8191;var ee=f[g+8]|f[g+9]<<8;H+=(W>>>4|ee<<12)&8191,K+=ee>>>1&8191;var J=f[g+10]|f[g+11]<<8;ie+=(ee>>>14|J<<2)&8191;var re=f[g+12]|f[g+13]<<8;C+=(J>>>11|re<<5)&8191;var xe=f[g+14]|f[g+15]<<8;$+=(re>>>8|xe<<8)&8191,D+=xe>>>5|S;var ne=0,be=ne;be+=T*x,be+=j*(5*R),be+=P*(5*ge),be+=M*(5*ce),be+=H*(5*oe),ne=be>>>13,be&=8191,be+=K*(5*G),be+=ie*(5*k),be+=C*(5*_),be+=$*(5*c),be+=D*(5*m),ne+=be>>>13,be&=8191;var he=ne;he+=T*m,he+=j*x,he+=P*(5*R),he+=M*(5*ge),he+=H*(5*ce),ne=he>>>13,he&=8191,he+=K*(5*oe),he+=ie*(5*G),he+=C*(5*k),he+=$*(5*_),he+=D*(5*c),ne+=he>>>13,he&=8191;var _e=ne;_e+=T*c,_e+=j*m,_e+=P*x,_e+=M*(5*R),_e+=H*(5*ge),ne=_e>>>13,_e&=8191,_e+=K*(5*ce),_e+=ie*(5*oe),_e+=C*(5*G),_e+=$*(5*k),_e+=D*(5*_),ne+=_e>>>13,_e&=8191;var q=ne;q+=T*_,q+=j*c,q+=P*m,q+=M*x,q+=H*(5*R),ne=q>>>13,q&=8191,q+=K*(5*ge),q+=ie*(5*ce),q+=C*(5*oe),q+=$*(5*G),q+=D*(5*k),ne+=q>>>13,q&=8191;var L=ne;L+=T*k,L+=j*_,L+=P*c,L+=M*m,L+=H*x,ne=L>>>13,L&=8191,L+=K*(5*R),L+=ie*(5*ge),L+=C*(5*ce),L+=$*(5*oe),L+=D*(5*G),ne+=L>>>13,L&=8191;var A=ne;A+=T*G,A+=j*k,A+=P*_,A+=M*c,A+=H*m,ne=A>>>13,A&=8191,A+=K*x,A+=ie*(5*R),A+=C*(5*ge),A+=$*(5*ce),A+=D*(5*oe),ne+=A>>>13,A&=8191;var h=ne;h+=T*oe,h+=j*G,h+=P*k,h+=M*_,h+=H*c,ne=h>>>13,h&=8191,h+=K*m,h+=ie*x,h+=C*(5*R),h+=$*(5*ge),h+=D*(5*ce),ne+=h>>>13,h&=8191;var I=ne;I+=T*ce,I+=j*oe,I+=P*G,I+=M*k,I+=H*_,ne=I>>>13,I&=8191,I+=K*c,I+=ie*m,I+=C*x,I+=$*(5*R),I+=D*(5*ge),ne+=I>>>13,I&=8191;var se=ne;se+=T*ge,se+=j*ce,se+=P*oe,se+=M*G,se+=H*k,ne=se>>>13,se&=8191,se+=K*_,se+=ie*c,se+=C*m,se+=$*x,se+=D*(5*R),ne+=se>>>13,se&=8191;var fe=ne;fe+=T*R,fe+=j*ge,fe+=P*ce,fe+=M*oe,fe+=H*G,ne=fe>>>13,fe&=8191,fe+=K*k,fe+=ie*_,fe+=C*c,fe+=$*m,fe+=D*x,ne+=fe>>>13,fe&=8191,ne=(ne<<2)+ne|0,ne=ne+be|0,be=ne&8191,ne=ne>>>13,he+=ne,T=be,j=he,P=_e,M=q,H=L,K=A,ie=h,C=I,$=se,D=fe,g+=16,w-=16}this._h[0]=T,this._h[1]=j,this._h[2]=P,this._h[3]=M,this._h[4]=H,this._h[5]=K,this._h[6]=ie,this._h[7]=C,this._h[8]=$,this._h[9]=D},p.prototype.finish=function(f,g){g===void 0&&(g=0);var w=new Uint16Array(10),S,T,j,P;if(this._leftover){for(P=this._leftover,this._buffer[P++]=1;P<16;P++)this._buffer[P]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(S=this._h[1]>>>13,this._h[1]&=8191,P=2;P<10;P++)this._h[P]+=S,S=this._h[P]>>>13,this._h[P]&=8191;for(this._h[0]+=S*5,S=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=S,S=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=S,w[0]=this._h[0]+5,S=w[0]>>>13,w[0]&=8191,P=1;P<10;P++)w[P]=this._h[P]+S,S=w[P]>>>13,w[P]&=8191;for(w[9]-=8192,T=(S^1)-1,P=0;P<10;P++)w[P]&=T;for(T=~T,P=0;P<10;P++)this._h[P]=this._h[P]&T|w[P];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,j=this._h[0]+this._pad[0],this._h[0]=j&65535,P=1;P<8;P++)j=(this._h[P]+this._pad[P]|0)+(j>>>16)|0,this._h[P]=j&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(f){var g=0,w=f.length,S;if(this._leftover){S=16-this._leftover,S>w&&(S=w);for(var T=0;T<S;T++)this._buffer[this._leftover+T]=f[g+T];if(w-=S,g+=S,this._leftover+=S,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(w>=16&&(S=w-w%16,this._blocks(f,g,S),g+=S,w-=S),w){for(var T=0;T<w;T++)this._buffer[this._leftover+T]=f[g+T];this._leftover+=w}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},p.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();n.Poly1305=s;function a(p,f){var g=new s(p);g.update(f);var w=g.digest();return g.clean(),w}n.oneTimeAuth=a;function l(p,f){return p.length!==n.DIGEST_LENGTH||f.length!==n.DIGEST_LENGTH?!1:e.equal(p,f)}n.equal=l})(md);(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=zo,r=md,s=Ir,a=Ue,l=Ti;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var p=new Uint8Array(16),f=function(){function g(w){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,w.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return g.prototype.seal=function(w,S,T,j){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var P=new Uint8Array(16);P.set(w,P.length-w.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var H=S.length+this.tagLength,K;if(j){if(j.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");K=j}else K=new Uint8Array(H);return e.streamXOR(this._key,P,S,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),M,K.subarray(0,K.length-this.tagLength),T),s.wipe(P),K},g.prototype.open=function(w,S,T,j){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(S.length<this.tagLength)return null;var P=new Uint8Array(16);P.set(w,P.length-w.length);var M=new Uint8Array(32);e.stream(this._key,P,M,4);var H=new Uint8Array(this.tagLength);if(this._authenticate(H,M,S.subarray(0,S.length-this.tagLength),T),!l.equal(H,S.subarray(S.length-this.tagLength,S.length)))return null;var K=S.length-this.tagLength,ie;if(j){if(j.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=j}else ie=new Uint8Array(K);return e.streamXOR(this._key,P,S.subarray(0,S.length-this.tagLength),ie,4),s.wipe(P),ie},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(w,S,T,j){var P=new r.Poly1305(S);j&&(P.update(j),j.length%16>0&&P.update(p.subarray(j.length%16))),P.update(T),T.length%16>0&&P.update(p.subarray(T.length%16));var M=new Uint8Array(8);j&&a.writeUint64LE(j.length,M),P.update(M),a.writeUint64LE(T.length,M),P.update(M);for(var H=P.digest(),K=0;K<H.length;K++)w[K]=H[K];P.clean(),s.wipe(H),s.wipe(M)},g}();n.ChaCha20Poly1305=f})(su);var wd={},ys={},ou={};Object.defineProperty(ou,"__esModule",{value:!0});function Jm(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}ou.isSerializableHash=Jm;Object.defineProperty(ys,"__esModule",{value:!0});var Zr=ou,Ym=Ti,Xm=Ir,Ed=function(){function n(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(s).clean():s.set(r);for(var a=0;a<s.length;a++)s[a]^=54;this._inner.update(s);for(var a=0;a<s.length;a++)s[a]^=106;this._outer.update(s),Zr.isSerializableHash(this._inner)&&Zr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Xm.wipe(s)}return n.prototype.reset=function(){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Zr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Zr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!Zr.isSerializableHash(this._inner)||!Zr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!Zr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();ys.HMAC=Ed;function Qm(n,e,r){var s=new Ed(n,e);s.update(r);var a=s.digest();return s.clean(),a}ys.hmac=Qm;ys.equal=Ym.equal;Object.defineProperty(wd,"__esModule",{value:!0});var Cl=ys,Al=Ir,Zm=function(){function n(e,r,s,a){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=a;var l=Cl.hmac(this._hash,s,r);this._hmac=new Cl.HMAC(e,l),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var r=new Uint8Array(e),s=0;s<r.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[s]=this._buffer[this._bufpos++];return r},n.prototype.clean=function(){this._hmac.clean(),Al.wipe(this._buffer),Al.wipe(this._counter),this._bufpos=0},n}(),eb=wd.HKDF=Zm,Rn={},Bo={},Ho={};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.BrowserRandomSource=void 0;const Pl=65536;class tb{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let s=0;s<r.length;s+=Pl)this._crypto.getRandomValues(r.subarray(s,s+Math.min(r.length-s,Pl)));return r}}Ho.BrowserRandomSource=tb;function rb(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ko={};Object.defineProperty(Ko,"__esModule",{value:!0});Ko.NodeRandomSource=void 0;const ib=Ir;class nb{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof rb<"u"){const e=ym;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let a=0;a<s.length;a++)s[a]=r[a];return(0,ib.wipe)(r),s}}Ko.NodeRandomSource=nb;Object.defineProperty(Bo,"__esModule",{value:!0});Bo.SystemRandomSource=void 0;const sb=Ho,ob=Ko;class ab{constructor(){if(this.isAvailable=!1,this.name="",this._source=new sb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ob.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Bo.SystemRandomSource=ab;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Bo,r=Ue,s=Ir;n.defaultRandomSource=new e.SystemRandomSource;function a(w,S=n.defaultRandomSource){return S.randomBytes(w)}n.randomBytes=a;function l(w=n.defaultRandomSource){const S=a(4,w),T=(0,r.readUint32LE)(S);return(0,s.wipe)(S),T}n.randomUint32=l;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(w,S=p,T=n.defaultRandomSource){if(S.length<2)throw new Error("randomString charset is too short");if(S.length>256)throw new Error("randomString charset is too long");let j="";const P=S.length,M=256-256%P;for(;w>0;){const H=a(Math.ceil(w*256/M),T);for(let K=0;K<H.length&&w>0;K++){const ie=H[K];ie<M&&(j+=S.charAt(ie%P),w--)}(0,s.wipe)(H)}return j}n.randomString=f;function g(w,S=p,T=n.defaultRandomSource){const j=Math.ceil(w/(Math.log(S.length)/Math.LN2));return f(j,S,T)}n.randomStringForEntropy=g})(Rn);var ko={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,r=Ir;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},f.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var S=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&w>0;)this._buffer[this._bufferLength++]=g[S++],w--;this._bufferLength===this.blockSize&&(l(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(S=l(this._temp,this._state,g,S,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[S++],w--;return this},f.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,S=this._bufferLength,T=w/536870912|0,j=w<<3,P=w%64<56?64:128;this._buffer[S]=128;for(var M=S+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(T,this._buffer,P-8),e.writeUint32BE(j,this._buffer,P-4),l(this._temp,this._state,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/4;M++)e.writeUint32BE(this._state[M],g,M*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.state),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA256=s;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function l(f,g,w,S,T){for(;T>=64;){for(var j=g[0],P=g[1],M=g[2],H=g[3],K=g[4],ie=g[5],C=g[6],$=g[7],D=0;D<16;D++){var x=S+D*4;f[D]=e.readUint32BE(w,x)}for(var D=16;D<64;D++){var m=f[D-2],c=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=f[D-15];var _=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;f[D]=(c+f[D-7]|0)+(_+f[D-16]|0)}for(var D=0;D<64;D++){var c=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&ie^~K&C)|0)+($+(a[D]+f[D]|0)|0)|0,_=((j>>>2|j<<32-2)^(j>>>13|j<<32-13)^(j>>>22|j<<32-22))+(j&P^j&M^P&M)|0;$=C,C=ie,ie=K,K=H+c|0,H=M,M=P,P=j,j=c+_|0}g[0]+=j,g[1]+=P,g[2]+=M,g[3]+=H,g[4]+=K,g[5]+=ie,g[6]+=C,g[7]+=$,S+=64,T-=64}return S}function p(f){var g=new s;g.update(f);var w=g.digest();return g.clean(),w}n.hash=p})(ko);var au={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=Rn,r=Ir;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(D){const x=new Float64Array(16);if(D)for(let m=0;m<D.length;m++)x[m]=D[m];return x}const a=new Uint8Array(32);a[0]=9;const l=s([56129,1]);function p(D){let x=1;for(let m=0;m<16;m++){let c=D[m]+x+65535;x=Math.floor(c/65536),D[m]=c-x*65536}D[0]+=x-1+37*(x-1)}function f(D,x,m){const c=~(m-1);for(let _=0;_<16;_++){const k=c&(D[_]^x[_]);D[_]^=k,x[_]^=k}}function g(D,x){const m=s(),c=s();for(let _=0;_<16;_++)c[_]=x[_];p(c),p(c),p(c);for(let _=0;_<2;_++){m[0]=c[0]-65517;for(let G=1;G<15;G++)m[G]=c[G]-65535-(m[G-1]>>16&1),m[G-1]&=65535;m[15]=c[15]-32767-(m[14]>>16&1);const k=m[15]>>16&1;m[14]&=65535,f(c,m,1-k)}for(let _=0;_<16;_++)D[2*_]=c[_]&255,D[2*_+1]=c[_]>>8}function w(D,x){for(let m=0;m<16;m++)D[m]=x[2*m]+(x[2*m+1]<<8);D[15]&=32767}function S(D,x,m){for(let c=0;c<16;c++)D[c]=x[c]+m[c]}function T(D,x,m){for(let c=0;c<16;c++)D[c]=x[c]-m[c]}function j(D,x,m){let c,_,k=0,G=0,oe=0,ce=0,ge=0,R=0,z=0,le=0,te=0,W=0,ee=0,J=0,re=0,xe=0,ne=0,be=0,he=0,_e=0,q=0,L=0,A=0,h=0,I=0,se=0,fe=0,Se=0,Be=0,ke=0,Me=0,pt=0,gt=0,je=m[0],Ie=m[1],Te=m[2],Fe=m[3],qe=m[4],Ce=m[5],$e=m[6],De=m[7],Ae=m[8],He=m[9],Oe=m[10],Ve=m[11],We=m[12],et=m[13],tt=m[14],Ye=m[15];c=x[0],k+=c*je,G+=c*Ie,oe+=c*Te,ce+=c*Fe,ge+=c*qe,R+=c*Ce,z+=c*$e,le+=c*De,te+=c*Ae,W+=c*He,ee+=c*Oe,J+=c*Ve,re+=c*We,xe+=c*et,ne+=c*tt,be+=c*Ye,c=x[1],G+=c*je,oe+=c*Ie,ce+=c*Te,ge+=c*Fe,R+=c*qe,z+=c*Ce,le+=c*$e,te+=c*De,W+=c*Ae,ee+=c*He,J+=c*Oe,re+=c*Ve,xe+=c*We,ne+=c*et,be+=c*tt,he+=c*Ye,c=x[2],oe+=c*je,ce+=c*Ie,ge+=c*Te,R+=c*Fe,z+=c*qe,le+=c*Ce,te+=c*$e,W+=c*De,ee+=c*Ae,J+=c*He,re+=c*Oe,xe+=c*Ve,ne+=c*We,be+=c*et,he+=c*tt,_e+=c*Ye,c=x[3],ce+=c*je,ge+=c*Ie,R+=c*Te,z+=c*Fe,le+=c*qe,te+=c*Ce,W+=c*$e,ee+=c*De,J+=c*Ae,re+=c*He,xe+=c*Oe,ne+=c*Ve,be+=c*We,he+=c*et,_e+=c*tt,q+=c*Ye,c=x[4],ge+=c*je,R+=c*Ie,z+=c*Te,le+=c*Fe,te+=c*qe,W+=c*Ce,ee+=c*$e,J+=c*De,re+=c*Ae,xe+=c*He,ne+=c*Oe,be+=c*Ve,he+=c*We,_e+=c*et,q+=c*tt,L+=c*Ye,c=x[5],R+=c*je,z+=c*Ie,le+=c*Te,te+=c*Fe,W+=c*qe,ee+=c*Ce,J+=c*$e,re+=c*De,xe+=c*Ae,ne+=c*He,be+=c*Oe,he+=c*Ve,_e+=c*We,q+=c*et,L+=c*tt,A+=c*Ye,c=x[6],z+=c*je,le+=c*Ie,te+=c*Te,W+=c*Fe,ee+=c*qe,J+=c*Ce,re+=c*$e,xe+=c*De,ne+=c*Ae,be+=c*He,he+=c*Oe,_e+=c*Ve,q+=c*We,L+=c*et,A+=c*tt,h+=c*Ye,c=x[7],le+=c*je,te+=c*Ie,W+=c*Te,ee+=c*Fe,J+=c*qe,re+=c*Ce,xe+=c*$e,ne+=c*De,be+=c*Ae,he+=c*He,_e+=c*Oe,q+=c*Ve,L+=c*We,A+=c*et,h+=c*tt,I+=c*Ye,c=x[8],te+=c*je,W+=c*Ie,ee+=c*Te,J+=c*Fe,re+=c*qe,xe+=c*Ce,ne+=c*$e,be+=c*De,he+=c*Ae,_e+=c*He,q+=c*Oe,L+=c*Ve,A+=c*We,h+=c*et,I+=c*tt,se+=c*Ye,c=x[9],W+=c*je,ee+=c*Ie,J+=c*Te,re+=c*Fe,xe+=c*qe,ne+=c*Ce,be+=c*$e,he+=c*De,_e+=c*Ae,q+=c*He,L+=c*Oe,A+=c*Ve,h+=c*We,I+=c*et,se+=c*tt,fe+=c*Ye,c=x[10],ee+=c*je,J+=c*Ie,re+=c*Te,xe+=c*Fe,ne+=c*qe,be+=c*Ce,he+=c*$e,_e+=c*De,q+=c*Ae,L+=c*He,A+=c*Oe,h+=c*Ve,I+=c*We,se+=c*et,fe+=c*tt,Se+=c*Ye,c=x[11],J+=c*je,re+=c*Ie,xe+=c*Te,ne+=c*Fe,be+=c*qe,he+=c*Ce,_e+=c*$e,q+=c*De,L+=c*Ae,A+=c*He,h+=c*Oe,I+=c*Ve,se+=c*We,fe+=c*et,Se+=c*tt,Be+=c*Ye,c=x[12],re+=c*je,xe+=c*Ie,ne+=c*Te,be+=c*Fe,he+=c*qe,_e+=c*Ce,q+=c*$e,L+=c*De,A+=c*Ae,h+=c*He,I+=c*Oe,se+=c*Ve,fe+=c*We,Se+=c*et,Be+=c*tt,ke+=c*Ye,c=x[13],xe+=c*je,ne+=c*Ie,be+=c*Te,he+=c*Fe,_e+=c*qe,q+=c*Ce,L+=c*$e,A+=c*De,h+=c*Ae,I+=c*He,se+=c*Oe,fe+=c*Ve,Se+=c*We,Be+=c*et,ke+=c*tt,Me+=c*Ye,c=x[14],ne+=c*je,be+=c*Ie,he+=c*Te,_e+=c*Fe,q+=c*qe,L+=c*Ce,A+=c*$e,h+=c*De,I+=c*Ae,se+=c*He,fe+=c*Oe,Se+=c*Ve,Be+=c*We,ke+=c*et,Me+=c*tt,pt+=c*Ye,c=x[15],be+=c*je,he+=c*Ie,_e+=c*Te,q+=c*Fe,L+=c*qe,A+=c*Ce,h+=c*$e,I+=c*De,se+=c*Ae,fe+=c*He,Se+=c*Oe,Be+=c*Ve,ke+=c*We,Me+=c*et,pt+=c*tt,gt+=c*Ye,k+=38*he,G+=38*_e,oe+=38*q,ce+=38*L,ge+=38*A,R+=38*h,z+=38*I,le+=38*se,te+=38*fe,W+=38*Se,ee+=38*Be,J+=38*ke,re+=38*Me,xe+=38*pt,ne+=38*gt,_=1,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=R+_+65535,_=Math.floor(c/65536),R=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,k+=_-1+37*(_-1),_=1,c=k+_+65535,_=Math.floor(c/65536),k=c-_*65536,c=G+_+65535,_=Math.floor(c/65536),G=c-_*65536,c=oe+_+65535,_=Math.floor(c/65536),oe=c-_*65536,c=ce+_+65535,_=Math.floor(c/65536),ce=c-_*65536,c=ge+_+65535,_=Math.floor(c/65536),ge=c-_*65536,c=R+_+65535,_=Math.floor(c/65536),R=c-_*65536,c=z+_+65535,_=Math.floor(c/65536),z=c-_*65536,c=le+_+65535,_=Math.floor(c/65536),le=c-_*65536,c=te+_+65535,_=Math.floor(c/65536),te=c-_*65536,c=W+_+65535,_=Math.floor(c/65536),W=c-_*65536,c=ee+_+65535,_=Math.floor(c/65536),ee=c-_*65536,c=J+_+65535,_=Math.floor(c/65536),J=c-_*65536,c=re+_+65535,_=Math.floor(c/65536),re=c-_*65536,c=xe+_+65535,_=Math.floor(c/65536),xe=c-_*65536,c=ne+_+65535,_=Math.floor(c/65536),ne=c-_*65536,c=be+_+65535,_=Math.floor(c/65536),be=c-_*65536,k+=_-1+37*(_-1),D[0]=k,D[1]=G,D[2]=oe,D[3]=ce,D[4]=ge,D[5]=R,D[6]=z,D[7]=le,D[8]=te,D[9]=W,D[10]=ee,D[11]=J,D[12]=re,D[13]=xe,D[14]=ne,D[15]=be}function P(D,x){j(D,x,x)}function M(D,x){const m=s();for(let c=0;c<16;c++)m[c]=x[c];for(let c=253;c>=0;c--)P(m,m),c!==2&&c!==4&&j(m,m,x);for(let c=0;c<16;c++)D[c]=m[c]}function H(D,x){const m=new Uint8Array(32),c=new Float64Array(80),_=s(),k=s(),G=s(),oe=s(),ce=s(),ge=s();for(let te=0;te<31;te++)m[te]=D[te];m[31]=D[31]&127|64,m[0]&=248,w(c,x);for(let te=0;te<16;te++)k[te]=c[te];_[0]=oe[0]=1;for(let te=254;te>=0;--te){const W=m[te>>>3]>>>(te&7)&1;f(_,k,W),f(G,oe,W),S(ce,_,G),T(_,_,G),S(G,k,oe),T(k,k,oe),P(oe,ce),P(ge,_),j(_,G,_),j(G,k,ce),S(ce,_,G),T(_,_,G),P(k,_),T(G,oe,ge),j(_,G,l),S(_,_,oe),j(G,G,_),j(_,oe,ge),j(oe,k,c),P(k,ce),f(_,k,W),f(G,oe,W)}for(let te=0;te<16;te++)c[te+16]=_[te],c[te+32]=G[te],c[te+48]=k[te],c[te+64]=oe[te];const R=c.subarray(32),z=c.subarray(16);M(R,R),j(z,z,R);const le=new Uint8Array(32);return g(le,z),le}n.scalarMult=H;function K(D){return H(D,a)}n.scalarMultBase=K;function ie(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(D);return{publicKey:K(x),secretKey:x}}n.generateKeyPairFromSeed=ie;function C(D){const x=(0,e.randomBytes)(32,D),m=ie(x);return(0,r.wipe)(x),m}n.generateKeyPair=C;function $(D,x,m=!1){if(D.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=H(D,x);if(m){let _=0;for(let k=0;k<c.length;k++)_|=c[k];if(_===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=$})(au);function cu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Dd(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?cu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function kc(n,e){e||(e=n.reduce((a,l)=>a+l.length,0));const r=Dd(e);let s=0;for(const a of n)r.set(a,s),s+=a.length;return cu(r)}function cb(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),w=Math.log(f)/Math.log(256),S=Math.log(256)/Math.log(f);function T(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var H=0,K=0,ie=0,C=M.length;ie!==C&&M[ie]===0;)ie++,H++;for(var $=(C-ie)*S+1>>>0,D=new Uint8Array($);ie!==C;){for(var x=M[ie],m=0,c=$-1;(x!==0||m<K)&&c!==-1;c--,m++)x+=256*D[c]>>>0,D[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");K=m,ie++}for(var _=$-K;_!==$&&D[_]===0;)_++;for(var k=g.repeat(H);_<$;++_)k+=n.charAt(D[_]);return k}function j(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var H=0;if(M[H]!==" "){for(var K=0,ie=0;M[H]===g;)K++,H++;for(var C=(M.length-H)*w+1>>>0,$=new Uint8Array(C);M[H];){var D=r[M.charCodeAt(H)];if(D===255)return;for(var x=0,m=C-1;(D!==0||x<ie)&&m!==-1;m--,x++)D+=f*$[m]>>>0,$[m]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");ie=x,H++}if(M[H]!==" "){for(var c=C-ie;c!==C&&$[c]===0;)c++;for(var _=new Uint8Array(K+(C-c)),k=K;c!==C;)_[k++]=$[c++];return _}}}function P(M){var H=j(M);if(H)return H;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:j,decode:P}}var ub=cb,hb=ub;const lb=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fb=n=>new TextEncoder().encode(n),db=n=>new TextDecoder().decode(n);class pb{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class gb{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Sd(this,e)}}class vb{constructor(e){this.decoders=e}or(e){return Sd(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Sd=(n,e)=>new vb({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class yb{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new pb(e,r,s),this.decoder=new gb(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Vo=({name:n,prefix:e,encode:r,decode:s})=>new yb(n,e,r,s),_s=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:a}=hb(r,e);return Vo({prefix:n,name:e,encode:s,decode:l=>lb(a(l))})},_b=(n,e,r,s)=>{const a={};for(let S=0;S<e.length;++S)a[e[S]]=S;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,g=0,w=0;for(let S=0;S<l;++S){const T=a[n[S]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|T,f+=r,f>=8&&(f-=8,p[w++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},mb=(n,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,l+=e[a&f>>p];if(p&&(l+=e[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Jt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>Vo({prefix:e,name:n,encode(a){return mb(a,s,r)},decode(a){return _b(a,s,r,n)}}),bb=Vo({prefix:"\0",name:"identity",encode:n=>db(n),decode:n=>fb(n)}),wb=Object.freeze(Object.defineProperty({__proto__:null,identity:bb},Symbol.toStringTag,{value:"Module"})),Eb=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Db=Object.freeze(Object.defineProperty({__proto__:null,base2:Eb},Symbol.toStringTag,{value:"Module"})),Sb=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ib=Object.freeze(Object.defineProperty({__proto__:null,base8:Sb},Symbol.toStringTag,{value:"Module"})),xb=_s({prefix:"9",name:"base10",alphabet:"0123456789"}),Ob=Object.freeze(Object.defineProperty({__proto__:null,base10:xb},Symbol.toStringTag,{value:"Module"})),Cb=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ab=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Pb=Object.freeze(Object.defineProperty({__proto__:null,base16:Cb,base16upper:Ab},Symbol.toStringTag,{value:"Module"})),Rb=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Nb=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tb=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fb=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$b=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ub=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mb=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lb=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jb=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qb=Object.freeze(Object.defineProperty({__proto__:null,base32:Rb,base32hex:$b,base32hexpad:Mb,base32hexpadupper:Lb,base32hexupper:Ub,base32pad:Tb,base32padupper:Fb,base32upper:Nb,base32z:jb},Symbol.toStringTag,{value:"Module"})),zb=_s({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Bb=_s({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Hb=Object.freeze(Object.defineProperty({__proto__:null,base36:zb,base36upper:Bb},Symbol.toStringTag,{value:"Module"})),Kb=_s({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kb=_s({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Vb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Kb,base58flickr:kb},Symbol.toStringTag,{value:"Module"})),Gb=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Wb=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Jb=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yb=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Xb=Object.freeze(Object.defineProperty({__proto__:null,base64:Gb,base64pad:Wb,base64url:Jb,base64urlpad:Yb},Symbol.toStringTag,{value:"Module"})),Id=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Qb=Id.reduce((n,e,r)=>(n[r]=e,n),[]),Zb=Id.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function ew(n){return n.reduce((e,r)=>(e+=Qb[r],e),"")}function tw(n){const e=[];for(const r of n){const s=Zb[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const rw=Vo({prefix:"🚀",name:"base256emoji",encode:ew,decode:tw}),iw=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:rw},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Rl={...wb,...Db,...Ib,...Ob,...Pb,...qb,...Hb,...Vb,...Xb,...iw};function xd(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const Nl=xd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),bc=xd("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=Dd(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),Od={utf8:Nl,"utf-8":Nl,hex:Rl.base16,latin1:bc,ascii:bc,binary:bc,...Rl};function yr(n,e="utf8"){const r=Od[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?cu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function ur(n,e="utf8"){const r=Od[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var Tl=globalThis&&globalThis.__spreadArray||function(n,e,r){if(r||arguments.length===2)for(var s=0,a=e.length,l;s<a;s++)(l||!(s in e))&&(l||(l=Array.prototype.slice.call(e,0,s)),l[s]=e[s]);return n.concat(l||Array.prototype.slice.call(e))},nw=function(){function n(e,r,s){this.name=e,this.version=r,this.os=s,this.type="browser"}return n}(),sw=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),ow=function(){function n(e,r,s,a){this.name=e,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),aw=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),cw=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),uw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,hw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Fl=3,lw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",uw]],$l=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function fw(n){return n?Ul(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new cw:typeof navigator<"u"?Ul(navigator.userAgent):gw()}function dw(n){return n!==""&&lw.reduce(function(e,r){var s=r[0],a=r[1];if(e)return e;var l=a.exec(n);return!!l&&[s,l]},!1)}function Ul(n){var e=dw(n);if(!e)return null;var r=e[0],s=e[1];if(r==="searchbot")return new aw;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<Fl&&(a=Tl(Tl([],a,!0),vw(Fl-a.length),!0)):a=[];var l=a.join("."),p=pw(n),f=hw.exec(n);return f&&f[1]?new ow(r,l,p,f[1]):new nw(r,l,p)}function pw(n){for(var e=0,r=$l.length;e<r;e++){var s=$l[e],a=s[0],l=s[1],p=l.exec(n);if(p)return a}return null}function gw(){var n=typeof process<"u"&&process.version;return n?new sw(process.version.slice(1)):null}function vw(n){for(var e=[],r=0;r<n;r++)e.push("0");return e}var ye={};const jr=ld(bm);var wc={},es={},Ml;function yw(){if(Ml)return es;Ml=1,Object.defineProperty(es,"__esModule",{value:!0}),es.delay=void 0;function n(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return es.delay=n,es}var Yi={},Ec={},Xi={},Ll;function _w(){return Ll||(Ll=1,Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.ONE_THOUSAND=Xi.ONE_HUNDRED=void 0,Xi.ONE_HUNDRED=100,Xi.ONE_THOUSAND=1e3),Xi}var Dc={},jl;function mw(){return jl||(jl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(Dc)),Dc}var ql;function Cd(){return ql||(ql=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(_w(),n),e.__exportStar(mw(),n)}(Ec)),Ec}var zl;function bw(){if(zl)return Yi;zl=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.fromMiliseconds=Yi.toMiliseconds=void 0;const n=Cd();function e(s){return s*n.ONE_THOUSAND}Yi.toMiliseconds=e;function r(s){return Math.floor(s/n.ONE_THOUSAND)}return Yi.fromMiliseconds=r,Yi}var Bl;function ww(){return Bl||(Bl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(yw(),n),e.__exportStar(bw(),n)}(wc)),wc}var xn={},Hl;function Ew(){if(Hl)return xn;Hl=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const s=this.get(r);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const a=Date.now()-s.started;this.timestamps.set(r,{started:s.started,elapsed:a})}get(r){const s=this.timestamps.get(r);if(typeof s>"u")throw new Error(`No timestamp found for label: ${r}`);return s}elapsed(r){const s=this.get(r);return s.elapsed||Date.now()-s.started}}return xn.Watch=n,xn.default=n,xn}var Sc={},ts={},Kl;function Dw(){if(Kl)return ts;Kl=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IWatch=void 0;class n{}return ts.IWatch=n,ts}var kl;function Sw(){return kl||(kl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(Dw(),n)}(Sc)),Sc}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(ww(),n),e.__exportStar(Ew(),n),e.__exportStar(Sw(),n),e.__exportStar(Cd(),n)})(ye);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.getLocalStorage=lt.getLocalStorageOrThrow=lt.getCrypto=lt.getCryptoOrThrow=Pd=lt.getLocation=lt.getLocationOrThrow=uu=lt.getNavigator=lt.getNavigatorOrThrow=Ad=lt.getDocument=lt.getDocumentOrThrow=lt.getFromWindowOrThrow=lt.getFromWindow=void 0;function tn(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}lt.getFromWindow=tn;function Nn(n){const e=tn(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}lt.getFromWindowOrThrow=Nn;function Iw(){return Nn("document")}lt.getDocumentOrThrow=Iw;function xw(){return tn("document")}var Ad=lt.getDocument=xw;function Ow(){return Nn("navigator")}lt.getNavigatorOrThrow=Ow;function Cw(){return tn("navigator")}var uu=lt.getNavigator=Cw;function Aw(){return Nn("location")}lt.getLocationOrThrow=Aw;function Pw(){return tn("location")}var Pd=lt.getLocation=Pw;function Rw(){return Nn("crypto")}lt.getCryptoOrThrow=Rw;function Nw(){return tn("crypto")}lt.getCrypto=Nw;function Tw(){return Nn("localStorage")}lt.getLocalStorageOrThrow=Tw;function Fw(){return tn("localStorage")}lt.getLocalStorage=Fw;var hu={};Object.defineProperty(hu,"__esModule",{value:!0});var Rd=hu.getWindowMetadata=void 0;const Vl=lt;function $w(){let n,e;try{n=Vl.getDocumentOrThrow(),e=Vl.getLocationOrThrow()}catch(T){return null}function r(){const T=n.getElementsByTagName("link"),j=[];for(let P=0;P<T.length;P++){const M=T[P],H=M.getAttribute("rel");if(H&&H.toLowerCase().indexOf("icon")>-1){const K=M.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(K.indexOf("/")===0)ie+=K;else{const C=e.pathname.split("/");C.pop();const $=C.join("/");ie+=$+"/"+K}j.push(ie)}else if(K.indexOf("//")===0){const ie=e.protocol+K;j.push(ie)}else j.push(K)}}return j}function s(...T){const j=n.getElementsByTagName("meta");for(let P=0;P<j.length;P++){const M=j[P],H=["itemprop","property","name"].map(K=>M.getAttribute(K)).filter(K=>K?T.includes(K):!1);if(H.length&&H){const K=M.getAttribute("content");if(K)return K}}return""}function a(){let T=s("name","og:site_name","og:title","twitter:title");return T||(T=n.title),T}function l(){return s("description","og:description","twitter:description","keywords")}const p=a(),f=l(),g=e.origin,w=r();return{description:f,url:g,icons:w,name:p}}Rd=hu.getWindowMetadata=$w;var vs={},Uw=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Nd="%[a-f0-9]{2}",Gl=new RegExp("("+Nd+")|([^%]+?)","gi"),Wl=new RegExp("("+Nd+")+","gi");function Vc(n,e){try{return[decodeURIComponent(n.join(""))]}catch(a){}if(n.length===1)return n;e=e||1;var r=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],Vc(r),Vc(s))}function Mw(n){try{return decodeURIComponent(n)}catch(s){for(var e=n.match(Gl)||[],r=1;r<e.length;r++)n=Vc(e,r).join(""),e=n.match(Gl)||[];return n}}function Lw(n){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=Wl.exec(n);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(f){var s=Mw(r[0]);s!==r[0]&&(e[r[0]]=s)}r=Wl.exec(n)}e["%C2"]="�";for(var a=Object.keys(e),l=0;l<a.length;l++){var p=a[l];n=n.replace(new RegExp(p,"g"),e[p])}return n}var jw=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch(e){return Lw(n)}},qw=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const r=n.indexOf(e);return r===-1?[n]:[n.slice(0,r),n.slice(r+e.length)]},zw=function(n,e){for(var r={},s=Object.keys(n),a=Array.isArray(e),l=0;l<s.length;l++){var p=s[l],f=n[p];(a?e.indexOf(p)!==-1:e(p,f,n))&&(r[p]=f)}return r};(function(n){const e=Uw,r=jw,s=qw,a=zw,l=C=>C==null,p=Symbol("encodeFragmentIdentifier");function f(C){switch(C.arrayFormat){case"index":return $=>(D,x)=>{const m=D.length;return x===void 0||C.skipNull&&x===null||C.skipEmptyString&&x===""?D:x===null?[...D,[S($,C),"[",m,"]"].join("")]:[...D,[S($,C),"[",S(m,C),"]=",S(x,C)].join("")]};case"bracket":return $=>(D,x)=>x===void 0||C.skipNull&&x===null||C.skipEmptyString&&x===""?D:x===null?[...D,[S($,C),"[]"].join("")]:[...D,[S($,C),"[]=",S(x,C)].join("")];case"colon-list-separator":return $=>(D,x)=>x===void 0||C.skipNull&&x===null||C.skipEmptyString&&x===""?D:x===null?[...D,[S($,C),":list="].join("")]:[...D,[S($,C),":list=",S(x,C)].join("")];case"comma":case"separator":case"bracket-separator":{const $=C.arrayFormat==="bracket-separator"?"[]=":"=";return D=>(x,m)=>m===void 0||C.skipNull&&m===null||C.skipEmptyString&&m===""?x:(m=m===null?"":m,x.length===0?[[S(D,C),$,S(m,C)].join("")]:[[x,S(m,C)].join(C.arrayFormatSeparator)])}default:return $=>(D,x)=>x===void 0||C.skipNull&&x===null||C.skipEmptyString&&x===""?D:x===null?[...D,S($,C)]:[...D,[S($,C),"=",S(x,C)].join("")]}}function g(C){let $;switch(C.arrayFormat){case"index":return(D,x,m)=>{if($=/\[(\d*)\]$/.exec(D),D=D.replace(/\[\d*\]$/,""),!$){m[D]=x;return}m[D]===void 0&&(m[D]={}),m[D][$[1]]=x};case"bracket":return(D,x,m)=>{if($=/(\[\])$/.exec(D),D=D.replace(/\[\]$/,""),!$){m[D]=x;return}if(m[D]===void 0){m[D]=[x];return}m[D]=[].concat(m[D],x)};case"colon-list-separator":return(D,x,m)=>{if($=/(:list)$/.exec(D),D=D.replace(/:list$/,""),!$){m[D]=x;return}if(m[D]===void 0){m[D]=[x];return}m[D]=[].concat(m[D],x)};case"comma":case"separator":return(D,x,m)=>{const c=typeof x=="string"&&x.includes(C.arrayFormatSeparator),_=typeof x=="string"&&!c&&T(x,C).includes(C.arrayFormatSeparator);x=_?T(x,C):x;const k=c||_?x.split(C.arrayFormatSeparator).map(G=>T(G,C)):x===null?x:T(x,C);m[D]=k};case"bracket-separator":return(D,x,m)=>{const c=/(\[\])$/.test(D);if(D=D.replace(/\[\]$/,""),!c){m[D]=x&&T(x,C);return}const _=x===null?[]:x.split(C.arrayFormatSeparator).map(k=>T(k,C));if(m[D]===void 0){m[D]=_;return}m[D]=[].concat(m[D],_)};default:return(D,x,m)=>{if(m[D]===void 0){m[D]=x;return}m[D]=[].concat(m[D],x)}}}function w(C){if(typeof C!="string"||C.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(C,$){return $.encode?$.strict?e(C):encodeURIComponent(C):C}function T(C,$){return $.decode?r(C):C}function j(C){return Array.isArray(C)?C.sort():typeof C=="object"?j(Object.keys(C)).sort(($,D)=>Number($)-Number(D)).map($=>C[$]):C}function P(C){const $=C.indexOf("#");return $!==-1&&(C=C.slice(0,$)),C}function M(C){let $="";const D=C.indexOf("#");return D!==-1&&($=C.slice(D)),$}function H(C){C=P(C);const $=C.indexOf("?");return $===-1?"":C.slice($+1)}function K(C,$){return $.parseNumbers&&!Number.isNaN(Number(C))&&typeof C=="string"&&C.trim()!==""?C=Number(C):$.parseBooleans&&C!==null&&(C.toLowerCase()==="true"||C.toLowerCase()==="false")&&(C=C.toLowerCase()==="true"),C}function ie(C,$){$=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},$),w($.arrayFormatSeparator);const D=g($),x=Object.create(null);if(typeof C!="string"||(C=C.trim().replace(/^[?#&]/,""),!C))return x;for(const m of C.split("&")){if(m==="")continue;let[c,_]=s($.decode?m.replace(/\+/g," "):m,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes($.arrayFormat)?_:T(_,$),D(T(c,$),_,x)}for(const m of Object.keys(x)){const c=x[m];if(typeof c=="object"&&c!==null)for(const _ of Object.keys(c))c[_]=K(c[_],$);else x[m]=K(c,$)}return $.sort===!1?x:($.sort===!0?Object.keys(x).sort():Object.keys(x).sort($.sort)).reduce((m,c)=>{const _=x[c];return _&&typeof _=="object"&&!Array.isArray(_)?m[c]=j(_):m[c]=_,m},Object.create(null))}n.extract=H,n.parse=ie,n.stringify=(C,$)=>{if(!C)return"";$=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},$),w($.arrayFormatSeparator);const D=_=>$.skipNull&&l(C[_])||$.skipEmptyString&&C[_]==="",x=f($),m={};for(const _ of Object.keys(C))D(_)||(m[_]=C[_]);const c=Object.keys(m);return $.sort!==!1&&c.sort($.sort),c.map(_=>{const k=C[_];return k===void 0?"":k===null?S(_,$):Array.isArray(k)?k.length===0&&$.arrayFormat==="bracket-separator"?S(_,$)+"[]":k.reduce(x(_),[]).join("&"):S(_,$)+"="+S(k,$)}).filter(_=>_.length>0).join("&")},n.parseUrl=(C,$)=>{$=Object.assign({decode:!0},$);const[D,x]=s(C,"#");return Object.assign({url:D.split("?")[0]||"",query:ie(H(C),$)},$&&$.parseFragmentIdentifier&&x?{fragmentIdentifier:T(x,$)}:{})},n.stringifyUrl=(C,$)=>{$=Object.assign({encode:!0,strict:!0,[p]:!0},$);const D=P(C.url).split("?")[0]||"",x=n.extract(C.url),m=n.parse(x,{sort:!1}),c=Object.assign(m,C.query);let _=n.stringify(c,$);_&&(_=`?${_}`);let k=M(C.url);return C.fragmentIdentifier&&(k=`#${$[p]?S(C.fragmentIdentifier,$):C.fragmentIdentifier}`),`${D}${_}${k}`},n.pick=(C,$,D)=>{D=Object.assign({parseFragmentIdentifier:!0,[p]:!1},D);const{url:x,query:m,fragmentIdentifier:c}=n.parseUrl(C,D);return n.stringifyUrl({url:x,query:a(m,$),fragmentIdentifier:c},D)},n.exclude=(C,$,D)=>{const x=Array.isArray($)?m=>!$.includes(m):(m,c)=>!$(m,c);return n.pick(C,x,D)}})(vs);const Bw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function Hw(n,e=[]){const r=[];return Object.keys(n).forEach(s=>{if(e.length&&!e.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Td(n,e){return n.includes(":")?[n]:e.chains||[]}const Fd="base10",cr="base16",Gc="base64pad",lu="utf8",$d=0,rn=1,Kw=0,Jl=1,Wc=12,fu=32;function kw(){const n=au.generateKeyPair();return{privateKey:ur(n.secretKey,cr),publicKey:ur(n.publicKey,cr)}}function Jc(){const n=Rn.randomBytes(fu);return ur(n,cr)}function Vw(n,e){const r=au.sharedKey(yr(n,cr),yr(e,cr)),s=new eb(ko.SHA256,r).expand(fu);return ur(s,cr)}function Gw(n){const e=ko.hash(yr(n,cr));return ur(e,cr)}function An(n){const e=ko.hash(yr(n,lu));return ur(e,cr)}function Ww(n){return yr(`${n}`,Fd)}function ms(n){return Number(ur(n,Fd))}function Jw(n){const e=Ww(typeof n.type<"u"?n.type:$d);if(ms(e)===rn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?yr(n.senderPublicKey,cr):void 0,s=typeof n.iv<"u"?yr(n.iv,cr):Rn.randomBytes(Wc),a=new su.ChaCha20Poly1305(yr(n.symKey,cr)).seal(s,yr(n.message,lu));return Xw({type:e,sealed:a,iv:s,senderPublicKey:r})}function Yw(n){const e=new su.ChaCha20Poly1305(yr(n.symKey,cr)),{sealed:r,iv:s}=$o(n.encoded),a=e.open(s,r);if(a===null)throw new Error("Failed to decrypt");return ur(a,lu)}function Xw(n){if(ms(n.type)===rn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(kc([n.type,n.senderPublicKey,n.iv,n.sealed]),Gc)}return ur(kc([n.type,n.iv,n.sealed]),Gc)}function $o(n){const e=yr(n,Gc),r=e.slice(Kw,Jl),s=Jl;if(ms(r)===rn){const f=s+fu,g=f+Wc,w=e.slice(s,f),S=e.slice(f,g),T=e.slice(g);return{type:r,sealed:T,iv:S,senderPublicKey:w}}const a=s+Wc,l=e.slice(s,a),p=e.slice(a);return{type:r,sealed:p,iv:l}}function Qw(n,e){const r=$o(n);return Ud({type:ms(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ur(r.senderPublicKey,cr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Ud(n){const e=(n==null?void 0:n.type)||$d;if(e===rn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Yl(n){return n.type===rn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Zw=Object.defineProperty,Xl=Object.getOwnPropertySymbols,eE=Object.prototype.hasOwnProperty,tE=Object.prototype.propertyIsEnumerable,Ql=(n,e,r)=>e in n?Zw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Zl=(n,e)=>{for(var r in e||(e={}))eE.call(e,r)&&Ql(n,r,e[r]);if(Xl)for(var r of Xl(e))tE.call(e,r)&&Ql(n,r,e[r]);return n};const rE="ReactNative",Ri={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},iE="js";function du(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Md(){return!Ad()&&!!uu()&&navigator.product===rE}function pu(){return!du()&&!!uu()}function gu(){return Md()?Ri.reactNative:du()?Ri.node:pu()?Ri.browser:Ri.unknown}function nE(n,e){let r=vs.parse(n);return r=Zl(Zl({},r),e),n=vs.stringify(r),n}function sE(){return Rd()||{name:"",description:"",url:"",icons:[""]}}function oE(){if(gu()===Ri.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=fw();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function aE(){var n;const e=gu();return e===Ri.browser?[e,((n=Pd())==null?void 0:n.host)||"unknown"].join(":"):e}function cE(n,e,r){const s=oE(),a=aE();return[[n,e].join("-"),[iE,r].join("-"),s,a].join("/")}function uE({protocol:n,version:e,relayUrl:r,sdkVersion:s,auth:a,projectId:l,useOnCloseEvent:p}){const f=r.split("?"),g=cE(n,e,s),w={auth:a,ua:g,projectId:l,useOnCloseEvent:p||void 0},S=nE(f[1]||"",w);return f[0]+"?"+S}function en(n,e){return n.filter(r=>e.includes(r)).length===n.length}function Ld(n){return Object.fromEntries(n.entries())}function jd(n){return new Map(Object.entries(n))}function On(n=ye.FIVE_MINUTES,e){const r=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,a,l;return{resolve:p=>{l&&s&&(clearTimeout(l),s(p))},reject:p=>{l&&a&&(clearTimeout(l),a(p))},done:()=>new Promise((p,f)=>{l=setTimeout(()=>{f(new Error(e))},r),s=p,a=f})}}function Uo(n,e,r){return new Promise(async(s,a)=>{const l=setTimeout(()=>a(new Error(r)),e);try{const p=await n;s(p)}catch(p){a(p)}clearTimeout(l)})}function qd(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function hE(n){return qd("topic",n)}function lE(n){return qd("id",n)}function zd(n){const[e,r]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")s.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return s}function Vr(n,e){return ye.fromMiliseconds((e||Date.now())+ye.toMiliseconds(n))}function Pi(n){return Date.now()>=ye.toMiliseconds(n)}function Bt(n,e){return`${n}${e?`:${e}`:""}`}function Ic(n=[],e=[]){return[...new Set([...n,...e])]}async function fE({id:n,topic:e,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const l=`${a}/wc?requestId=${n}&sessionTopic=${e}`,p=gu();p===Ri.browser?l.startsWith("https://")?window.open(l,"_blank","noreferrer noopener"):window.open(l,"_self","noreferrer noopener"):p===Ri.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(l)}catch(s){console.error(s)}}const dE="irn";function Yc(n){return(n==null?void 0:n.relay)||{protocol:dE}}function Po(n){const e=Bw[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var pE=Object.defineProperty,ef=Object.getOwnPropertySymbols,gE=Object.prototype.hasOwnProperty,vE=Object.prototype.propertyIsEnumerable,tf=(n,e,r)=>e in n?pE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,yE=(n,e)=>{for(var r in e||(e={}))gE.call(e,r)&&tf(n,r,e[r]);if(ef)for(var r of ef(e))vE.call(e,r)&&tf(n,r,e[r]);return n};function _E(n,e="-"){const r={},s="relay"+e;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const l=a.replace(s,""),p=n[a];r[l]=p}}),r}function mE(n){const e=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),a=n.substring(e+1,r).split("@"),l=typeof r<"u"?n.substring(r):"",p=vs.parse(l);return{protocol:s,topic:bE(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:_E(p)}}function bE(n){return n.startsWith("//")?n.substring(2):n}function wE(n,e="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const l=r+e+a;n[a]&&(s[l]=n[a])}),s}function EE(n){return`${n.protocol}:${n.topic}@${n.version}?`+vs.stringify(yE({symKey:n.symKey},wE(n.relay)))}function Tn(n){const e=[];return n.forEach(r=>{const[s,a]=r.split(":");e.push(`${s}:${a}`)}),e}function DE(n){const e=[];return Object.values(n).forEach(r=>{e.push(...Tn(r.accounts))}),e}function SE(n,e){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(e)&&r.push(...s.methods)}),r}function IE(n,e){const r=[];return Object.values(n).forEach(s=>{Tn(s.accounts).includes(e)&&r.push(...s.events)}),r}function xE(n,e){const r=No(n,e);if(r)throw new Error(r.message);const s={};for(const[a,l]of Object.entries(n))s[a]={methods:l.methods,events:l.events,chains:l.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return s}function vu(n){return n.includes(":")}function Ro(n){return vu(n)?n.split(":")[0]:n}const OE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},CE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(n,e){const{message:r,code:s}=CE[n];return{message:e?`${r} ${e}`:r,code:s}}function Tt(n,e){const{message:r,code:s}=OE[n];return{message:e?`${r} ${e}`:r,code:s}}function ri(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function Pn(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ar(n){return typeof n>"u"}function Gt(n,e){return e&&ar(n)?!0:typeof n=="string"&&!!n.trim().length}function yu(n,e){return e&&ar(n)?!0:typeof n=="number"&&!isNaN(n)}function AE(n,e){const{requiredNamespaces:r}=e,s=Object.keys(n.namespaces),a=Object.keys(r);let l=!0;return en(a,s)?(s.forEach(p=>{const{accounts:f,methods:g,events:w}=n.namespaces[p],S=Tn(f),T=r[p];(!en(Td(p,T),S)||!en(T.methods,g)||!en(T.events,w))&&(l=!1)}),l):!1}function Mo(n){return Gt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function PE(n){if(Gt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Mo(r)}}return!1}function RE(n){if(Gt(n,!1))try{return typeof new URL(n)<"u"}catch(e){return!1}return!1}function NE(n){var e;return(e=n==null?void 0:n.proposer)==null?void 0:e.publicKey}function TE(n){return n==null?void 0:n.topic}function FE(n,e){let r=null;return Gt(n==null?void 0:n.publicKey,!1)||(r=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function rf(n){let e=!0;return ri(n)?n.length&&(e=n.every(r=>Gt(r,!1))):e=!1,e}function $E(n,e,r){let s=null;return ri(e)&&e.length?e.forEach(a=>{s||Mo(a)||(s=Tt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Mo(n)||(s=Tt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function UE(n,e,r){let s=null;return Object.entries(n).forEach(([a,l])=>{if(s)return;const p=$E(a,Td(a,l),`${e} ${r}`);p&&(s=p)}),s}function ME(n,e){let r=null;return ri(n)?n.forEach(s=>{r||PE(s)||(r=Tt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Tt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function LE(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=ME(s==null?void 0:s.accounts,`${e} namespace`);a&&(r=a)}),r}function jE(n,e){let r=null;return rf(n==null?void 0:n.methods)?rf(n==null?void 0:n.events)||(r=Tt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Tt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Bd(n,e){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=jE(s,`${e}, namespace`);a&&(r=a)}),r}function qE(n,e,r){let s=null;if(n&&Pn(n)){const a=Bd(n,e);a&&(s=a);const l=UE(n,e,r);l&&(s=l)}else s=ue("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return s}function No(n,e){let r=null;if(n&&Pn(n)){const s=Bd(n,e);s&&(r=s);const a=LE(n,e);a&&(r=a)}else r=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Hd(n){return Gt(n.protocol,!0)}function zE(n,e){let r=!1;return e&&!n?r=!0:n&&ri(n)&&n.length&&n.forEach(s=>{r=Hd(s)}),r}function BE(n){return typeof n=="number"}function vr(n){return typeof n<"u"&&typeof n!==null}function HE(n){return!(!n||typeof n!="object"||!n.code||!yu(n.code,!1)||!n.message||!Gt(n.message,!1))}function KE(n){return!(ar(n)||!Gt(n.method,!1))}function kE(n){return!(ar(n)||ar(n.result)&&ar(n.error)||!yu(n.id,!1)||!Gt(n.jsonrpc,!1))}function VE(n){return!(ar(n)||!Gt(n.name,!1))}function nf(n,e){return!(!Mo(e)||!DE(n).includes(e))}function GE(n,e,r){return Gt(r,!1)?SE(n,e).includes(r):!1}function WE(n,e,r){return Gt(r,!1)?IE(n,e).includes(r):!1}function sf(n,e,r){let s=null;const a=JE(n),l=YE(e),p=Object.keys(a),f=Object.keys(l),g=of(Object.keys(n)),w=of(Object.keys(e)),S=g.filter(T=>!w.includes(T));return S.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${S.toString()}
      Received: ${Object.keys(e).toString()}`)),en(p,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(T=>{if(!T.includes(":")||s)return;const j=Tn(e[T].accounts);j.includes(T)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${T}
        Required: ${T}
        Approved: ${j.toString()}`))}),p.forEach(T=>{s||(en(a[T].methods,l[T].methods)?en(a[T].events,l[T].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${T}`)):s=ue("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${T}`))}),s}function JE(n){const e={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?e[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{e[a]={methods:n[r].methods,events:n[r].events}})}),e}function of(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function YE(n){const e={};return Object.keys(n).forEach(r=>{if(r.includes(":"))e[r]=n[r];else{const s=Tn(n[r].accounts);s==null||s.forEach(a=>{e[a]={accounts:n[r].accounts.filter(l=>l.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),e}function XE(n,e){return yu(n,!1)&&n<=e.max&&n>=e.min}var Go={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});function QE(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch(e){return n}}bs.safeJsonParse=QE;function ZE(n){return typeof n=="string"?n:JSON.stringify(n,(e,r)=>typeof r>"u"?null:r)}bs.safeJsonStringify=ZE;var rs={exports:{}},af;function e3(){return af||(af=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Sr<"u"&&Sr.localStorage?rs.exports=Sr.localStorage:typeof window<"u"&&window.localStorage?rs.exports=window.localStorage:rs.exports=new e}()),rs.exports}var xc={},is={},cf;function t3(){if(cf)return is;cf=1,Object.defineProperty(is,"__esModule",{value:!0}),is.IKeyValueStorage=void 0;class n{}return is.IKeyValueStorage=n,is}var ns={},uf;function r3(){if(uf)return ns;uf=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.parseEntry=void 0;const n=bs;function e(r){var s;return[r[0],n.safeJsonParse((s=r[1])!==null&&s!==void 0?s:"")]}return ns.parseEntry=e,ns}var hf;function i3(){return hf||(hf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(t3(),n),e.__exportStar(r3(),n)}(xc)),xc}Object.defineProperty(Go,"__esModule",{value:!0});Go.KeyValueStorage=void 0;const Cn=jr,lf=bs,n3=Cn.__importDefault(e3()),s3=i3();class Kd{constructor(){this.localStorage=n3.default}getKeys(){return Cn.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Cn.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(s3.parseEntry)})}getItem(e){return Cn.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return lf.safeJsonParse(r)})}setItem(e,r){return Cn.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,lf.safeJsonStringify(r))})}removeItem(e){return Cn.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Go.KeyValueStorage=Kd;var o3=Go.default=Kd,Fn={},ss={},Oc={},os={};let nn=class{};const a3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:nn},Symbol.toStringTag,{value:"Module"})),c3=ld(a3);var ff;function u3(){if(ff)return os;ff=1,Object.defineProperty(os,"__esModule",{value:!0}),os.IHeartBeat=void 0;const n=c3;class e extends n.IEvents{constructor(s){super()}}return os.IHeartBeat=e,os}var df;function kd(){return df||(df=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(u3(),n)}(Oc)),Oc}var Cc={},Qi={},pf;function h3(){if(pf)return Qi;pf=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.HEARTBEAT_EVENTS=Qi.HEARTBEAT_INTERVAL=void 0;const n=ye;return Qi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Qi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Qi}var gf;function Vd(){return gf||(gf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),jr.__exportStar(h3(),n)}(Cc)),Cc}var vf;function l3(){if(vf)return ss;vf=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.HeartBeat=void 0;const n=jr,e=Lr,r=ye,s=kd(),a=Vd();class l extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||a.HEARTBEAT_INTERVAL}static init(f){return n.__awaiter(this,void 0,void 0,function*(){const g=new l(f);return yield g.init(),g})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return ss.HeartBeat=l,ss}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(l3(),n),e.__exportStar(kd(),n),e.__exportStar(Vd(),n)})(Fn);var Ze={},Ac,yf;function f3(){if(yf)return Ac;yf=1;function n(r){try{return JSON.stringify(r)}catch(s){return'"[Circular]"'}}Ac=e;function e(r,s,a){var l=a&&a.stringify||n,p=1;if(typeof r=="object"&&r!==null){var f=s.length+p;if(f===1)return r;var g=new Array(f);g[0]=l(r);for(var w=1;w<f;w++)g[w]=l(s[w]);return g.join(" ")}if(typeof r!="string")return r;var S=s.length;if(S===0)return r;for(var T="",j=1-p,P=-1,M=r&&r.length||0,H=0;H<M;){if(r.charCodeAt(H)===37&&H+1<M){switch(P=P>-1?P:0,r.charCodeAt(H+1)){case 100:case 102:if(j>=S||s[j]==null)break;P<H&&(T+=r.slice(P,H)),T+=Number(s[j]),P=H+2,H++;break;case 105:if(j>=S||s[j]==null)break;P<H&&(T+=r.slice(P,H)),T+=Math.floor(Number(s[j])),P=H+2,H++;break;case 79:case 111:case 106:if(j>=S||s[j]===void 0)break;P<H&&(T+=r.slice(P,H));var K=typeof s[j];if(K==="string"){T+="'"+s[j]+"'",P=H+2,H++;break}if(K==="function"){T+=s[j].name||"<anonymous>",P=H+2,H++;break}T+=l(s[j]),P=H+2,H++;break;case 115:if(j>=S)break;P<H&&(T+=r.slice(P,H)),T+=String(s[j]),P=H+2,H++;break;case 37:P<H&&(T+=r.slice(P,H)),T+="%",P=H+2,H++,j--;break}++j}++H}return P===-1?r:(P<M&&(T+=r.slice(P)),T)}return Ac}var Pc,_f;function d3(){if(_f)return Pc;_f=1;const n=f3();Pc=a;const e=x().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:H,wrapResponseSerializer:H,wrapErrorSerializer:H,req:M,res:M,err:j};function s(m,c){return Array.isArray(m)?m.filter(function(k){return k!=="!stdSerializers.err"}):m===!0?Object.keys(c):!1}function a(m){m=m||{},m.browser=m.browser||{};const c=m.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const _=m.browser.write||e;m.browser.write&&(m.browser.asObject=!0);const k=m.serializers||{},G=s(m.browser.serialize,k);let oe=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(oe=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),m.enabled===!1&&(m.level="silent");const ge=m.level||"info",R=Object.create(_);R.log||(R.log=K),Object.defineProperty(R,"levelVal",{get:le}),Object.defineProperty(R,"level",{get:te,set:W});const z={transmit:c,serialize:G,asObject:m.browser.asObject,levels:ce,timestamp:P(m)};R.levels=a.levels,R.level=ge,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=K,R.serializers=k,R._serialize=G,R._stdErrSerialize=oe,R.child=ee,c&&(R._logEvent=T());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,l(z,R,"error","log"),l(z,R,"fatal","error"),l(z,R,"warn","error"),l(z,R,"info","log"),l(z,R,"debug","log"),l(z,R,"trace","log")}function ee(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},G&&J.serializers&&(re.serializers=J.serializers);const xe=re.serializers;if(G&&xe){var ne=Object.assign({},k,xe),be=m.browser.serialize===!0?Object.keys(ne):G;delete J.serializers,g([J],be,ne,this._stdErrSerialize)}function he(_e){this._childLevel=(_e._childLevel|0)+1,this.error=w(_e,J,"error"),this.fatal=w(_e,J,"fatal"),this.warn=w(_e,J,"warn"),this.info=w(_e,J,"info"),this.debug=w(_e,J,"debug"),this.trace=w(_e,J,"trace"),ne&&(this.serializers=ne,this._serialize=be),c&&(this._logEvent=T([].concat(_e._logEvent.bindings,J)))}return he.prototype=this,new he(this)}return R}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:C,unixTime:$,isoTime:D});function l(m,c,_,k){const G=Object.getPrototypeOf(c);c[_]=c.levelVal>c.levels.values[_]?K:G[_]?G[_]:e[_]||e[k]||K,p(m,c,_)}function p(m,c,_){!m.transmit&&c[_]===K||(c[_]=function(k){return function(){const oe=m.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var R=0;R<ce.length;R++)ce[R]=arguments[R];if(m.serialize&&!m.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?k.call(ge,f(this,_,ce,oe)):k.apply(ge,ce),m.transmit){const z=m.transmit.level||c.level,le=a.levels.values[z],te=a.levels.values[_];if(te<le)return;S(this,{ts:oe,methodLevel:_,methodValue:te,transmitLevel:z,transmitValue:a.levels.values[m.transmit.level||c.level],send:m.transmit.send,val:c.levelVal},ce)}}}(c[_]))}function f(m,c,_,k){m._serialize&&g(_,m._serialize,m.serializers,m._stdErrSerialize);const G=_.slice();let oe=G[0];const ce={};k&&(ce.time=k),ce.level=a.levels.values[c];let ge=(m._childLevel|0)+1;if(ge<1&&(ge=1),oe!==null&&typeof oe=="object"){for(;ge--&&typeof G[0]=="object";)Object.assign(ce,G.shift());oe=G.length?n(G.shift(),G):void 0}else typeof oe=="string"&&(oe=n(G.shift(),G));return oe!==void 0&&(ce.msg=oe),ce}function g(m,c,_,k){for(const G in m)if(k&&m[G]instanceof Error)m[G]=a.stdSerializers.err(m[G]);else if(typeof m[G]=="object"&&!Array.isArray(m[G]))for(const oe in m[G])c&&c.indexOf(oe)>-1&&oe in _&&(m[G][oe]=_[oe](m[G][oe]))}function w(m,c,_){return function(){const k=new Array(1+arguments.length);k[0]=c;for(var G=1;G<k.length;G++)k[G]=arguments[G-1];return m[_].apply(this,k)}}function S(m,c,_){const k=c.send,G=c.ts,oe=c.methodLevel,ce=c.methodValue,ge=c.val,R=m._logEvent.bindings;g(_,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=G,m._logEvent.messages=_.filter(function(z){return R.indexOf(z)===-1}),m._logEvent.level.label=oe,m._logEvent.level.value=ce,k(oe,m._logEvent,ge),m._logEvent=T(R)}function T(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function j(m){const c={type:m.constructor.name,msg:m.message,stack:m.stack};for(const _ in m)c[_]===void 0&&(c[_]=m[_]);return c}function P(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?ie:C}function M(){return{}}function H(m){return m}function K(){}function ie(){return!1}function C(){return Date.now()}function $(){return Math.round(Date.now()/1e3)}function D(){return new Date(Date.now()).toISOString()}function x(){function m(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(c){return m(self)||m(window)||m(this)||{}}}return Pc}var Zi={},mf;function Gd(){return mf||(mf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.PINO_CUSTOM_CONTEXT_KEY=Zi.PINO_LOGGER_DEFAULTS=void 0,Zi.PINO_LOGGER_DEFAULTS={level:"info"},Zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Zi}var or={},bf;function p3(){if(bf)return or;bf=1,Object.defineProperty(or,"__esModule",{value:!0}),or.generateChildLogger=or.formatChildLoggerContext=or.getLoggerContext=or.setBrowserLoggerContext=or.getBrowserLoggerContext=or.getDefaultLoggerOptions=void 0;const n=Gd();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||n.PINO_LOGGER_DEFAULTS.level})}or.getDefaultLoggerOptions=e;function r(f,g=n.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}or.getBrowserLoggerContext=r;function s(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){return f[w]=g,f}or.setBrowserLoggerContext=s;function a(f,g=n.PINO_CUSTOM_CONTEXT_KEY){let w="";return typeof f.bindings>"u"?w=r(f,g):w=f.bindings().context||"",w}or.getLoggerContext=a;function l(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const S=a(f,w);return S.trim()?`${S}/${g}`:g}or.formatChildLoggerContext=l;function p(f,g,w=n.PINO_CUSTOM_CONTEXT_KEY){const S=l(f,g,w),T=f.child({context:S});return s(T,S,w)}return or.generateChildLogger=p,or}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=jr,r=e.__importDefault(d3());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Gd(),n),e.__exportStar(p3(),n)})(Ze);class g3 extends nn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class v3 extends nn{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class y3{constructor(e,r){this.logger=e,this.core=r}}let _3=class extends nn{constructor(e,r){super(),this.relayer=e,this.logger=r}},m3=class extends nn{constructor(e){super()}},b3=class{constructor(e,r,s,a){this.core=e,this.logger=r,this.name=s}};class w3 extends nn{constructor(e,r){super(),this.relayer=e,this.logger=r}}let E3=class extends nn{constructor(e,r){super(),this.core=e,this.logger=r}},D3=class{constructor(e,r){this.projectId=e,this.logger=r}},S3=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},I3=class{constructor(e){this.client=e}};const x3=n=>JSON.stringify(n,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),O3=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function C3(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return O3(n)}catch(e){return n}}function A3(n){return typeof n=="string"?n:x3(n)||""}var _u={},Wd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ue,r=Ir;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,w){if(w===void 0&&(w=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=w,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&w>0;)this._buffer[this._bufferLength++]=g[S++],w--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(w>=this.blockSize&&(S=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,S,w),w%=this.blockSize);w>0;)this._buffer[this._bufferLength++]=g[S++],w--;return this},f.prototype.finish=function(g){if(!this._finished){var w=this._bytesHashed,S=this._bufferLength,T=w/536870912|0,j=w<<3,P=w%128<112?128:256;this._buffer[S]=128;for(var M=S+1;M<P-8;M++)this._buffer[M]=0;e.writeUint32BE(T,this._buffer,P-8),e.writeUint32BE(j,this._buffer,P-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,P),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)e.writeUint32BE(this._stateHi[M],g,M*8),e.writeUint32BE(this._stateLo[M],g,M*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){r.wipe(g.stateHi),r.wipe(g.stateLo),g.buffer&&r.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(f,g,w,S,T,j,P){for(var M=w[0],H=w[1],K=w[2],ie=w[3],C=w[4],$=w[5],D=w[6],x=w[7],m=S[0],c=S[1],_=S[2],k=S[3],G=S[4],oe=S[5],ce=S[6],ge=S[7],R,z,le,te,W,ee,J,re;P>=128;){for(var xe=0;xe<16;xe++){var ne=8*xe+j;f[xe]=e.readUint32BE(T,ne),g[xe]=e.readUint32BE(T,ne+4)}for(var xe=0;xe<80;xe++){var be=M,he=H,_e=K,q=ie,L=C,A=$,h=D,I=x,se=m,fe=c,Se=_,Be=k,ke=G,Me=oe,pt=ce,gt=ge;if(R=x,z=ge,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=(C>>>14|G<<32-14)^(C>>>18|G<<32-18)^(G>>>41-32|C<<32-(41-32)),z=(G>>>14|C<<32-14)^(G>>>18|C<<32-18)^(C>>>41-32|G<<32-(41-32)),W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,R=C&$^~C&D,z=G&oe^~G&ce,W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,R=a[xe*2],z=a[xe*2+1],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,R=f[xe%16],z=g[xe%16],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,le=J&65535|re<<16,te=W&65535|ee<<16,R=le,z=te,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=(M>>>28|m<<32-28)^(m>>>34-32|M<<32-(34-32))^(m>>>39-32|M<<32-(39-32)),z=(m>>>28|M<<32-28)^(M>>>34-32|m<<32-(34-32))^(M>>>39-32|m<<32-(39-32)),W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,R=M&H^M&K^H&K,z=m&c^m&_^c&_,W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,I=J&65535|re<<16,gt=W&65535|ee<<16,R=q,z=Be,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=le,z=te,W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,q=J&65535|re<<16,Be=W&65535|ee<<16,H=be,K=he,ie=_e,C=q,$=L,D=A,x=h,M=I,c=se,_=fe,k=Se,G=Be,oe=ke,ce=Me,ge=pt,m=gt,xe%16===15)for(var ne=0;ne<16;ne++)R=f[ne],z=g[ne],W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=f[(ne+9)%16],z=g[(ne+9)%16],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,le=f[(ne+1)%16],te=g[(ne+1)%16],R=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,z=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,le=f[(ne+14)%16],te=g[(ne+14)%16],R=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,z=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,f[ne]=J&65535|re<<16,g[ne]=W&65535|ee<<16}R=M,z=m,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[0],z=S[0],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[0]=M=J&65535|re<<16,S[0]=m=W&65535|ee<<16,R=H,z=c,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[1],z=S[1],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[1]=H=J&65535|re<<16,S[1]=c=W&65535|ee<<16,R=K,z=_,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[2],z=S[2],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[2]=K=J&65535|re<<16,S[2]=_=W&65535|ee<<16,R=ie,z=k,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[3],z=S[3],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[3]=ie=J&65535|re<<16,S[3]=k=W&65535|ee<<16,R=C,z=G,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[4],z=S[4],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[4]=C=J&65535|re<<16,S[4]=G=W&65535|ee<<16,R=$,z=oe,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[5],z=S[5],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[5]=$=J&65535|re<<16,S[5]=oe=W&65535|ee<<16,R=D,z=ce,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[6],z=S[6],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[6]=D=J&65535|re<<16,S[6]=ce=W&65535|ee<<16,R=x,z=ge,W=z&65535,ee=z>>>16,J=R&65535,re=R>>>16,R=w[7],z=S[7],W+=z&65535,ee+=z>>>16,J+=R&65535,re+=R>>>16,ee+=W>>>16,J+=ee>>>16,re+=J>>>16,w[7]=x=J&65535|re<<16,S[7]=ge=W&65535|ee<<16,j+=128,P-=128}return j}function p(f){var g=new s;g.update(f);var w=g.digest();return g.clean(),w}n.hash=p})(Wd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=Rn,r=Wd,s=Ir;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(q){const L=new Float64Array(16);if(q)for(let A=0;A<q.length;A++)L[A]=q[A];return L}const l=new Uint8Array(32);l[0]=9;const p=a(),f=a([1]),g=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),w=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function P(q,L){for(let A=0;A<16;A++)q[A]=L[A]|0}function M(q){let L=1;for(let A=0;A<16;A++){let h=q[A]+L+65535;L=Math.floor(h/65536),q[A]=h-L*65536}q[0]+=L-1+37*(L-1)}function H(q,L,A){const h=~(A-1);for(let I=0;I<16;I++){const se=h&(q[I]^L[I]);q[I]^=se,L[I]^=se}}function K(q,L){const A=a(),h=a();for(let I=0;I<16;I++)h[I]=L[I];M(h),M(h),M(h);for(let I=0;I<2;I++){A[0]=h[0]-65517;for(let fe=1;fe<15;fe++)A[fe]=h[fe]-65535-(A[fe-1]>>16&1),A[fe-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const se=A[15]>>16&1;A[14]&=65535,H(h,A,1-se)}for(let I=0;I<16;I++)q[2*I]=h[I]&255,q[2*I+1]=h[I]>>8}function ie(q,L){let A=0;for(let h=0;h<32;h++)A|=q[h]^L[h];return(1&A-1>>>8)-1}function C(q,L){const A=new Uint8Array(32),h=new Uint8Array(32);return K(A,q),K(h,L),ie(A,h)}function $(q){const L=new Uint8Array(32);return K(L,q),L[0]&1}function D(q,L){for(let A=0;A<16;A++)q[A]=L[2*A]+(L[2*A+1]<<8);q[15]&=32767}function x(q,L,A){for(let h=0;h<16;h++)q[h]=L[h]+A[h]}function m(q,L,A){for(let h=0;h<16;h++)q[h]=L[h]-A[h]}function c(q,L,A){let h,I,se=0,fe=0,Se=0,Be=0,ke=0,Me=0,pt=0,gt=0,je=0,Ie=0,Te=0,Fe=0,qe=0,Ce=0,$e=0,De=0,Ae=0,He=0,Oe=0,Ve=0,We=0,et=0,tt=0,Ye=0,er=0,hr=0,Gr=0,tr=0,ii=0,yi=0,Ui=0,wt=A[0],vt=A[1],Et=A[2],Dt=A[3],mt=A[4],yt=A[5],$t=A[6],Ut=A[7],St=A[8],Mt=A[9],It=A[10],At=A[11],xt=A[12],ht=A[13],Lt=A[14],jt=A[15];h=L[0],se+=h*wt,fe+=h*vt,Se+=h*Et,Be+=h*Dt,ke+=h*mt,Me+=h*yt,pt+=h*$t,gt+=h*Ut,je+=h*St,Ie+=h*Mt,Te+=h*It,Fe+=h*At,qe+=h*xt,Ce+=h*ht,$e+=h*Lt,De+=h*jt,h=L[1],fe+=h*wt,Se+=h*vt,Be+=h*Et,ke+=h*Dt,Me+=h*mt,pt+=h*yt,gt+=h*$t,je+=h*Ut,Ie+=h*St,Te+=h*Mt,Fe+=h*It,qe+=h*At,Ce+=h*xt,$e+=h*ht,De+=h*Lt,Ae+=h*jt,h=L[2],Se+=h*wt,Be+=h*vt,ke+=h*Et,Me+=h*Dt,pt+=h*mt,gt+=h*yt,je+=h*$t,Ie+=h*Ut,Te+=h*St,Fe+=h*Mt,qe+=h*It,Ce+=h*At,$e+=h*xt,De+=h*ht,Ae+=h*Lt,He+=h*jt,h=L[3],Be+=h*wt,ke+=h*vt,Me+=h*Et,pt+=h*Dt,gt+=h*mt,je+=h*yt,Ie+=h*$t,Te+=h*Ut,Fe+=h*St,qe+=h*Mt,Ce+=h*It,$e+=h*At,De+=h*xt,Ae+=h*ht,He+=h*Lt,Oe+=h*jt,h=L[4],ke+=h*wt,Me+=h*vt,pt+=h*Et,gt+=h*Dt,je+=h*mt,Ie+=h*yt,Te+=h*$t,Fe+=h*Ut,qe+=h*St,Ce+=h*Mt,$e+=h*It,De+=h*At,Ae+=h*xt,He+=h*ht,Oe+=h*Lt,Ve+=h*jt,h=L[5],Me+=h*wt,pt+=h*vt,gt+=h*Et,je+=h*Dt,Ie+=h*mt,Te+=h*yt,Fe+=h*$t,qe+=h*Ut,Ce+=h*St,$e+=h*Mt,De+=h*It,Ae+=h*At,He+=h*xt,Oe+=h*ht,Ve+=h*Lt,We+=h*jt,h=L[6],pt+=h*wt,gt+=h*vt,je+=h*Et,Ie+=h*Dt,Te+=h*mt,Fe+=h*yt,qe+=h*$t,Ce+=h*Ut,$e+=h*St,De+=h*Mt,Ae+=h*It,He+=h*At,Oe+=h*xt,Ve+=h*ht,We+=h*Lt,et+=h*jt,h=L[7],gt+=h*wt,je+=h*vt,Ie+=h*Et,Te+=h*Dt,Fe+=h*mt,qe+=h*yt,Ce+=h*$t,$e+=h*Ut,De+=h*St,Ae+=h*Mt,He+=h*It,Oe+=h*At,Ve+=h*xt,We+=h*ht,et+=h*Lt,tt+=h*jt,h=L[8],je+=h*wt,Ie+=h*vt,Te+=h*Et,Fe+=h*Dt,qe+=h*mt,Ce+=h*yt,$e+=h*$t,De+=h*Ut,Ae+=h*St,He+=h*Mt,Oe+=h*It,Ve+=h*At,We+=h*xt,et+=h*ht,tt+=h*Lt,Ye+=h*jt,h=L[9],Ie+=h*wt,Te+=h*vt,Fe+=h*Et,qe+=h*Dt,Ce+=h*mt,$e+=h*yt,De+=h*$t,Ae+=h*Ut,He+=h*St,Oe+=h*Mt,Ve+=h*It,We+=h*At,et+=h*xt,tt+=h*ht,Ye+=h*Lt,er+=h*jt,h=L[10],Te+=h*wt,Fe+=h*vt,qe+=h*Et,Ce+=h*Dt,$e+=h*mt,De+=h*yt,Ae+=h*$t,He+=h*Ut,Oe+=h*St,Ve+=h*Mt,We+=h*It,et+=h*At,tt+=h*xt,Ye+=h*ht,er+=h*Lt,hr+=h*jt,h=L[11],Fe+=h*wt,qe+=h*vt,Ce+=h*Et,$e+=h*Dt,De+=h*mt,Ae+=h*yt,He+=h*$t,Oe+=h*Ut,Ve+=h*St,We+=h*Mt,et+=h*It,tt+=h*At,Ye+=h*xt,er+=h*ht,hr+=h*Lt,Gr+=h*jt,h=L[12],qe+=h*wt,Ce+=h*vt,$e+=h*Et,De+=h*Dt,Ae+=h*mt,He+=h*yt,Oe+=h*$t,Ve+=h*Ut,We+=h*St,et+=h*Mt,tt+=h*It,Ye+=h*At,er+=h*xt,hr+=h*ht,Gr+=h*Lt,tr+=h*jt,h=L[13],Ce+=h*wt,$e+=h*vt,De+=h*Et,Ae+=h*Dt,He+=h*mt,Oe+=h*yt,Ve+=h*$t,We+=h*Ut,et+=h*St,tt+=h*Mt,Ye+=h*It,er+=h*At,hr+=h*xt,Gr+=h*ht,tr+=h*Lt,ii+=h*jt,h=L[14],$e+=h*wt,De+=h*vt,Ae+=h*Et,He+=h*Dt,Oe+=h*mt,Ve+=h*yt,We+=h*$t,et+=h*Ut,tt+=h*St,Ye+=h*Mt,er+=h*It,hr+=h*At,Gr+=h*xt,tr+=h*ht,ii+=h*Lt,yi+=h*jt,h=L[15],De+=h*wt,Ae+=h*vt,He+=h*Et,Oe+=h*Dt,Ve+=h*mt,We+=h*yt,et+=h*$t,tt+=h*Ut,Ye+=h*St,er+=h*Mt,hr+=h*It,Gr+=h*At,tr+=h*xt,ii+=h*ht,yi+=h*Lt,Ui+=h*jt,se+=38*Ae,fe+=38*He,Se+=38*Oe,Be+=38*Ve,ke+=38*We,Me+=38*et,pt+=38*tt,gt+=38*Ye,je+=38*er,Ie+=38*hr,Te+=38*Gr,Fe+=38*tr,qe+=38*ii,Ce+=38*yi,$e+=38*Ui,I=1,h=se+I+65535,I=Math.floor(h/65536),se=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=ke+I+65535,I=Math.floor(h/65536),ke=h-I*65536,h=Me+I+65535,I=Math.floor(h/65536),Me=h-I*65536,h=pt+I+65535,I=Math.floor(h/65536),pt=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=qe+I+65535,I=Math.floor(h/65536),qe=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,se+=I-1+37*(I-1),I=1,h=se+I+65535,I=Math.floor(h/65536),se=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=ke+I+65535,I=Math.floor(h/65536),ke=h-I*65536,h=Me+I+65535,I=Math.floor(h/65536),Me=h-I*65536,h=pt+I+65535,I=Math.floor(h/65536),pt=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=qe+I+65535,I=Math.floor(h/65536),qe=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,se+=I-1+37*(I-1),q[0]=se,q[1]=fe,q[2]=Se,q[3]=Be,q[4]=ke,q[5]=Me,q[6]=pt,q[7]=gt,q[8]=je,q[9]=Ie,q[10]=Te,q[11]=Fe,q[12]=qe,q[13]=Ce,q[14]=$e,q[15]=De}function _(q,L){c(q,L,L)}function k(q,L){const A=a();let h;for(h=0;h<16;h++)A[h]=L[h];for(h=253;h>=0;h--)_(A,A),h!==2&&h!==4&&c(A,A,L);for(h=0;h<16;h++)q[h]=A[h]}function G(q,L){const A=a();let h;for(h=0;h<16;h++)A[h]=L[h];for(h=250;h>=0;h--)_(A,A),h!==1&&c(A,A,L);for(h=0;h<16;h++)q[h]=A[h]}function oe(q,L){const A=a(),h=a(),I=a(),se=a(),fe=a(),Se=a(),Be=a(),ke=a(),Me=a();m(A,q[1],q[0]),m(Me,L[1],L[0]),c(A,A,Me),x(h,q[0],q[1]),x(Me,L[0],L[1]),c(h,h,Me),c(I,q[3],L[3]),c(I,I,w),c(se,q[2],L[2]),x(se,se,se),m(fe,h,A),m(Se,se,I),x(Be,se,I),x(ke,h,A),c(q[0],fe,Se),c(q[1],ke,Be),c(q[2],Be,Se),c(q[3],fe,ke)}function ce(q,L,A){for(let h=0;h<4;h++)H(q[h],L[h],A)}function ge(q,L){const A=a(),h=a(),I=a();k(I,L[2]),c(A,L[0],I),c(h,L[1],I),K(q,h),q[31]^=$(A)<<7}function R(q,L,A){P(q[0],p),P(q[1],f),P(q[2],f),P(q[3],p);for(let h=255;h>=0;--h){const I=A[h/8|0]>>(h&7)&1;ce(q,L,I),oe(L,q),oe(q,q),ce(q,L,I)}}function z(q,L){const A=[a(),a(),a(),a()];P(A[0],S),P(A[1],T),P(A[2],f),c(A[3],S,T),R(q,A,L)}function le(q){if(q.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const L=(0,r.hash)(q);L[0]&=248,L[31]&=127,L[31]|=64;const A=new Uint8Array(32),h=[a(),a(),a(),a()];z(h,L),ge(A,h);const I=new Uint8Array(64);return I.set(q),I.set(A,32),{publicKey:A,secretKey:I}}n.generateKeyPairFromSeed=le;function te(q){const L=(0,e.randomBytes)(32,q),A=le(L);return(0,s.wipe)(L),A}n.generateKeyPair=te;function W(q){if(q.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(q.subarray(32))}n.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(q,L){let A,h,I,se;for(h=63;h>=32;--h){for(A=0,I=h-32,se=h-12;I<se;++I)L[I]+=A-16*L[h]*ee[I-(h-32)],A=Math.floor((L[I]+128)/256),L[I]-=A*256;L[I]+=A,L[h]=0}for(A=0,I=0;I<32;I++)L[I]+=A-(L[31]>>4)*ee[I],A=L[I]>>8,L[I]&=255;for(I=0;I<32;I++)L[I]-=A*ee[I];for(h=0;h<32;h++)L[h+1]+=L[h]>>8,q[h]=L[h]&255}function re(q){const L=new Float64Array(64);for(let A=0;A<64;A++)L[A]=q[A];for(let A=0;A<64;A++)q[A]=0;J(q,L)}function xe(q,L){const A=new Float64Array(64),h=[a(),a(),a(),a()],I=(0,r.hash)(q.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const se=new Uint8Array(64);se.set(I.subarray(32),32);const fe=new r.SHA512;fe.update(se.subarray(32)),fe.update(L);const Se=fe.digest();fe.clean(),re(Se),z(h,Se),ge(se,h),fe.reset(),fe.update(se.subarray(0,32)),fe.update(q.subarray(32)),fe.update(L);const Be=fe.digest();re(Be);for(let ke=0;ke<32;ke++)A[ke]=Se[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)A[ke+Me]+=Be[ke]*I[Me];return J(se.subarray(32),A),se}n.sign=xe;function ne(q,L){const A=a(),h=a(),I=a(),se=a(),fe=a(),Se=a(),Be=a();return P(q[2],f),D(q[1],L),_(I,q[1]),c(se,I,g),m(I,I,q[2]),x(se,q[2],se),_(fe,se),_(Se,fe),c(Be,Se,fe),c(A,Be,I),c(A,A,se),G(A,A),c(A,A,I),c(A,A,se),c(A,A,se),c(q[0],A,se),_(h,q[0]),c(h,h,se),C(h,I)&&c(q[0],q[0],j),_(h,q[0]),c(h,h,se),C(h,I)?-1:($(q[0])===L[31]>>7&&m(q[0],p,q[0]),c(q[3],q[0],q[1]),0)}function be(q,L,A){const h=new Uint8Array(32),I=[a(),a(),a(),a()],se=[a(),a(),a(),a()];if(A.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ne(se,q))return!1;const fe=new r.SHA512;fe.update(A.subarray(0,32)),fe.update(q),fe.update(L);const Se=fe.digest();return re(Se),R(I,se,Se),z(se,A.subarray(32)),oe(I,se),ge(h,I),!ie(A,h)}n.verify=be;function he(q){let L=[a(),a(),a(),a()];if(ne(L,q))throw new Error("Ed25519: invalid public key");let A=a(),h=a(),I=L[1];x(A,f,I),m(h,f,I),k(h,h),c(A,A,h);let se=new Uint8Array(32);return K(se,A),se}n.convertPublicKeyToX25519=he;function _e(q){const L=(0,r.hash)(q.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const A=new Uint8Array(L.subarray(0,32));return(0,s.wipe)(L),A}n.convertSecretKeyToX25519=_e})(_u);const P3="EdDSA",R3="JWT",Jd=".",Yd="base64url",N3="utf8",T3="utf8",F3=":",$3="did",U3="key",wf="base58btc",M3="z",L3="K36",j3=32;function q3(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch(e){return n}}function Xc(n){return typeof n=="string"?n:JSON.stringify(n)}function Lo(n){return ur(yr(Xc(n),N3),Yd)}function Xd(n){const e=yr(L3,wf),r=M3+ur(kc([e,n]),wf);return[$3,U3,r].join(F3)}function z3(n){return ur(n,Yd)}function B3(n){return yr([Lo(n.header),Lo(n.payload)].join(Jd),T3)}function H3(n){return[Lo(n.header),Lo(n.payload),z3(n.signature)].join(Jd)}function Ef(n=Rn.randomBytes(j3)){return _u.generateKeyPairFromSeed(n)}async function K3(n,e,r,s,a=ye.fromMiliseconds(Date.now())){const l={alg:P3,typ:R3},p=Xd(s.publicKey),f=a+r,g={iss:p,sub:n,aud:e,iat:a,exp:f},w=B3({header:l,payload:g}),S=_u.sign(s.secretKey,w);return H3({header:l,payload:g,signature:S})}var Qd={},gi={},Df;function k3(){if(Df)return gi;Df=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.isBrowserCryptoAvailable=gi.getSubtleCrypto=gi.getBrowerCrypto=void 0;function n(){return(Sr===null||Sr===void 0?void 0:Sr.crypto)||(Sr===null||Sr===void 0?void 0:Sr.msCrypto)||{}}gi.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}gi.getSubtleCrypto=e;function r(){return!!n()&&!!e()}return gi.isBrowserCryptoAvailable=r,gi}var vi={},Sf;function V3(){if(Sf)return vi;Sf=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.isBrowser=vi.isNode=vi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}vi.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}vi.isNode=e;function r(){return!n()&&!e()}return vi.isBrowser=r,vi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=jr;e.__exportStar(k3(),n),e.__exportStar(V3(),n)})(Qd);function Zd(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function G3(n=6){return BigInt(Zd(n))}function W3(n,e,r){return{id:r||Zd(),jsonrpc:"2.0",method:n,params:e}}class J3{}class Y3 extends J3{constructor(){super()}}class X3 extends Y3{constructor(e){super()}}function Q3(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function Z3(n){return Q3(n)&&(e6(n)||ep(n))}function e6(n){return"result"in n}function ep(n){return"error"in n}class Fi extends X3{constructor(e){super(e),this.events=new Lr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(W3(e.method,e.params||[],e.id||G3().toString()),r)}async requestStrict(e,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(l){a(l)}this.events.on(`${e.id}`,l=>{ep(l)?a(l.error):s(l.result)});try{await this.connection.send(e,r)}catch(l){a(l)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Z3(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const t6="PARSE_ERROR",r6="INVALID_REQUEST",i6="METHOD_NOT_FOUND",n6="INVALID_PARAMS",tp="INTERNAL_ERROR",mu="SERVER_ERROR",s6=[-32700,-32600,-32601,-32602,-32603],ds={[t6]:{code:-32700,message:"Parse error"},[r6]:{code:-32600,message:"Invalid Request"},[i6]:{code:-32601,message:"Method not found"},[n6]:{code:-32602,message:"Invalid params"},[tp]:{code:-32603,message:"Internal error"},[mu]:{code:-32e3,message:"Server error"}},rp=mu;function o6(n){return s6.includes(n)}function If(n){return Object.keys(ds).includes(n)?ds[n]:ds[rp]}function a6(n){const e=Object.values(ds).find(r=>r.code===n);return e||ds[rp]}function ip(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function c6(n=6){return BigInt(ip(n))}function np(n,e,r){return{id:r||ip(),jsonrpc:"2.0",method:n,params:e}}function sp(n,e){return{id:n,jsonrpc:"2.0",result:e}}function u6(n,e,r){return{id:n,jsonrpc:"2.0",error:h6(e,r)}}function h6(n,e){return typeof n>"u"?If(tp):(typeof n=="string"&&(n=Object.assign(Object.assign({},If(mu)),{message:n})),typeof e<"u"&&(n.data=e),o6(n.code)&&(n=a6(n.code)),n)}function op(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function ap(n){return op(n)&&"method"in n}function cp(n){return op(n)&&(up(n)||bu(n))}function up(n){return"result"in n}function bu(n){return"error"in n}const l6=n=>JSON.stringify(n,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),f6=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function d6(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return f6(n)}catch(e){return n}}function p6(n){return typeof n=="string"?n:l6(n)||""}const g6="PARSE_ERROR",v6="INVALID_REQUEST",y6="METHOD_NOT_FOUND",_6="INVALID_PARAMS",hp="INTERNAL_ERROR",wu="SERVER_ERROR",m6=[-32700,-32600,-32601,-32602,-32603],ps={[g6]:{code:-32700,message:"Parse error"},[v6]:{code:-32600,message:"Invalid Request"},[y6]:{code:-32601,message:"Method not found"},[_6]:{code:-32602,message:"Invalid params"},[hp]:{code:-32603,message:"Internal error"},[wu]:{code:-32e3,message:"Server error"}},lp=wu;function b6(n){return m6.includes(n)}function xf(n){return Object.keys(ps).includes(n)?ps[n]:ps[lp]}function w6(n){const e=Object.values(ps).find(r=>r.code===n);return e||ps[lp]}function fp(n,e,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):n}function dp(n,e,r){return{id:n,jsonrpc:"2.0",error:E6(e,r)}}function E6(n,e){return typeof n>"u"?xf(hp):(typeof n=="string"&&(n=Object.assign(Object.assign({},xf(wu)),{message:n})),typeof e<"u"&&(n.data=e),b6(n.code)&&(n=w6(n.code)),n)}const D6="^https?:",S6="^wss?:";function I6(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function pp(n,e){const r=I6(n);return typeof r>"u"?!1:new RegExp(e).test(r)}function Of(n){return pp(n,D6)}function Cf(n){return pp(n,S6)}function x6(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}const O6=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),C6=()=>typeof window<"u",Af=n=>n.split("?")[0],Pf=10,A6=O6();class P6{constructor(e){if(this.url=e,this.events=new Lr.EventEmitter,this.registering=!1,!Cf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(p6(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Cf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,s)=>{const a=Qd.isReactNative()?void 0:{rejectUnauthorized:!x6(e)},l=new A6(e,[],a);C6()?l.onerror=p=>{const f=p;s(this.emitError(f.error))}:l.on("error",p=>{s(this.emitError(p))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?d6(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),l=dp(e,a);this.events.emit("payload",l)}parseError(e,r=this.url){return fp(e,Af(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Pf&&this.events.setMaxListeners(Pf)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Af(this.url)}`));return this.events.emit("register_error",r),r}}var jo={exports:{}};jo.exports;(function(n,e){var r=200,s="__lodash_hash_undefined__",a=1,l=2,p=9007199254740991,f="[object Arguments]",g="[object Array]",w="[object AsyncFunction]",S="[object Boolean]",T="[object Date]",j="[object Error]",P="[object Function]",M="[object GeneratorFunction]",H="[object Map]",K="[object Number]",ie="[object Null]",C="[object Object]",$="[object Promise]",D="[object Proxy]",x="[object RegExp]",m="[object Set]",c="[object String]",_="[object Symbol]",k="[object Undefined]",G="[object WeakMap]",oe="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",R="[object Float64Array]",z="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,ne=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[R]=he[z]=he[le]=he[te]=he[W]=he[ee]=he[J]=he[re]=!0,he[f]=he[g]=he[oe]=he[S]=he[ce]=he[T]=he[j]=he[P]=he[H]=he[K]=he[C]=he[x]=he[m]=he[c]=he[G]=!1;var _e=typeof Sr=="object"&&Sr&&Sr.Object===Object&&Sr,q=typeof self=="object"&&self&&self.Object===Object&&self,L=_e||q||Function("return this")(),A=e&&!e.nodeType&&e,h=A&&!0&&n&&!n.nodeType&&n,I=h&&h.exports===A,se=I&&_e.process,fe=function(){try{return se&&se.binding&&se.binding("util")}catch(b){}}(),Se=fe&&fe.isTypedArray;function Be(b,N){for(var Q=-1,de=b==null?0:b.length,at=0,Re=[];++Q<de;){var ft=b[Q];N(ft,Q,b)&&(Re[at++]=ft)}return Re}function ke(b,N){for(var Q=-1,de=N.length,at=b.length;++Q<de;)b[at+Q]=N[Q];return b}function Me(b,N){for(var Q=-1,de=b==null?0:b.length;++Q<de;)if(N(b[Q],Q,b))return!0;return!1}function pt(b,N){for(var Q=-1,de=Array(b);++Q<b;)de[Q]=N(Q);return de}function gt(b){return function(N){return b(N)}}function je(b,N){return b.has(N)}function Ie(b,N){return b==null?void 0:b[N]}function Te(b){var N=-1,Q=Array(b.size);return b.forEach(function(de,at){Q[++N]=[at,de]}),Q}function Fe(b,N){return function(Q){return b(N(Q))}}function qe(b){var N=-1,Q=Array(b.size);return b.forEach(function(de){Q[++N]=de}),Q}var Ce=Array.prototype,$e=Function.prototype,De=Object.prototype,Ae=L["__core-js_shared__"],He=$e.toString,Oe=De.hasOwnProperty,Ve=function(){var b=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),We=De.toString,et=RegExp("^"+He.call(Oe).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=I?L.Buffer:void 0,Ye=L.Symbol,er=L.Uint8Array,hr=De.propertyIsEnumerable,Gr=Ce.splice,tr=Ye?Ye.toStringTag:void 0,ii=Object.getOwnPropertySymbols,yi=tt?tt.isBuffer:void 0,Ui=Fe(Object.keys,Object),wt=_r(L,"DataView"),vt=_r(L,"Map"),Et=_r(L,"Promise"),Dt=_r(L,"Set"),mt=_r(L,"WeakMap"),yt=_r(Object,"create"),$t=si(wt),Ut=si(vt),St=si(Et),Mt=si(Dt),It=si(mt),At=Ye?Ye.prototype:void 0,xt=At?At.valueOf:void 0;function ht(b){var N=-1,Q=b==null?0:b.length;for(this.clear();++N<Q;){var de=b[N];this.set(de[0],de[1])}}function Lt(){this.__data__=yt?yt(null):{},this.size=0}function jt(b){var N=this.has(b)&&delete this.__data__[b];return this.size-=N?1:0,N}function Yo(b){var N=this.__data__;if(yt){var Q=N[b];return Q===s?void 0:Q}return Oe.call(N,b)?N[b]:void 0}function Xo(b){var N=this.__data__;return yt?N[b]!==void 0:Oe.call(N,b)}function Qo(b,N){var Q=this.__data__;return this.size+=this.has(b)?0:1,Q[b]=yt&&N===void 0?s:N,this}ht.prototype.clear=Lt,ht.prototype.delete=jt,ht.prototype.get=Yo,ht.prototype.has=Xo,ht.prototype.set=Qo;function xr(b){var N=-1,Q=b==null?0:b.length;for(this.clear();++N<Q;){var de=b[N];this.set(de[0],de[1])}}function Zo(){this.__data__=[],this.size=0}function ea(b){var N=this.__data__,Q=Mi(N,b);if(Q<0)return!1;var de=N.length-1;return Q==de?N.pop():Gr.call(N,Q,1),--this.size,!0}function ta(b){var N=this.__data__,Q=Mi(N,b);return Q<0?void 0:N[Q][1]}function ra(b){return Mi(this.__data__,b)>-1}function ia(b,N){var Q=this.__data__,de=Mi(Q,b);return de<0?(++this.size,Q.push([b,N])):Q[de][1]=N,this}xr.prototype.clear=Zo,xr.prototype.delete=ea,xr.prototype.get=ta,xr.prototype.has=ra,xr.prototype.set=ia;function ni(b){var N=-1,Q=b==null?0:b.length;for(this.clear();++N<Q;){var de=b[N];this.set(de[0],de[1])}}function on(){this.size=0,this.__data__={hash:new ht,map:new(vt||xr),string:new ht}}function na(b){var N=_i(this,b).delete(b);return this.size-=N?1:0,N}function an(b){return _i(this,b).get(b)}function sa(b){return _i(this,b).has(b)}function oa(b,N){var Q=_i(this,b),de=Q.size;return Q.set(b,N),this.size+=Q.size==de?0:1,this}ni.prototype.clear=on,ni.prototype.delete=na,ni.prototype.get=an,ni.prototype.has=sa,ni.prototype.set=oa;function cn(b){var N=-1,Q=b==null?0:b.length;for(this.__data__=new ni;++N<Q;)this.add(b[N])}function Es(b){return this.__data__.set(b,s),this}function Ds(b){return this.__data__.has(b)}cn.prototype.add=cn.prototype.push=Es,cn.prototype.has=Ds;function qr(b){var N=this.__data__=new xr(b);this.size=N.size}function aa(){this.__data__=new xr,this.size=0}function ca(b){var N=this.__data__,Q=N.delete(b);return this.size=N.size,Q}function ua(b){return this.__data__.get(b)}function ha(b){return this.__data__.has(b)}function Ss(b,N){var Q=this.__data__;if(Q instanceof xr){var de=Q.__data__;if(!vt||de.length<r-1)return de.push([b,N]),this.size=++Q.size,this;Q=this.__data__=new ni(de)}return Q.set(b,N),this.size=Q.size,this}qr.prototype.clear=aa,qr.prototype.delete=ca,qr.prototype.get=ua,qr.prototype.has=ha,qr.prototype.set=Ss;function Is(b,N){var Q=ln(b),de=!Q&&Ms(b),at=!Q&&!de&&Mn(b),Re=!Q&&!de&&!at&&qs(b),ft=Q||de||at||Re,qt=ft?pt(b.length,String):[],Xe=qt.length;for(var ct in b)(N||Oe.call(b,ct))&&!(ft&&(ct=="length"||at&&(ct=="offset"||ct=="parent")||Re&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||Ns(ct,Xe)))&&qt.push(ct);return qt}function Mi(b,N){for(var Q=b.length;Q--;)if(Us(b[Q][0],N))return Q;return-1}function $n(b,N,Q){var de=N(b);return ln(b)?de:ke(de,Q(b))}function Li(b){return b==null?b===void 0?k:ie:tr&&tr in Object(b)?Ps(b):da(b)}function Un(b){return qi(b)&&Li(b)==f}function ji(b,N,Q,de,at){return b===N?!0:b==null||N==null||!qi(b)&&!qi(N)?b!==b&&N!==N:xs(b,N,Q,de,ji,at)}function xs(b,N,Q,de,at,Re){var ft=ln(b),qt=ln(N),Xe=ft?g:Wr(b),ct=qt?g:Wr(N);Xe=Xe==f?C:Xe,ct=ct==f?C:ct;var Pt=Xe==C,lr=ct==C,zt=Xe==ct;if(zt&&Mn(b)){if(!Mn(N))return!1;ft=!0,Pt=!1}if(zt&&!Pt)return Re||(Re=new qr),ft||qs(b)?un(b,N,Q,de,at,Re):fa(b,N,Xe,Q,de,at,Re);if(!(Q&a)){var dt=Pt&&Oe.call(b,"__wrapped__"),rr=lr&&Oe.call(N,"__wrapped__");if(dt||rr){var zr=dt?b.value():b,Or=rr?N.value():N;return Re||(Re=new qr),at(zr,Or,Q,de,Re)}}return zt?(Re||(Re=new qr),As(b,N,Q,de,at,Re)):!1}function la(b){if(!js(b)||Fs(b))return!1;var N=fn(b)?et:ne;return N.test(si(b))}function Os(b){return qi(b)&&Ls(b.length)&&!!he[Li(b)]}function Cs(b){if(!$s(b))return Ui(b);var N=[];for(var Q in Object(b))Oe.call(b,Q)&&Q!="constructor"&&N.push(Q);return N}function un(b,N,Q,de,at,Re){var ft=Q&a,qt=b.length,Xe=N.length;if(qt!=Xe&&!(ft&&Xe>qt))return!1;var ct=Re.get(b);if(ct&&Re.get(N))return ct==N;var Pt=-1,lr=!0,zt=Q&l?new cn:void 0;for(Re.set(b,N),Re.set(N,b);++Pt<qt;){var dt=b[Pt],rr=N[Pt];if(de)var zr=ft?de(rr,dt,Pt,N,b,Re):de(dt,rr,Pt,b,N,Re);if(zr!==void 0){if(zr)continue;lr=!1;break}if(zt){if(!Me(N,function(Or,Jr){if(!je(zt,Jr)&&(dt===Or||at(dt,Or,Q,de,Re)))return zt.push(Jr)})){lr=!1;break}}else if(!(dt===rr||at(dt,rr,Q,de,Re))){lr=!1;break}}return Re.delete(b),Re.delete(N),lr}function fa(b,N,Q,de,at,Re,ft){switch(Q){case ce:if(b.byteLength!=N.byteLength||b.byteOffset!=N.byteOffset)return!1;b=b.buffer,N=N.buffer;case oe:return!(b.byteLength!=N.byteLength||!Re(new er(b),new er(N)));case S:case T:case K:return Us(+b,+N);case j:return b.name==N.name&&b.message==N.message;case x:case c:return b==N+"";case H:var qt=Te;case m:var Xe=de&a;if(qt||(qt=qe),b.size!=N.size&&!Xe)return!1;var ct=ft.get(b);if(ct)return ct==N;de|=l,ft.set(b,N);var Pt=un(qt(b),qt(N),de,at,Re,ft);return ft.delete(b),Pt;case _:if(xt)return xt.call(b)==xt.call(N)}return!1}function As(b,N,Q,de,at,Re){var ft=Q&a,qt=hn(b),Xe=qt.length,ct=hn(N),Pt=ct.length;if(Xe!=Pt&&!ft)return!1;for(var lr=Xe;lr--;){var zt=qt[lr];if(!(ft?zt in N:Oe.call(N,zt)))return!1}var dt=Re.get(b);if(dt&&Re.get(N))return dt==N;var rr=!0;Re.set(b,N),Re.set(N,b);for(var zr=ft;++lr<Xe;){zt=qt[lr];var Or=b[zt],Jr=N[zt];if(de)var Ln=ft?de(Jr,Or,zt,N,b,Re):de(Or,Jr,zt,b,N,Re);if(!(Ln===void 0?Or===Jr||at(Or,Jr,Q,de,Re):Ln)){rr=!1;break}zr||(zr=zt=="constructor")}if(rr&&!zr){var zi=b.constructor,kt=N.constructor;zi!=kt&&"constructor"in b&&"constructor"in N&&!(typeof zi=="function"&&zi instanceof zi&&typeof kt=="function"&&kt instanceof kt)&&(rr=!1)}return Re.delete(b),Re.delete(N),rr}function hn(b){return $n(b,va,Rs)}function _i(b,N){var Q=b.__data__;return Ts(N)?Q[typeof N=="string"?"string":"hash"]:Q.map}function _r(b,N){var Q=Ie(b,N);return la(Q)?Q:void 0}function Ps(b){var N=Oe.call(b,tr),Q=b[tr];try{b[tr]=void 0;var de=!0}catch(Re){}var at=We.call(b);return de&&(N?b[tr]=Q:delete b[tr]),at}var Rs=ii?function(b){return b==null?[]:(b=Object(b),Be(ii(b),function(N){return hr.call(b,N)}))}:ot,Wr=Li;(wt&&Wr(new wt(new ArrayBuffer(1)))!=ce||vt&&Wr(new vt)!=H||Et&&Wr(Et.resolve())!=$||Dt&&Wr(new Dt)!=m||mt&&Wr(new mt)!=G)&&(Wr=function(b){var N=Li(b),Q=N==C?b.constructor:void 0,de=Q?si(Q):"";if(de)switch(de){case $t:return ce;case Ut:return H;case St:return $;case Mt:return m;case It:return G}return N});function Ns(b,N){return N=N==null?p:N,!!N&&(typeof b=="number"||be.test(b))&&b>-1&&b%1==0&&b<N}function Ts(b){var N=typeof b;return N=="string"||N=="number"||N=="symbol"||N=="boolean"?b!=="__proto__":b===null}function Fs(b){return!!Ve&&Ve in b}function $s(b){var N=b&&b.constructor,Q=typeof N=="function"&&N.prototype||De;return b===Q}function da(b){return We.call(b)}function si(b){if(b!=null){try{return He.call(b)}catch(N){}try{return b+""}catch(N){}}return""}function Us(b,N){return b===N||b!==b&&N!==N}var Ms=Un(function(){return arguments}())?Un:function(b){return qi(b)&&Oe.call(b,"callee")&&!hr.call(b,"callee")},ln=Array.isArray;function pa(b){return b!=null&&Ls(b.length)&&!fn(b)}var Mn=yi||st;function ga(b,N){return ji(b,N)}function fn(b){if(!js(b))return!1;var N=Li(b);return N==P||N==M||N==w||N==D}function Ls(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=p}function js(b){var N=typeof b;return b!=null&&(N=="object"||N=="function")}function qi(b){return b!=null&&typeof b=="object"}var qs=Se?gt(Se):Os;function va(b){return pa(b)?Is(b):Cs(b)}function ot(){return[]}function st(){return!1}n.exports=ga})(jo,jo.exports);var R6=jo.exports;const N6=_m(R6);function T6(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var l=n.charAt(a),p=l.charCodeAt(0);if(r[p]!==255)throw new TypeError(l+" is ambiguous");r[p]=a}var f=n.length,g=n.charAt(0),w=Math.log(f)/Math.log(256),S=Math.log(256)/Math.log(f);function T(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var H=0,K=0,ie=0,C=M.length;ie!==C&&M[ie]===0;)ie++,H++;for(var $=(C-ie)*S+1>>>0,D=new Uint8Array($);ie!==C;){for(var x=M[ie],m=0,c=$-1;(x!==0||m<K)&&c!==-1;c--,m++)x+=256*D[c]>>>0,D[c]=x%f>>>0,x=x/f>>>0;if(x!==0)throw new Error("Non-zero carry");K=m,ie++}for(var _=$-K;_!==$&&D[_]===0;)_++;for(var k=g.repeat(H);_<$;++_)k+=n.charAt(D[_]);return k}function j(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var H=0;if(M[H]!==" "){for(var K=0,ie=0;M[H]===g;)K++,H++;for(var C=(M.length-H)*w+1>>>0,$=new Uint8Array(C);M[H];){var D=r[M.charCodeAt(H)];if(D===255)return;for(var x=0,m=C-1;(D!==0||x<ie)&&m!==-1;m--,x++)D+=f*$[m]>>>0,$[m]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");ie=x,H++}if(M[H]!==" "){for(var c=C-ie;c!==C&&$[c]===0;)c++;for(var _=new Uint8Array(K+(C-c)),k=K;c!==C;)_[k++]=$[c++];return _}}}function P(M){var H=j(M);if(H)return H;throw new Error(`Non-${e} character`)}return{encode:T,decodeUnsafe:j,decode:P}}var F6=T6,$6=F6;const gp=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},U6=n=>new TextEncoder().encode(n),M6=n=>new TextDecoder().decode(n);class L6{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class j6{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return vp(this,e)}}class q6{constructor(e){this.decoders=e}or(e){return vp(this,e)}decode(e){const r=e[0],s=this.decoders[r];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vp=(n,e)=>new q6({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class z6{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new L6(e,r,s),this.decoder=new j6(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Wo=({name:n,prefix:e,encode:r,decode:s})=>new z6(n,e,r,s),ws=({prefix:n,name:e,alphabet:r})=>{const{encode:s,decode:a}=$6(r,e);return Wo({prefix:n,name:e,encode:s,decode:l=>gp(a(l))})},B6=(n,e,r,s)=>{const a={};for(let S=0;S<e.length;++S)a[e[S]]=S;let l=n.length;for(;n[l-1]==="=";)--l;const p=new Uint8Array(l*r/8|0);let f=0,g=0,w=0;for(let S=0;S<l;++S){const T=a[n[S]];if(T===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<r|T,f+=r,f>=8&&(f-=8,p[w++]=255&g>>f)}if(f>=r||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return p},H6=(n,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let l="",p=0,f=0;for(let g=0;g<n.length;++g)for(f=f<<8|n[g],p+=8;p>r;)p-=r,l+=e[a&f>>p];if(p&&(l+=e[a&f<<r-p]),s)for(;l.length*r&7;)l+="=";return l},Yt=({name:n,prefix:e,bitsPerChar:r,alphabet:s})=>Wo({prefix:e,name:n,encode(a){return H6(a,s,r)},decode(a){return B6(a,s,r,n)}}),K6=Wo({prefix:"\0",name:"identity",encode:n=>M6(n),decode:n=>U6(n)});var k6=Object.freeze({__proto__:null,identity:K6});const V6=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var G6=Object.freeze({__proto__:null,base2:V6});const W6=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var J6=Object.freeze({__proto__:null,base8:W6});const Y6=ws({prefix:"9",name:"base10",alphabet:"0123456789"});var X6=Object.freeze({__proto__:null,base10:Y6});const Q6=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Z6=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var e2=Object.freeze({__proto__:null,base16:Q6,base16upper:Z6});const t2=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),r2=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i2=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),n2=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),s2=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),o2=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),a2=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),c2=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),u2=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var h2=Object.freeze({__proto__:null,base32:t2,base32upper:r2,base32pad:i2,base32padupper:n2,base32hex:s2,base32hexupper:o2,base32hexpad:a2,base32hexpadupper:c2,base32z:u2});const l2=ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f2=ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var d2=Object.freeze({__proto__:null,base36:l2,base36upper:f2});const p2=ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g2=ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var v2=Object.freeze({__proto__:null,base58btc:p2,base58flickr:g2});const y2=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_2=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),m2=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),b2=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var w2=Object.freeze({__proto__:null,base64:y2,base64pad:_2,base64url:m2,base64urlpad:b2});const yp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),E2=yp.reduce((n,e,r)=>(n[r]=e,n),[]),D2=yp.reduce((n,e,r)=>(n[e.codePointAt(0)]=r,n),[]);function S2(n){return n.reduce((e,r)=>(e+=E2[r],e),"")}function I2(n){const e=[];for(const r of n){const s=D2[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const x2=Wo({prefix:"🚀",name:"base256emoji",encode:S2,decode:I2});var O2=Object.freeze({__proto__:null,base256emoji:x2}),C2=_p,Rf=128,A2=127,P2=~A2,R2=Math.pow(2,31);function _p(n,e,r){e=e||[],r=r||0;for(var s=r;n>=R2;)e[r++]=n&255|Rf,n/=128;for(;n&P2;)e[r++]=n&255|Rf,n>>>=7;return e[r]=n|0,_p.bytes=r-s+1,e}var N2=Qc,T2=128,Nf=127;function Qc(n,s){var r=0,s=s||0,a=0,l=s,p,f=n.length;do{if(l>=f)throw Qc.bytes=0,new RangeError("Could not decode varint");p=n[l++],r+=a<28?(p&Nf)<<a:(p&Nf)*Math.pow(2,a),a+=7}while(p>=T2);return Qc.bytes=l-s,r}var F2=Math.pow(2,7),$2=Math.pow(2,14),U2=Math.pow(2,21),M2=Math.pow(2,28),L2=Math.pow(2,35),j2=Math.pow(2,42),q2=Math.pow(2,49),z2=Math.pow(2,56),B2=Math.pow(2,63),H2=function(n){return n<F2?1:n<$2?2:n<U2?3:n<M2?4:n<L2?5:n<j2?6:n<q2?7:n<z2?8:n<B2?9:10},K2={encode:C2,decode:N2,encodingLength:H2},mp=K2;const Tf=(n,e,r=0)=>(mp.encode(n,e,r),e),Ff=n=>mp.encodingLength(n),Zc=(n,e)=>{const r=e.byteLength,s=Ff(n),a=s+Ff(r),l=new Uint8Array(a+r);return Tf(n,l,0),Tf(r,l,s),l.set(e,a),new k2(n,r,e,l)};class k2{constructor(e,r,s,a){this.code=e,this.size=r,this.digest=s,this.bytes=a}}const bp=({name:n,code:e,encode:r})=>new V2(n,e,r);class V2{constructor(e,r,s){this.name=e,this.code=r,this.encode=s}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Zc(this.code,r):r.then(s=>Zc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const wp=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),G2=bp({name:"sha2-256",code:18,encode:wp("SHA-256")}),W2=bp({name:"sha2-512",code:19,encode:wp("SHA-512")});var J2=Object.freeze({__proto__:null,sha256:G2,sha512:W2});const Ep=0,Y2="identity",Dp=gp,X2=n=>Zc(Ep,Dp(n)),Q2={code:Ep,name:Y2,encode:Dp,digest:X2};var Z2=Object.freeze({__proto__:null,identity:Q2});new TextEncoder,new TextDecoder;const $f={...k6,...G6,...J6,...X6,...e2,...h2,...d2,...v2,...w2,...O2};({...J2,...Z2});function Sp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function eD(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ip(n,e,r,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:r},decoder:{decode:s}}}const Uf=Ip("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Rc=Ip("ascii","a",n=>{let e="a";for(let r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e},n=>{n=n.substring(1);const e=eD(n.length);for(let r=0;r<n.length;r++)e[r]=n.charCodeAt(r);return e}),tD={utf8:Uf,"utf-8":Uf,hex:$f.base16,latin1:Rc,ascii:Rc,binary:Rc,...$f};function rD(n,e="utf8"){const r=tD[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const xp="wc",iD=2,Eu="core",Ni=`${xp}@2:${Eu}:`,nD={name:Eu,logger:"error"},sD={database:":memory:"},oD="crypto",Mf="client_ed25519_seed",aD=ye.ONE_DAY,cD="keychain",uD="0.3",hD="messages",lD="0.3",fD=ye.SIX_HOURS,dD="publisher",Op="irn",pD="error",Cp="wss://relay.walletconnect.com",Lf="wss://relay.walletconnect.org",gD="relayer",Ct={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},vD="_subscription",as={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},yD=ye.ONE_SECOND/2,_D="2.9.0",mD=1e4,bD="0.3",wD="WALLETCONNECT_CLIENT_ID",ti={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ED="subscription",DD="0.3",SD=ye.FIVE_SECONDS*1e3,ID="pairing",xD="0.3",cs={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},ei={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},OD="history",CD="0.3",AD="expirer",Ur={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},PD="0.3",Nc="verify-api",jf="https://verify.walletconnect.com";class RD{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=cD,this.version=uD,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:l}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(l)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ld(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ND{constructor(e,r,s){this.core=e,this.logger=r,this.name=oD,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Ef(a);return Xd(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=kw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),p=Ef(l),f=Jc();return await K3(f,a,aD,p)},this.generateSharedKey=(a,l,p)=>{this.isInitialized();const f=this.getPrivateKey(a),g=Vw(f,l);return this.setSymKey(g,p)},this.setSymKey=async(a,l)=>{this.isInitialized();const p=l||Gw(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,p)=>{this.isInitialized();const f=Ud(p),g=A3(l);if(Yl(f)){const j=f.senderPublicKey,P=f.receiverPublicKey;a=await this.generateSharedKey(j,P)}const w=this.getSymKey(a),{type:S,senderPublicKey:T}=f;return Jw({type:S,symKey:w,message:g,senderPublicKey:T})},this.decode=async(a,l,p)=>{this.isInitialized();const f=Qw(l,p);if(Yl(f)){const S=f.receiverPublicKey,T=f.senderPublicKey;a=await this.generateSharedKey(S,T)}const g=this.getSymKey(a),w=Yw({symKey:g,encoded:l});return C3(w)},this.getPayloadType=a=>{const l=$o(a);return ms(l.type)},this.getPayloadSenderPublicKey=a=>{const l=$o(a);return l.senderPublicKey?ur(l.senderPublicKey,cr):void 0},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.keychain=s||new RD(this.core,this.logger)}get context(){return Ze.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Mf)}catch(r){e=Jc(),await this.keychain.set(Mf,e)}return rD(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class TD extends y3{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=hD,this.version=lD,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const l=An(a);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[l]<"u"||(p[l]=a,this.messages.set(s,p),await this.persist()),l},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const l=this.get(s),p=An(a);return typeof l[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ze.generateChildLogger(e,this.name),this.core=r}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ld(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?jd(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class FD extends _3{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Lr.EventEmitter,this.name=dD,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.queueTimeout=ye.toMiliseconds(ye.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}});try{const p=(l==null?void 0:l.ttl)||fD,f=Yc(l),g=(l==null?void 0:l.prompt)||!1,w=(l==null?void 0:l.tag)||0,S=(l==null?void 0:l.id)||c6().toString(),T={topic:s,message:a,opts:{ttl:p,relay:f,prompt:g,tag:w,id:S}},j=setTimeout(()=>this.queue.set(S,T),this.queueTimeout);try{await await Uo(this.rpcPublish(s,a,p,f,g,w,S),this.publishTimeout),clearTimeout(j),this.relayer.events.emit(Ct.publish,T)}catch(P){this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:l}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ze.getLoggerContext(this.logger)}rpcPublish(e,r,s,a,l,p,f){var g,w,S,T;const j={method:Po(a.protocol).publish,params:{topic:e,message:r,ttl:s,prompt:l,tag:p},id:f};return ar((g=j.params)==null?void 0:g.prompt)&&((w=j.params)==null||delete w.prompt),ar((S=j.params)==null?void 0:S.tag)&&((T=j.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:j}),this.relayer.request(j)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:s,opts:a}=e;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ct.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ct.message_ack,e=>{this.onPublish(e.id.toString())})}}class $D{constructor(){this.map=new Map,this.set=(e,r)=>{const s=this.get(e);this.exists(e,r)||this.map.set(e,[...s,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,r))return;const a=s.filter(l=>l!==r);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var UD=Object.defineProperty,MD=Object.defineProperties,LD=Object.getOwnPropertyDescriptors,qf=Object.getOwnPropertySymbols,jD=Object.prototype.hasOwnProperty,qD=Object.prototype.propertyIsEnumerable,zf=(n,e,r)=>e in n?UD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,us=(n,e)=>{for(var r in e||(e={}))jD.call(e,r)&&zf(n,r,e[r]);if(qf)for(var r of qf(e))qD.call(e,r)&&zf(n,r,e[r]);return n},Tc=(n,e)=>MD(n,LD(e));class zD extends w3{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new $D,this.events=new Lr.EventEmitter,this.name=ED,this.version=DD,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ni,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const l=Yc(a),p={topic:s,relay:l};this.pending.set(s,p);const f=await this.rpcSubscribe(s,l);return this.onSubscribe(f,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),f}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,l)=>{const p=new ye.Watch;p.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=SD&&(clearInterval(f),p.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ze.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let s=!1;try{s=this.getSubscription(e).topic===r}catch(a){}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,r)))}async unsubscribeById(e,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}});try{const a=Yc(s);await this.rpcUnsubscribe(e,r,a);const l=Tt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,r){const s={method:Po(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Uo(this.relayer.request(s),this.subscribeTimeout)}catch(a){this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}return An(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,s={method:Po(r.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Uo(this.relayer.request(s),this.subscribeTimeout)}catch(a){this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ct.connection_stalled)}}rpcUnsubscribe(e,r,s){const a={method:Po(s.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,r){this.setSubscription(e,Tc(us({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,us({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,us({},r)),this.topicMap.set(r.topic,e),this.events.emit(ti.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(ti.deleted,Tc(us({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ti.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ti.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);ri(r)&&this.onBatchSubscribe(r.map((s,a)=>Tc(us({},e[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ct.connect,async()=>{await this.onConnect()}),this.relayer.on(Ct.disconnect,()=>{this.onDisconnect()}),this.events.on(ti.created,async e=>{const r=ti.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(ti.deleted,async e=>{const r=ti.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var BD=Object.defineProperty,Bf=Object.getOwnPropertySymbols,HD=Object.prototype.hasOwnProperty,KD=Object.prototype.propertyIsEnumerable,Hf=(n,e,r)=>e in n?BD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,kD=(n,e)=>{for(var r in e||(e={}))HD.call(e,r)&&Hf(n,r,e[r]);if(Bf)for(var r of Bf(e))KD.call(e,r)&&Hf(n,r,e[r]);return n};class VD extends m3{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Lr.EventEmitter,this.name=gD,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ze.generateChildLogger(e.logger,this.name):Ze.pino(Ze.getDefaultLoggerOptions({level:e.logger||pD})),this.messages=new TD(this.logger,e.core),this.subscriber=new zD(this,this.logger),this.publisher=new FD(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Cp,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch(e){this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Lf}...`),await this.restartTransport(Lf)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},mD)}get context(){return Ze.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,s){this.isInitialized(),await this.publisher.publish(e,r,s),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return a||(await Promise.all([new Promise(l=>{this.subscriber.once(ti.created,p=>{p.topic===e&&l()})}),new Promise(async l=>{a=await this.subscriber.subscribe(e,r),l()})]),a)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ct.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(ti.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,s)=>{await Uo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>s(a)).then(()=>r()).finally(()=>this.removeListener(Ct.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ct.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.events.emit(Ct.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(as.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Fi(new P6(uE({sdkVersion:_D,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:s}=e;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(e){const{topic:r,message:s}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,s):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ap(e)){if(!e.method.endsWith(vD))return;const r=e.params,{topic:s,message:a,publishedAt:l}=r.data,p={topic:s,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(kD({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(e),await this.onMessageEvent(p)}else cp(e)&&this.events.emit(Ct.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ct.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=sp(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(as.payload,e=>this.onProviderPayload(e)),this.provider.on(as.connect,()=>{this.events.emit(Ct.connect)}),this.provider.on(as.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(as.error,e=>{this.logger.error(e),this.events.emit(Ct.error,e)})}registerEventListeners(){this.events.on(Ct.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ct.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ye.toMiliseconds(yD))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var GD=Object.defineProperty,Kf=Object.getOwnPropertySymbols,WD=Object.prototype.hasOwnProperty,JD=Object.prototype.propertyIsEnumerable,kf=(n,e,r)=>e in n?GD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Vf=(n,e)=>{for(var r in e||(e={}))WD.call(e,r)&&kf(n,r,e[r]);if(Kf)for(var r of Kf(e))JD.call(e,r)&&kf(n,r,e[r]);return n};class Jo extends b3{constructor(e,r,s,a=Ni,l=void 0){super(e,r,s,a),this.core=e,this.logger=r,this.name=s,this.map=new Map,this.version=bD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!ar(p)?this.map.set(this.getKey(p),p):NE(p)?this.map.set(p.id,p):TE(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,f)=>{this.isInitialized(),this.map.has(p)?await this.update(p,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:f}),this.map.set(p,f),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(f=>Object.keys(p).every(g=>N6(f[g],p[g]))):this.values),this.update=async(p,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:f});const g=Vf(Vf({},this.getData(p)),f);this.map.set(p,g),await this.persist()},this.delete=async(p,f)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:f}),this.map.delete(p),await this.persist())},this.logger=Ze.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class YD{constructor(e,r){this.core=e,this.logger=r,this.name=ID,this.version=xD,this.events=new nu,this.initialized=!1,this.storagePrefix=Ni,this.ignoredPayloadTypes=[rn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Jc(),a=await this.core.crypto.setSymKey(s),l=Vr(ye.FIVE_MINUTES),p={protocol:Op},f={topic:a,expiry:l,relay:p,active:!1},g=EE({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:p});return await this.pairings.set(a,f),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:l,relay:p}=mE(s.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const f=Vr(ye.FIVE_MINUTES),g={topic:a,relay:p,expiry:f,active:!1};return await this.pairings.set(a,g),await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,f),s.activatePairing&&await this.activate({topic:a}),g},this.activate=async({topic:s})=>{this.isInitialized();const a=Vr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:f,reject:g}=On();this.events.once(Bt("pairing_ping",l),({error:w})=>{w?g(w):f()}),await p()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Tt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,l)=>{const p=np(a,l),f=await this.core.crypto.encode(s,p),g=cs[a].req;return this.core.history.set(s,p),this.core.relayer.publish(s,f,g),p.id},this.sendResult=async(s,a,l)=>{const p=sp(s,l),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),w=cs[g.request.method].res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.sendError=async(s,a,l)=>{const p=u6(s,l),f=await this.core.crypto.encode(a,p),g=await this.core.history.get(a,s),w=cs[g.request.method]?cs[g.request.method].res:cs.unregistered_method.res;await this.core.relayer.publish(a,f,w),await this.core.history.resolve(p)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Tt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Pi(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:l}=s,p=l.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:l}=s,p=(await this.core.history.get(a,l.id)).request.method;if(this.pairings.keys.includes(a))switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,a)=>{const{id:l}=a;try{this.isValidPing({topic:s}),await this.sendResult(l,s,!0),this.events.emit("pairing_ping",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,a)=>{const{id:l}=a;setTimeout(()=>{up(a)?this.events.emit(Bt("pairing_ping",l),{}):bu(a)&&this.events.emit(Bt("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:l,topic:s})}catch(p){await this.sendError(l,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:l,method:p}=a;try{if(this.registeredMethods.includes(p))return;const f=Tt("WC_METHOD_UNSUPPORTED",p);await this.sendError(l,s,f),this.logger.error(f)}catch(f){await this.sendError(l,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Tt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!vr(s)){const{message:a}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(a)}if(!RE(s.uri)){const{message:a}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(a)}},this.isValidPing=async s=>{if(!vr(s)){const{message:l}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!vr(s)){const{message:l}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(l)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Gt(s,!1)){const{message:a}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Pi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=Ze.generateChildLogger(r,this.name),this.pairings=new Jo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ze.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ct.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);ap(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):cp(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))})}registerExpirerEvents(){this.core.expirer.on(Ur.expired,async e=>{const{topic:r}=zd(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class XD extends v3{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Lr.EventEmitter,this.name=OD,this.version=CD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:l}),this.records.has(a.id))return;const p={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:l,expiry:Vr(ye.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(ei.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=bu(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(ei.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===s){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(ei.deleted,l)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:np(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ei.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ei.created,e=>{const r=ei.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ei.updated,e=>{const r=ei.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(ei.deleted,e=>{const r=ei.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ye.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class QD extends E3{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Lr.EventEmitter,this.name=AD,this.version=PD,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch(a){return!1}},this.set=(s,a)=>{this.isInitialized();const l=this.formatTarget(s),p={target:l,expiry:a};this.expirations.set(l,p),this.checkExpiry(l,p),this.events.emit(Ur.created,{target:l,expiration:p})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Ur.deleted,{target:a,expiration:l})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ze.generateChildLogger(r,this.name)}get context(){return Ze.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return hE(e);if(typeof e=="number")return lE(e);const{message:r}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ur.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(e,r){const{expiry:s}=r;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Ur.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Fn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ur.created,e=>{const r=Ur.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ur.expired,e=>{const r=Ur.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Ur.deleted,e=>{const r=Ur.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ZD extends D3{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=Nc,this.initialized=!1,this.init=async s=>{Md()||!pu()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||jf,await this.createIframe())},this.register=async s=>{var a;if(this.initialized||await this.init(),!!this.iframe)try{(a=this.iframe.contentWindow)==null||a.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch(l){}},this.resolve=async s=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const l=this.startAbortTimer(ye.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),p.status===200?(a=await p.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,a)=>{if(document.getElementById(Nc))return s();const l=document.createElement("iframe");l.setAttribute("id",Nc),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,s()}),l.addEventListener("error",p=>{a(p)}),document.body.append(l),this.iframe=l}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ye.toMiliseconds(ye.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Ze.generateChildLogger(r,this.name),this.verifyUrl=jf,this.abortController=new AbortController,this.isDevEnv=du()&&{}.IS_VITEST}get context(){return Ze.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var e5=Object.defineProperty,Gf=Object.getOwnPropertySymbols,t5=Object.prototype.hasOwnProperty,r5=Object.prototype.propertyIsEnumerable,Wf=(n,e,r)=>e in n?e5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Jf=(n,e)=>{for(var r in e||(e={}))t5.call(e,r)&&Wf(n,r,e[r]);if(Gf)for(var r of Gf(e))r5.call(e,r)&&Wf(n,r,e[r]);return n};class Du extends g3{constructor(e){super(e),this.protocol=xp,this.version=iD,this.name=Eu,this.events=new Lr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Cp;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||nD.logger}));this.logger=Ze.generateChildLogger(r,this.name),this.heartbeat=new Fn.HeartBeat,this.crypto=new ND(this,this.logger,e==null?void 0:e.keychain),this.history=new XD(this,this.logger),this.expirer=new QD(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new o3(Jf(Jf({},sD),e==null?void 0:e.storageOptions)),this.relayer=new VD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new YD(this,this.logger),this.verify=new ZD(this.projectId||"",this.logger)}static async init(e){const r=new Du(e);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(wD,s),r}get context(){return Ze.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const i5=Du,n5="PARSE_ERROR",s5="INVALID_REQUEST",o5="METHOD_NOT_FOUND",a5="INVALID_PARAMS",Ap="INTERNAL_ERROR",Su="SERVER_ERROR",c5=[-32700,-32600,-32601,-32602,-32603],gs={[n5]:{code:-32700,message:"Parse error"},[s5]:{code:-32600,message:"Invalid Request"},[o5]:{code:-32601,message:"Method not found"},[a5]:{code:-32602,message:"Invalid params"},[Ap]:{code:-32603,message:"Internal error"},[Su]:{code:-32e3,message:"Server error"}},Pp=Su;function u5(n){return c5.includes(n)}function Yf(n){return Object.keys(gs).includes(n)?gs[n]:gs[Pp]}function h5(n){const e=Object.values(gs).find(r=>r.code===n);return e||gs[Pp]}function Rp(n=3){const e=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return e+r}function l5(n=6){return BigInt(Rp(n))}function f5(n,e,r){return{id:r||Rp(),jsonrpc:"2.0",method:n,params:e}}function d5(n,e){return{id:n,jsonrpc:"2.0",result:e}}function p5(n,e,r){return{id:n,jsonrpc:"2.0",error:g5(e,r)}}function g5(n,e){return typeof n>"u"?Yf(Ap):(typeof n=="string"&&(n=Object.assign(Object.assign({},Yf(Su)),{message:n})),typeof e<"u"&&(n.data=e),u5(n.code)&&(n=h5(n.code)),n)}function Np(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function v5(n){return Np(n)&&"method"in n}function y5(n){return Np(n)&&(Ci(n)||Ai(n))}function Ci(n){return"result"in n}function Ai(n){return"error"in n}const Tp="wc",Fp=2,$p="client",Iu=`${Tp}@${Fp}:${$p}:`,Fc={name:$p,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},_5="WALLETCONNECT_DEEPLINK_CHOICE",m5="proposal",Up="Proposal expired",b5="session",Oo=ye.SEVEN_DAYS,w5="engine",hs={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},$c={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},E5="request",D5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var S5=Object.defineProperty,I5=Object.defineProperties,x5=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,O5=Object.prototype.hasOwnProperty,C5=Object.prototype.propertyIsEnumerable,Qf=(n,e,r)=>e in n?S5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,$r=(n,e)=>{for(var r in e||(e={}))O5.call(e,r)&&Qf(n,r,e[r]);if(Xf)for(var r of Xf(e))C5.call(e,r)&&Qf(n,r,e[r]);return n},Uc=(n,e)=>I5(n,x5(e));class A5 extends I3{constructor(e){super(e),this.name=w5,this.events=new nu,this.initialized=!1,this.ignoredPayloadTypes=[rn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(hs)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const s=Uc($r({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:p,sessionProperties:f,relays:g}=s;let w=a,S,T=!1;if(w&&(T=this.client.core.pairing.pairings.get(w).active),!w||!T){const{topic:$,uri:D}=await this.client.core.pairing.create();w=$,S=D}const j=await this.client.core.crypto.generateKeyPair(),P=$r({requiredNamespaces:l,optionalNamespaces:p,relays:g!=null?g:[{protocol:Op}],proposer:{publicKey:j,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:M,resolve:H,done:K}=On(ye.FIVE_MINUTES,Up);if(this.events.once(Bt("session_connect"),async({error:$,session:D})=>{if($)M($);else if(D){D.self.publicKey=j;const x=Uc($r({},D),{requiredNamespaces:D.requiredNamespaces,optionalNamespaces:D.optionalNamespaces});await this.client.session.set(D.topic,x),await this.setExpiry(D.topic,D.expiry),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:D.peer.metadata}),H(x)}}),!w){const{message:$}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error($)}const ie=await this.sendRequest(w,"wc_sessionPropose",P),C=Vr(ye.FIVE_MINUTES);return await this.setProposal(ie,$r({id:ie,expiry:C},P)),{uri:S,approval:K}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:l,sessionProperties:p}=r,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:w,requiredNamespaces:S,optionalNamespaces:T}=f;g=g||"",Pn(S)||(S=xE(l,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),P=w.publicKey,M=await this.client.core.crypto.generateSharedKey(j,P);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:w.metadata}),await this.sendResult(s,g,{relay:{protocol:a!=null?a:"irn"},responderPublicKey:j}),await this.client.proposal.delete(s,Tt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const H=$r({relay:{protocol:a!=null?a:"irn"},namespaces:l,requiredNamespaces:S,optionalNamespaces:T,pairingTopic:g,controller:{publicKey:j,metadata:this.client.metadata},expiry:Vr(Oo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(M),await this.sendRequest(M,"wc_sessionSettle",H);const K=Uc($r({},H),{topic:M,pairingTopic:g,acknowledged:!1,self:H.controller,peer:{publicKey:w.publicKey,metadata:w.metadata},controller:j});return await this.client.session.set(M,K),await this.setExpiry(M,Vr(Oo)),{topic:M,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(M)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(s);l&&(await this.sendError(s,l,a),await this.client.proposal.delete(s,Tt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,l=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:a}),{done:p,resolve:f,reject:g}=On();return this.events.once(Bt("session_update",l),({error:w})=>{w?g(w):f()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:p}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest(s,"wc_sessionExtend",{}),{done:l,resolve:p,reject:f}=On();return this.events.once(Bt("session_extend",a),({error:g})=>{g?f(g):p()}),await this.setExpiry(s,Vr(Oo)),{acknowledged:l}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:l,expiry:p}=r,f=await this.sendRequest(l,"wc_sessionRequest",{request:a,chainId:s},p),{done:g,resolve:w,reject:S}=On(p);this.events.once(Bt("session_request",f),({error:j,result:P})=>{j?S(j):w(P)}),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:s,id:f});const T=await this.client.core.storage.getItem(_5);return fE({id:f,topic:l,wcDeepLink:T}),await g()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:l}=a;Ci(a)?await this.sendResult(l,s,a.result):Ai(a)&&await this.sendError(l,s,a.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest(s,"wc_sessionPing",{}),{done:l,resolve:p,reject:f}=On();this.events.once(Bt("session_ping",a),({error:g})=>{g?f(g):p()}),await l()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:l}=r;await this.sendRequest(s,"wc_sessionEvent",{event:a,chainId:l})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=l5().toString();let l;const p=f=>{(f==null?void 0:f.id.toString())===a&&(this.client.core.relayer.events.removeListener(Ct.message_ack,p),l())};await Promise.all([new Promise(f=>{l=f,this.client.core.relayer.on(Ct.message_ack,p)}),this.sendRequest(s,"wc_sessionDelete",Tt("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>AE(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var p,f;return((p=l.peerMetadata)==null?void 0:p.url)&&((f=l.peerMetadata)==null?void 0:f.url)===r.peer.metadata.url&&l.topic&&l.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Tt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r)},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Tt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=hs.wc_sessionRequest.req.ttl,{id:a,topic:l,params:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:p}),s&&this.client.core.expirer.set(a,Vr(s))},this.sendRequest=async(r,s,a,l,p)=>{const f=f5(s,a);if(pu()&&D5.includes(s)){const S=An(JSON.stringify(f));await this.client.core.verify.register({attestationId:S})}const g=await this.client.core.crypto.encode(r,f),w=hs[s].req;return l&&(w.ttl=l),p&&(w.id=p),this.client.core.history.set(r,f),this.client.core.relayer.publish(r,g,w),f.id},this.sendResult=async(r,s,a)=>{const l=d5(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),g=hs[f.request.method].res;this.client.core.relayer.publish(s,p,g),await this.client.core.history.resolve(l)},this.sendError=async(r,s,a)=>{const l=p5(r,a),p=await this.client.core.crypto.encode(s,l),f=await this.client.core.history.get(s,r),g=hs[f.request.method].res;this.client.core.relayer.publish(s,p,g),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Pi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Pi(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=r=>{const{topic:s,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,l=(await this.client.core.history.get(s,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidConnect($r({},s.params));const p=Vr(ye.FIVE_MINUTES),f=$r({id:l,pairingTopic:r,expiry:p},a);await this.setProposal(l,f);const g=An(JSON.stringify(s)),w=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:f,verifyContext:w})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(Ci(s)){const{result:l}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const f=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const w=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:w});const S=await this.client.core.relayer.subscribe(w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:r})}else Ai(s)&&(await this.client.proposal.delete(a,Tt("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidSessionSettleRequest(l);const{relay:p,controller:f,expiry:g,namespaces:w,requiredNamespaces:S,optionalNamespaces:T,sessionProperties:j,pairingTopic:P}=s.params,M=$r({topic:r,relay:p,expiry:g,namespaces:w,acknowledged:!0,pairingTopic:P,requiredNamespaces:S,optionalNamespaces:T,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},j&&{sessionProperties:j});await this.sendResult(s.id,r,!0),this.events.emit(Bt("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;Ci(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",a),{})):Ai(s)&&(await this.client.session.delete(r,Tt("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:l}=s;try{this.isValidUpdate($r({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult(l,r,!0),this.client.events.emit("session_update",{id:l,topic:r,params:a})}catch(p){await this.sendError(l,r,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;Ci(s)?this.events.emit(Bt("session_update",a),{}):Ai(s)&&this.events.emit(Bt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Vr(Oo)),await this.sendResult(a,r,!0),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;Ci(s)?this.events.emit(Bt("session_extend",a),{}):Ai(s)&&this.events.emit(Bt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult(a,r,!0),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{Ci(s)?this.events.emit(Bt("session_ping",a),{}):Ai(s)&&this.events.emit(Bt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Ct.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult(a,r,!0)]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidRequest($r({topic:r},l)),await this.setPendingSessionRequest({id:a,topic:r,params:l});const p=An(JSON.stringify(s)),f=this.client.session.get(r),g=await this.getVerifyContext(p,f.peer.metadata);this.client.events.emit("session_request",{id:a,topic:r,params:l,verifyContext:g})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;Ci(s)?this.events.emit(Bt("session_request",a),{result:s.result}):Ai(s)&&this.events.emit(Bt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:l}=s;try{this.isValidEmit($r({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l})}catch(p){await this.sendError(a,r,p),this.client.logger.error(p)}},this.isValidConnect=async r=>{if(!vr(r)){const{message:g}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:p,relays:f}=r;if(ar(s)||await this.isValidPairingTopic(s),!zE(f,!0)){const{message:g}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!ar(a)&&Pn(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ar(l)&&Pn(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),ar(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=qE(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!vr(r))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:l,sessionProperties:p}=r;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=No(a,"approve()");if(g)throw new Error(g.message);const w=sf(f.requiredNamespaces,a,"approve()");if(w)throw new Error(w.message);if(!Gt(l,!0)){const{message:S}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(S)}ar(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!vr(r)){const{message:l}=ue("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!HE(a)){const{message:l}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!vr(r)){const{message:w}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(w)}const{relay:s,controller:a,namespaces:l,expiry:p}=r;if(!Hd(s)){const{message:w}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(w)}const f=FE(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=No(l,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Pi(p)){const{message:w}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(w)}},this.isValidUpdate=async r=>{if(!vr(r)){const{message:g}=ue("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(g)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const l=this.client.session.get(s),p=No(a,"update()");if(p)throw new Error(p.message);const f=sf(l.requiredNamespaces,a,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async r=>{if(!vr(r)){const{message:a}=ue("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!vr(r)){const{message:g}=ue("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(g)}const{topic:s,request:a,chainId:l,expiry:p}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!nf(f,l)){const{message:g}=ue("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(g)}if(!KE(a)){const{message:g}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(g)}if(!GE(f,l,a.method)){const{message:g}=ue("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(g)}if(p&&!XE(p,$c)){const{message:g}=ue("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${$c.min} and ${$c.max}`);throw new Error(g)}},this.isValidRespond=async r=>{if(!vr(r)){const{message:l}=ue("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!kE(a)){const{message:l}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!vr(r)){const{message:a}=ue("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!vr(r)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(f)}const{topic:s,event:a,chainId:l}=r;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!nf(p,l)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(f)}if(!VE(a)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}if(!WE(p,l,a.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(f)}},this.isValidDisconnect=async r=>{if(!vr(r)){const{message:a}=ue("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});l&&(a.verified.origin=l,a.verified.validation=l===s.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Gt(a,!1)){const{message:l}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ct.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);v5(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):y5(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on(Ur.expired,async e=>{const{topic:r,id:s}=zd(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Gt(e,!1)){const{message:r}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Pi(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Gt(e,!1)){const{message:r}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Pi(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=ue("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Gt(e,!1)){const{message:r}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!BE(e)){const{message:r}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Pi(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class P5 extends Jo{constructor(e,r){super(e,r,m5,Iu),this.core=e,this.logger=r}}class R5 extends Jo{constructor(e,r){super(e,r,b5,Iu),this.core=e,this.logger=r}}class N5 extends Jo{constructor(e,r){super(e,r,E5,Iu,s=>s.id),this.core=e,this.logger=r}}let T5=class Mp extends S3{constructor(e){super(e),this.protocol=Tp,this.version=Fp,this.name=Fc.name,this.events=new Lr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||Fc.name,this.metadata=(e==null?void 0:e.metadata)||sE();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Fc.logger}));this.core=(e==null?void 0:e.core)||new i5(e),this.logger=Ze.generateChildLogger(r,this.name),this.session=new R5(this.core,this.logger),this.proposal=new P5(this.core,this.logger),this.pendingRequest=new N5(this.core,this.logger),this.engine=new A5(this)}static async init(e){const r=new Mp(e);return await r.initialize(),r}get context(){return Ze.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const F5={Accept:"application/json","Content-Type":"application/json"},$5="POST",Zf={headers:F5,method:$5},ed=10;class sn{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Lr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Of(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const s=Xc(e),l=await(await Ol(this.url,Object.assign(Object.assign({},Zf),{body:s}))).json();this.onPayload({data:l})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Of(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Xc({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ol(e,Object.assign(Object.assign({},Zf),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?q3(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),l=dp(e,a);this.events.emit("payload",l)}parseError(e,r=this.url){return fp(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ed&&this.events.setMaxListeners(ed)}}const td="error",U5="wss://relay.walletconnect.com",M5="wc",L5="universal_provider",rd=`${M5}@2:${L5}:`,j5="https://rpc.walletconnect.com/v1",$i={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},eu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,e){(function(){var r,s="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",w=500,S="__lodash_placeholder__",T=1,j=2,P=4,M=1,H=2,K=1,ie=2,C=4,$=8,D=16,x=32,m=64,c=128,_=256,k=512,G=30,oe="...",ce=800,ge=16,R=1,z=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,J=0/0,re=4294967295,xe=re-1,ne=re>>>1,be=[["ary",c],["bind",K],["bindKey",ie],["curry",$],["curryRight",D],["flip",k],["partial",x],["partialRight",m],["rearg",_]],he="[object Arguments]",_e="[object Array]",q="[object AsyncFunction]",L="[object Boolean]",A="[object Date]",h="[object DOMException]",I="[object Error]",se="[object Function]",fe="[object GeneratorFunction]",Se="[object Map]",Be="[object Number]",ke="[object Null]",Me="[object Object]",pt="[object Promise]",gt="[object Proxy]",je="[object RegExp]",Ie="[object Set]",Te="[object String]",Fe="[object Symbol]",qe="[object Undefined]",Ce="[object WeakMap]",$e="[object WeakSet]",De="[object ArrayBuffer]",Ae="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Ye="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",Gr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,ii=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yi=/&(?:amp|lt|gt|quot|#39);/g,Ui=/[&<>"']/g,wt=RegExp(yi.source),vt=RegExp(Ui.source),Et=/<%-([\s\S]+?)%>/g,Dt=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,St=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(St.source),It=/^\s+/,At=/\s/,xt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ht=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Yo=/[()=,{}\[\]\/\s]/,Xo=/\\(\\)?/g,Qo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,Zo=/^[-+]0x[0-9a-f]+$/i,ea=/^0b[01]+$/i,ta=/^\[object .+?Constructor\]$/,ra=/^0o[0-7]+$/i,ia=/^(?:0|[1-9]\d*)$/,ni=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,on=/($^)/,na=/['\n\r\u2028\u2029\\]/g,an="\\ud800-\\udfff",sa="\\u0300-\\u036f",oa="\\ufe20-\\ufe2f",cn="\\u20d0-\\u20ff",Es=sa+oa+cn,Ds="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",aa="\\xac\\xb1\\xd7\\xf7",ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ua="\\u2000-\\u206f",ha=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ss="A-Z\\xc0-\\xd6\\xd8-\\xde",Is="\\ufe0e\\ufe0f",Mi=aa+ca+ua+ha,$n="['’]",Li="["+an+"]",Un="["+Mi+"]",ji="["+Es+"]",xs="\\d+",la="["+Ds+"]",Os="["+qr+"]",Cs="[^"+an+Mi+xs+Ds+qr+Ss+"]",un="\\ud83c[\\udffb-\\udfff]",fa="(?:"+ji+"|"+un+")",As="[^"+an+"]",hn="(?:\\ud83c[\\udde6-\\uddff]){2}",_i="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+Ss+"]",Ps="\\u200d",Rs="(?:"+Os+"|"+Cs+")",Wr="(?:"+_r+"|"+Cs+")",Ns="(?:"+$n+"(?:d|ll|m|re|s|t|ve))?",Ts="(?:"+$n+"(?:D|LL|M|RE|S|T|VE))?",Fs=fa+"?",$s="["+Is+"]?",da="(?:"+Ps+"(?:"+[As,hn,_i].join("|")+")"+$s+Fs+")*",si="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Us="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ms=$s+Fs+da,ln="(?:"+[la,hn,_i].join("|")+")"+Ms,pa="(?:"+[As+ji+"?",ji,hn,_i,Li].join("|")+")",Mn=RegExp($n,"g"),ga=RegExp(ji,"g"),fn=RegExp(un+"(?="+un+")|"+pa+Ms,"g"),Ls=RegExp([_r+"?"+Os+"+"+Ns+"(?="+[Un,_r,"$"].join("|")+")",Wr+"+"+Ts+"(?="+[Un,_r+Rs,"$"].join("|")+")",_r+"?"+Rs+"+"+Ns,_r+"+"+Ts,Us,si,xs,ln].join("|"),"g"),js=RegExp("["+Ps+an+Es+Is+"]"),qi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],va=-1,ot={};ot[He]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[tt]=ot[Ye]=ot[er]=ot[hr]=!0,ot[he]=ot[_e]=ot[De]=ot[L]=ot[Ae]=ot[A]=ot[I]=ot[se]=ot[Se]=ot[Be]=ot[Me]=ot[je]=ot[Ie]=ot[Te]=ot[Ce]=!1;var st={};st[he]=st[_e]=st[De]=st[Ae]=st[L]=st[A]=st[He]=st[Oe]=st[Ve]=st[We]=st[et]=st[Se]=st[Be]=st[Me]=st[je]=st[Ie]=st[Te]=st[Fe]=st[tt]=st[Ye]=st[er]=st[hr]=!0,st[I]=st[se]=st[Ce]=!1;var b={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,Re=parseInt,ft=typeof ls=="object"&&ls&&ls.Object===Object&&ls,qt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=ft||qt||Function("return this")(),ct=e&&!e.nodeType&&e,Pt=ct&&!0&&n&&!n.nodeType&&n,lr=Pt&&Pt.exports===ct,zt=lr&&ft.process,dt=function(){try{var F=Pt&&Pt.require&&Pt.require("util").types;return F||zt&&zt.binding&&zt.binding("util")}catch(V){}}(),rr=dt&&dt.isArrayBuffer,zr=dt&&dt.isDate,Or=dt&&dt.isMap,Jr=dt&&dt.isRegExp,Ln=dt&&dt.isSet,zi=dt&&dt.isTypedArray;function kt(F,V,B){switch(B.length){case 0:return F.call(V);case 1:return F.call(V,B[0]);case 2:return F.call(V,B[0],B[1]);case 3:return F.call(V,B[0],B[1],B[2])}return F.apply(V,B)}function qp(F,V,B,pe){for(var Pe=-1,rt=F==null?0:F.length;++Pe<rt;){var Ht=F[Pe];V(pe,Ht,B(Ht),F)}return pe}function Cr(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe&&V(F[B],B,F)!==!1;);return F}function zp(F,V){for(var B=F==null?0:F.length;B--&&V(F[B],B,F)!==!1;);return F}function Cu(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe;)if(!V(F[B],B,F))return!1;return!0}function mi(F,V){for(var B=-1,pe=F==null?0:F.length,Pe=0,rt=[];++B<pe;){var Ht=F[B];V(Ht,B,F)&&(rt[Pe++]=Ht)}return rt}function zs(F,V){var B=F==null?0:F.length;return!!B&&dn(F,V,0)>-1}function ya(F,V,B){for(var pe=-1,Pe=F==null?0:F.length;++pe<Pe;)if(B(V,F[pe]))return!0;return!1}function _t(F,V){for(var B=-1,pe=F==null?0:F.length,Pe=Array(pe);++B<pe;)Pe[B]=V(F[B],B,F);return Pe}function bi(F,V){for(var B=-1,pe=V.length,Pe=F.length;++B<pe;)F[Pe+B]=V[B];return F}function _a(F,V,B,pe){var Pe=-1,rt=F==null?0:F.length;for(pe&&rt&&(B=F[++Pe]);++Pe<rt;)B=V(B,F[Pe],Pe,F);return B}function Bp(F,V,B,pe){var Pe=F==null?0:F.length;for(pe&&Pe&&(B=F[--Pe]);Pe--;)B=V(B,F[Pe],Pe,F);return B}function ma(F,V){for(var B=-1,pe=F==null?0:F.length;++B<pe;)if(V(F[B],B,F))return!0;return!1}var Hp=ba("length");function Kp(F){return F.split("")}function kp(F){return F.match(jt)||[]}function Au(F,V,B){var pe;return B(F,function(Pe,rt,Ht){if(V(Pe,rt,Ht))return pe=rt,!1}),pe}function Bs(F,V,B,pe){for(var Pe=F.length,rt=B+(pe?1:-1);pe?rt--:++rt<Pe;)if(V(F[rt],rt,F))return rt;return-1}function dn(F,V,B){return V===V?ig(F,V,B):Bs(F,Pu,B)}function Vp(F,V,B,pe){for(var Pe=B-1,rt=F.length;++Pe<rt;)if(pe(F[Pe],V))return Pe;return-1}function Pu(F){return F!==F}function Ru(F,V){var B=F==null?0:F.length;return B?Ea(F,V)/B:J}function ba(F){return function(V){return V==null?r:V[F]}}function wa(F){return function(V){return F==null?r:F[V]}}function Nu(F,V,B,pe,Pe){return Pe(F,function(rt,Ht,ut){B=pe?(pe=!1,rt):V(B,rt,Ht,ut)}),B}function Gp(F,V){var B=F.length;for(F.sort(V);B--;)F[B]=F[B].value;return F}function Ea(F,V){for(var B,pe=-1,Pe=F.length;++pe<Pe;){var rt=V(F[pe]);rt!==r&&(B=B===r?rt:B+rt)}return B}function Da(F,V){for(var B=-1,pe=Array(F);++B<F;)pe[B]=V(B);return pe}function Wp(F,V){return _t(V,function(B){return[B,F[B]]})}function Tu(F){return F&&F.slice(0,Mu(F)+1).replace(It,"")}function mr(F){return function(V){return F(V)}}function Sa(F,V){return _t(V,function(B){return F[B]})}function jn(F,V){return F.has(V)}function Fu(F,V){for(var B=-1,pe=F.length;++B<pe&&dn(V,F[B],0)>-1;);return B}function $u(F,V){for(var B=F.length;B--&&dn(V,F[B],0)>-1;);return B}function Jp(F,V){for(var B=F.length,pe=0;B--;)F[B]===V&&++pe;return pe}var Yp=wa(b),Xp=wa(N);function Qp(F){return"\\"+de[F]}function Zp(F,V){return F==null?r:F[V]}function pn(F){return js.test(F)}function eg(F){return qi.test(F)}function tg(F){for(var V,B=[];!(V=F.next()).done;)B.push(V.value);return B}function Ia(F){var V=-1,B=Array(F.size);return F.forEach(function(pe,Pe){B[++V]=[Pe,pe]}),B}function Uu(F,V){return function(B){return F(V(B))}}function wi(F,V){for(var B=-1,pe=F.length,Pe=0,rt=[];++B<pe;){var Ht=F[B];(Ht===V||Ht===S)&&(F[B]=S,rt[Pe++]=B)}return rt}function Hs(F){var V=-1,B=Array(F.size);return F.forEach(function(pe){B[++V]=pe}),B}function rg(F){var V=-1,B=Array(F.size);return F.forEach(function(pe){B[++V]=[pe,pe]}),B}function ig(F,V,B){for(var pe=B-1,Pe=F.length;++pe<Pe;)if(F[pe]===V)return pe;return-1}function ng(F,V,B){for(var pe=B+1;pe--;)if(F[pe]===V)return pe;return pe}function gn(F){return pn(F)?og(F):Hp(F)}function Br(F){return pn(F)?ag(F):Kp(F)}function Mu(F){for(var V=F.length;V--&&At.test(F.charAt(V)););return V}var sg=wa(Q);function og(F){for(var V=fn.lastIndex=0;fn.test(F);)++V;return V}function ag(F){return F.match(fn)||[]}function cg(F){return F.match(Ls)||[]}var ug=function F(V){V=V==null?Xe:vn.defaults(Xe.Object(),V,vn.pick(Xe,qs));var B=V.Array,pe=V.Date,Pe=V.Error,rt=V.Function,Ht=V.Math,ut=V.Object,xa=V.RegExp,hg=V.String,Ar=V.TypeError,Ks=B.prototype,lg=rt.prototype,yn=ut.prototype,ks=V["__core-js_shared__"],Vs=lg.toString,nt=yn.hasOwnProperty,fg=0,Lu=function(){var t=/[^.]+$/.exec(ks&&ks.keys&&ks.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Gs=yn.toString,dg=Vs.call(ut),pg=Xe._,gg=xa("^"+Vs.call(nt).replace(St,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ws=lr?V.Buffer:r,Ei=V.Symbol,Js=V.Uint8Array,ju=Ws?Ws.allocUnsafe:r,Ys=Uu(ut.getPrototypeOf,ut),qu=ut.create,zu=yn.propertyIsEnumerable,Xs=Ks.splice,Bu=Ei?Ei.isConcatSpreadable:r,qn=Ei?Ei.iterator:r,Bi=Ei?Ei.toStringTag:r,Qs=function(){try{var t=Gi(ut,"defineProperty");return t({},"",{}),t}catch(i){}}(),vg=V.clearTimeout!==Xe.clearTimeout&&V.clearTimeout,yg=pe&&pe.now!==Xe.Date.now&&pe.now,_g=V.setTimeout!==Xe.setTimeout&&V.setTimeout,Zs=Ht.ceil,eo=Ht.floor,Oa=ut.getOwnPropertySymbols,mg=Ws?Ws.isBuffer:r,Hu=V.isFinite,bg=Ks.join,wg=Uu(ut.keys,ut),Kt=Ht.max,Xt=Ht.min,Eg=pe.now,Dg=V.parseInt,Ku=Ht.random,Sg=Ks.reverse,Ca=Gi(V,"DataView"),zn=Gi(V,"Map"),Aa=Gi(V,"Promise"),_n=Gi(V,"Set"),Bn=Gi(V,"WeakMap"),Hn=Gi(ut,"create"),to=Bn&&new Bn,mn={},Ig=Wi(Ca),xg=Wi(zn),Og=Wi(Aa),Cg=Wi(_n),Ag=Wi(Bn),ro=Ei?Ei.prototype:r,Kn=ro?ro.valueOf:r,ku=ro?ro.toString:r;function v(t){if(Ot(t)&&!Ne(t)&&!(t instanceof Je)){if(t instanceof Pr)return t;if(nt.call(t,"__wrapped__"))return Vh(t)}return new Pr(t)}var bn=function(){function t(){}return function(i){if(!bt(i))return{};if(qu)return qu(i);t.prototype=i;var o=new t;return t.prototype=r,o}}();function io(){}function Pr(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}v.templateSettings={escape:Et,evaluate:Dt,interpolate:mt,variable:"",imports:{_:v}},v.prototype=io.prototype,v.prototype.constructor=v,Pr.prototype=bn(io.prototype),Pr.prototype.constructor=Pr;function Je(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function Pg(){var t=new Je(this.__wrapped__);return t.__actions__=fr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=fr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=fr(this.__views__),t}function Rg(){if(this.__filtered__){var t=new Je(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Ng(){var t=this.__wrapped__.value(),i=this.__dir__,o=Ne(t),u=i<0,d=o?t.length:0,y=K0(0,d,this.__views__),E=y.start,O=y.end,U=O-E,Y=u?O:E-1,X=this.__iteratees__,Z=X.length,ae=0,ve=Xt(U,this.__takeCount__);if(!o||!u&&d==U&&ve==U)return gh(t,this.__actions__);var we=[];e:for(;U--&&ae<ve;){Y+=i;for(var ze=-1,Ee=t[Y];++ze<Z;){var Ge=X[ze],Qe=Ge.iteratee,Er=Ge.type,sr=Qe(Ee);if(Er==z)Ee=sr;else if(!sr){if(Er==R)continue e;break e}}we[ae++]=Ee}return we}Je.prototype=bn(io.prototype),Je.prototype.constructor=Je;function Hi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function Tg(){this.__data__=Hn?Hn(null):{},this.size=0}function Fg(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function $g(t){var i=this.__data__;if(Hn){var o=i[t];return o===g?r:o}return nt.call(i,t)?i[t]:r}function Ug(t){var i=this.__data__;return Hn?i[t]!==r:nt.call(i,t)}function Mg(t,i){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=Hn&&i===r?g:i,this}Hi.prototype.clear=Tg,Hi.prototype.delete=Fg,Hi.prototype.get=$g,Hi.prototype.has=Ug,Hi.prototype.set=Mg;function oi(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function Lg(){this.__data__=[],this.size=0}function jg(t){var i=this.__data__,o=no(i,t);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Xs.call(i,o,1),--this.size,!0}function qg(t){var i=this.__data__,o=no(i,t);return o<0?r:i[o][1]}function zg(t){return no(this.__data__,t)>-1}function Bg(t,i){var o=this.__data__,u=no(o,t);return u<0?(++this.size,o.push([t,i])):o[u][1]=i,this}oi.prototype.clear=Lg,oi.prototype.delete=jg,oi.prototype.get=qg,oi.prototype.has=zg,oi.prototype.set=Bg;function ai(t){var i=-1,o=t==null?0:t.length;for(this.clear();++i<o;){var u=t[i];this.set(u[0],u[1])}}function Hg(){this.size=0,this.__data__={hash:new Hi,map:new(zn||oi),string:new Hi}}function Kg(t){var i=yo(this,t).delete(t);return this.size-=i?1:0,i}function kg(t){return yo(this,t).get(t)}function Vg(t){return yo(this,t).has(t)}function Gg(t,i){var o=yo(this,t),u=o.size;return o.set(t,i),this.size+=o.size==u?0:1,this}ai.prototype.clear=Hg,ai.prototype.delete=Kg,ai.prototype.get=kg,ai.prototype.has=Vg,ai.prototype.set=Gg;function Ki(t){var i=-1,o=t==null?0:t.length;for(this.__data__=new ai;++i<o;)this.add(t[i])}function Wg(t){return this.__data__.set(t,g),this}function Jg(t){return this.__data__.has(t)}Ki.prototype.add=Ki.prototype.push=Wg,Ki.prototype.has=Jg;function Hr(t){var i=this.__data__=new oi(t);this.size=i.size}function Yg(){this.__data__=new oi,this.size=0}function Xg(t){var i=this.__data__,o=i.delete(t);return this.size=i.size,o}function Qg(t){return this.__data__.get(t)}function Zg(t){return this.__data__.has(t)}function e0(t,i){var o=this.__data__;if(o instanceof oi){var u=o.__data__;if(!zn||u.length<a-1)return u.push([t,i]),this.size=++o.size,this;o=this.__data__=new ai(u)}return o.set(t,i),this.size=o.size,this}Hr.prototype.clear=Yg,Hr.prototype.delete=Xg,Hr.prototype.get=Qg,Hr.prototype.has=Zg,Hr.prototype.set=e0;function Vu(t,i){var o=Ne(t),u=!o&&Ji(t),d=!o&&!u&&Oi(t),y=!o&&!u&&!d&&Sn(t),E=o||u||d||y,O=E?Da(t.length,hg):[],U=O.length;for(var Y in t)(i||nt.call(t,Y))&&!(E&&(Y=="length"||d&&(Y=="offset"||Y=="parent")||y&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||li(Y,U)))&&O.push(Y);return O}function Gu(t){var i=t.length;return i?t[qa(0,i-1)]:r}function t0(t,i){return _o(fr(t),ki(i,0,t.length))}function r0(t){return _o(fr(t))}function Pa(t,i,o){(o!==r&&!Kr(t[i],o)||o===r&&!(i in t))&&ci(t,i,o)}function kn(t,i,o){var u=t[i];(!(nt.call(t,i)&&Kr(u,o))||o===r&&!(i in t))&&ci(t,i,o)}function no(t,i){for(var o=t.length;o--;)if(Kr(t[o][0],i))return o;return-1}function i0(t,i,o,u){return Di(t,function(d,y,E){i(u,d,o(d),E)}),u}function Wu(t,i){return t&&Xr(i,Vt(i),t)}function n0(t,i){return t&&Xr(i,pr(i),t)}function ci(t,i,o){i=="__proto__"&&Qs?Qs(t,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[i]=o}function Ra(t,i){for(var o=-1,u=i.length,d=B(u),y=t==null;++o<u;)d[o]=y?r:lc(t,i[o]);return d}function ki(t,i,o){return t===t&&(o!==r&&(t=t<=o?t:o),i!==r&&(t=t>=i?t:i)),t}function Rr(t,i,o,u,d,y){var E,O=i&T,U=i&j,Y=i&P;if(o&&(E=d?o(t,u,d,y):o(t)),E!==r)return E;if(!bt(t))return t;var X=Ne(t);if(X){if(E=V0(t),!O)return fr(t,E)}else{var Z=Qt(t),ae=Z==se||Z==fe;if(Oi(t))return _h(t,O);if(Z==Me||Z==he||ae&&!d){if(E=U||ae?{}:Mh(t),!O)return U?$0(t,n0(E,t)):F0(t,Wu(E,t))}else{if(!st[Z])return d?t:{};E=G0(t,Z,O)}}y||(y=new Hr);var ve=y.get(t);if(ve)return ve;y.set(t,E),fl(t)?t.forEach(function(Ee){E.add(Rr(Ee,i,o,Ee,t,y))}):hl(t)&&t.forEach(function(Ee,Ge){E.set(Ge,Rr(Ee,i,o,Ge,t,y))});var we=Y?U?Xa:Ya:U?pr:Vt,ze=X?r:we(t);return Cr(ze||t,function(Ee,Ge){ze&&(Ge=Ee,Ee=t[Ge]),kn(E,Ge,Rr(Ee,i,o,Ge,t,y))}),E}function s0(t){var i=Vt(t);return function(o){return Ju(o,t,i)}}function Ju(t,i,o){var u=o.length;if(t==null)return!u;for(t=ut(t);u--;){var d=o[u],y=i[d],E=t[d];if(E===r&&!(d in t)||!y(E))return!1}return!0}function Yu(t,i,o){if(typeof t!="function")throw new Ar(p);return Qn(function(){t.apply(r,o)},i)}function Vn(t,i,o,u){var d=-1,y=zs,E=!0,O=t.length,U=[],Y=i.length;if(!O)return U;o&&(i=_t(i,mr(o))),u?(y=ya,E=!1):i.length>=a&&(y=jn,E=!1,i=new Ki(i));e:for(;++d<O;){var X=t[d],Z=o==null?X:o(X);if(X=u||X!==0?X:0,E&&Z===Z){for(var ae=Y;ae--;)if(i[ae]===Z)continue e;U.push(X)}else y(i,Z,u)||U.push(X)}return U}var Di=Dh(Yr),Xu=Dh(Ta,!0);function o0(t,i){var o=!0;return Di(t,function(u,d,y){return o=!!i(u,d,y),o}),o}function so(t,i,o){for(var u=-1,d=t.length;++u<d;){var y=t[u],E=i(y);if(E!=null&&(O===r?E===E&&!wr(E):o(E,O)))var O=E,U=y}return U}function a0(t,i,o,u){var d=t.length;for(o=Le(o),o<0&&(o=-o>d?0:d+o),u=u===r||u>d?d:Le(u),u<0&&(u+=d),u=o>u?0:pl(u);o<u;)t[o++]=i;return t}function Qu(t,i){var o=[];return Di(t,function(u,d,y){i(u,d,y)&&o.push(u)}),o}function Wt(t,i,o,u,d){var y=-1,E=t.length;for(o||(o=J0),d||(d=[]);++y<E;){var O=t[y];i>0&&o(O)?i>1?Wt(O,i-1,o,u,d):bi(d,O):u||(d[d.length]=O)}return d}var Na=Sh(),Zu=Sh(!0);function Yr(t,i){return t&&Na(t,i,Vt)}function Ta(t,i){return t&&Zu(t,i,Vt)}function oo(t,i){return mi(i,function(o){return fi(t[o])})}function Vi(t,i){i=Ii(i,t);for(var o=0,u=i.length;t!=null&&o<u;)t=t[Qr(i[o++])];return o&&o==u?t:r}function eh(t,i,o){var u=i(t);return Ne(t)?u:bi(u,o(t))}function ir(t){return t==null?t===r?qe:ke:Bi&&Bi in ut(t)?H0(t):r1(t)}function Fa(t,i){return t>i}function c0(t,i){return t!=null&&nt.call(t,i)}function u0(t,i){return t!=null&&i in ut(t)}function h0(t,i,o){return t>=Xt(i,o)&&t<Kt(i,o)}function $a(t,i,o){for(var u=o?ya:zs,d=t[0].length,y=t.length,E=y,O=B(y),U=1/0,Y=[];E--;){var X=t[E];E&&i&&(X=_t(X,mr(i))),U=Xt(X.length,U),O[E]=!o&&(i||d>=120&&X.length>=120)?new Ki(E&&X):r}X=t[0];var Z=-1,ae=O[0];e:for(;++Z<d&&Y.length<U;){var ve=X[Z],we=i?i(ve):ve;if(ve=o||ve!==0?ve:0,!(ae?jn(ae,we):u(Y,we,o))){for(E=y;--E;){var ze=O[E];if(!(ze?jn(ze,we):u(t[E],we,o)))continue e}ae&&ae.push(we),Y.push(ve)}}return Y}function l0(t,i,o,u){return Yr(t,function(d,y,E){i(u,o(d),y,E)}),u}function Gn(t,i,o){i=Ii(i,t),t=zh(t,i);var u=t==null?t:t[Qr(Tr(i))];return u==null?r:kt(u,t,o)}function th(t){return Ot(t)&&ir(t)==he}function f0(t){return Ot(t)&&ir(t)==De}function d0(t){return Ot(t)&&ir(t)==A}function Wn(t,i,o,u,d){return t===i?!0:t==null||i==null||!Ot(t)&&!Ot(i)?t!==t&&i!==i:p0(t,i,o,u,Wn,d)}function p0(t,i,o,u,d,y){var E=Ne(t),O=Ne(i),U=E?_e:Qt(t),Y=O?_e:Qt(i);U=U==he?Me:U,Y=Y==he?Me:Y;var X=U==Me,Z=Y==Me,ae=U==Y;if(ae&&Oi(t)){if(!Oi(i))return!1;E=!0,X=!1}if(ae&&!X)return y||(y=new Hr),E||Sn(t)?Fh(t,i,o,u,d,y):z0(t,i,U,o,u,d,y);if(!(o&M)){var ve=X&&nt.call(t,"__wrapped__"),we=Z&&nt.call(i,"__wrapped__");if(ve||we){var ze=ve?t.value():t,Ee=we?i.value():i;return y||(y=new Hr),d(ze,Ee,o,u,y)}}return ae?(y||(y=new Hr),B0(t,i,o,u,d,y)):!1}function g0(t){return Ot(t)&&Qt(t)==Se}function Ua(t,i,o,u){var d=o.length,y=d,E=!u;if(t==null)return!y;for(t=ut(t);d--;){var O=o[d];if(E&&O[2]?O[1]!==t[O[0]]:!(O[0]in t))return!1}for(;++d<y;){O=o[d];var U=O[0],Y=t[U],X=O[1];if(E&&O[2]){if(Y===r&&!(U in t))return!1}else{var Z=new Hr;if(u)var ae=u(Y,X,U,t,i,Z);if(!(ae===r?Wn(X,Y,M|H,u,Z):ae))return!1}}return!0}function rh(t){if(!bt(t)||X0(t))return!1;var i=fi(t)?gg:ta;return i.test(Wi(t))}function v0(t){return Ot(t)&&ir(t)==je}function y0(t){return Ot(t)&&Qt(t)==Ie}function _0(t){return Ot(t)&&So(t.length)&&!!ot[ir(t)]}function ih(t){return typeof t=="function"?t:t==null?gr:typeof t=="object"?Ne(t)?oh(t[0],t[1]):sh(t):Il(t)}function Ma(t){if(!Xn(t))return wg(t);var i=[];for(var o in ut(t))nt.call(t,o)&&o!="constructor"&&i.push(o);return i}function m0(t){if(!bt(t))return t1(t);var i=Xn(t),o=[];for(var u in t)u=="constructor"&&(i||!nt.call(t,u))||o.push(u);return o}function La(t,i){return t<i}function nh(t,i){var o=-1,u=dr(t)?B(t.length):[];return Di(t,function(d,y,E){u[++o]=i(d,y,E)}),u}function sh(t){var i=Za(t);return i.length==1&&i[0][2]?jh(i[0][0],i[0][1]):function(o){return o===t||Ua(o,t,i)}}function oh(t,i){return tc(t)&&Lh(i)?jh(Qr(t),i):function(o){var u=lc(o,t);return u===r&&u===i?fc(o,t):Wn(i,u,M|H)}}function ao(t,i,o,u,d){t!==i&&Na(i,function(y,E){if(d||(d=new Hr),bt(y))b0(t,i,E,o,ao,u,d);else{var O=u?u(ic(t,E),y,E+"",t,i,d):r;O===r&&(O=y),Pa(t,E,O)}},pr)}function b0(t,i,o,u,d,y,E){var O=ic(t,o),U=ic(i,o),Y=E.get(U);if(Y){Pa(t,o,Y);return}var X=y?y(O,U,o+"",t,i,E):r,Z=X===r;if(Z){var ae=Ne(U),ve=!ae&&Oi(U),we=!ae&&!ve&&Sn(U);X=U,ae||ve||we?Ne(O)?X=O:Rt(O)?X=fr(O):ve?(Z=!1,X=_h(U,!0)):we?(Z=!1,X=mh(U,!0)):X=[]:Zn(U)||Ji(U)?(X=O,Ji(O)?X=gl(O):(!bt(O)||fi(O))&&(X=Mh(U))):Z=!1}Z&&(E.set(U,X),d(X,U,u,y,E),E.delete(U)),Pa(t,o,X)}function ah(t,i){var o=t.length;if(o)return i+=i<0?o:0,li(i,o)?t[i]:r}function ch(t,i,o){i.length?i=_t(i,function(y){return Ne(y)?function(E){return Vi(E,y.length===1?y[0]:y)}:y}):i=[gr];var u=-1;i=_t(i,mr(me()));var d=nh(t,function(y,E,O){var U=_t(i,function(Y){return Y(y)});return{criteria:U,index:++u,value:y}});return Gp(d,function(y,E){return T0(y,E,o)})}function w0(t,i){return uh(t,i,function(o,u){return fc(t,u)})}function uh(t,i,o){for(var u=-1,d=i.length,y={};++u<d;){var E=i[u],O=Vi(t,E);o(O,E)&&Jn(y,Ii(E,t),O)}return y}function E0(t){return function(i){return Vi(i,t)}}function ja(t,i,o,u){var d=u?Vp:dn,y=-1,E=i.length,O=t;for(t===i&&(i=fr(i)),o&&(O=_t(t,mr(o)));++y<E;)for(var U=0,Y=i[y],X=o?o(Y):Y;(U=d(O,X,U,u))>-1;)O!==t&&Xs.call(O,U,1),Xs.call(t,U,1);return t}function hh(t,i){for(var o=t?i.length:0,u=o-1;o--;){var d=i[o];if(o==u||d!==y){var y=d;li(d)?Xs.call(t,d,1):Ha(t,d)}}return t}function qa(t,i){return t+eo(Ku()*(i-t+1))}function D0(t,i,o,u){for(var d=-1,y=Kt(Zs((i-t)/(o||1)),0),E=B(y);y--;)E[u?y:++d]=t,t+=o;return E}function za(t,i){var o="";if(!t||i<1||i>W)return o;do i%2&&(o+=t),i=eo(i/2),i&&(t+=t);while(i);return o}function Ke(t,i){return nc(qh(t,i,gr),t+"")}function S0(t){return Gu(In(t))}function I0(t,i){var o=In(t);return _o(o,ki(i,0,o.length))}function Jn(t,i,o,u){if(!bt(t))return t;i=Ii(i,t);for(var d=-1,y=i.length,E=y-1,O=t;O!=null&&++d<y;){var U=Qr(i[d]),Y=o;if(U==="__proto__"||U==="constructor"||U==="prototype")return t;if(d!=E){var X=O[U];Y=u?u(X,U,O):r,Y===r&&(Y=bt(X)?X:li(i[d+1])?[]:{})}kn(O,U,Y),O=O[U]}return t}var lh=to?function(t,i){return to.set(t,i),t}:gr,x0=Qs?function(t,i){return Qs(t,"toString",{configurable:!0,enumerable:!1,value:pc(i),writable:!0})}:gr;function O0(t){return _o(In(t))}function Nr(t,i,o){var u=-1,d=t.length;i<0&&(i=-i>d?0:d+i),o=o>d?d:o,o<0&&(o+=d),d=i>o?0:o-i>>>0,i>>>=0;for(var y=B(d);++u<d;)y[u]=t[u+i];return y}function C0(t,i){var o;return Di(t,function(u,d,y){return o=i(u,d,y),!o}),!!o}function co(t,i,o){var u=0,d=t==null?u:t.length;if(typeof i=="number"&&i===i&&d<=ne){for(;u<d;){var y=u+d>>>1,E=t[y];E!==null&&!wr(E)&&(o?E<=i:E<i)?u=y+1:d=y}return d}return Ba(t,i,gr,o)}function Ba(t,i,o,u){var d=0,y=t==null?0:t.length;if(y===0)return 0;i=o(i);for(var E=i!==i,O=i===null,U=wr(i),Y=i===r;d<y;){var X=eo((d+y)/2),Z=o(t[X]),ae=Z!==r,ve=Z===null,we=Z===Z,ze=wr(Z);if(E)var Ee=u||we;else Y?Ee=we&&(u||ae):O?Ee=we&&ae&&(u||!ve):U?Ee=we&&ae&&!ve&&(u||!ze):ve||ze?Ee=!1:Ee=u?Z<=i:Z<i;Ee?d=X+1:y=X}return Xt(y,xe)}function fh(t,i){for(var o=-1,u=t.length,d=0,y=[];++o<u;){var E=t[o],O=i?i(E):E;if(!o||!Kr(O,U)){var U=O;y[d++]=E===0?0:E}}return y}function dh(t){return typeof t=="number"?t:wr(t)?J:+t}function br(t){if(typeof t=="string")return t;if(Ne(t))return _t(t,br)+"";if(wr(t))return ku?ku.call(t):"";var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Si(t,i,o){var u=-1,d=zs,y=t.length,E=!0,O=[],U=O;if(o)E=!1,d=ya;else if(y>=a){var Y=i?null:j0(t);if(Y)return Hs(Y);E=!1,d=jn,U=new Ki}else U=i?[]:O;e:for(;++u<y;){var X=t[u],Z=i?i(X):X;if(X=o||X!==0?X:0,E&&Z===Z){for(var ae=U.length;ae--;)if(U[ae]===Z)continue e;i&&U.push(Z),O.push(X)}else d(U,Z,o)||(U!==O&&U.push(Z),O.push(X))}return O}function Ha(t,i){return i=Ii(i,t),t=zh(t,i),t==null||delete t[Qr(Tr(i))]}function ph(t,i,o,u){return Jn(t,i,o(Vi(t,i)),u)}function uo(t,i,o,u){for(var d=t.length,y=u?d:-1;(u?y--:++y<d)&&i(t[y],y,t););return o?Nr(t,u?0:y,u?y+1:d):Nr(t,u?y+1:0,u?d:y)}function gh(t,i){var o=t;return o instanceof Je&&(o=o.value()),_a(i,function(u,d){return d.func.apply(d.thisArg,bi([u],d.args))},o)}function Ka(t,i,o){var u=t.length;if(u<2)return u?Si(t[0]):[];for(var d=-1,y=B(u);++d<u;)for(var E=t[d],O=-1;++O<u;)O!=d&&(y[d]=Vn(y[d]||E,t[O],i,o));return Si(Wt(y,1),i,o)}function vh(t,i,o){for(var u=-1,d=t.length,y=i.length,E={};++u<d;){var O=u<y?i[u]:r;o(E,t[u],O)}return E}function ka(t){return Rt(t)?t:[]}function Va(t){return typeof t=="function"?t:gr}function Ii(t,i){return Ne(t)?t:tc(t,i)?[t]:kh(it(t))}var A0=Ke;function xi(t,i,o){var u=t.length;return o=o===r?u:o,!i&&o>=u?t:Nr(t,i,o)}var yh=vg||function(t){return Xe.clearTimeout(t)};function _h(t,i){if(i)return t.slice();var o=t.length,u=ju?ju(o):new t.constructor(o);return t.copy(u),u}function Ga(t){var i=new t.constructor(t.byteLength);return new Js(i).set(new Js(t)),i}function P0(t,i){var o=i?Ga(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.byteLength)}function R0(t){var i=new t.constructor(t.source,xr.exec(t));return i.lastIndex=t.lastIndex,i}function N0(t){return Kn?ut(Kn.call(t)):{}}function mh(t,i){var o=i?Ga(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}function bh(t,i){if(t!==i){var o=t!==r,u=t===null,d=t===t,y=wr(t),E=i!==r,O=i===null,U=i===i,Y=wr(i);if(!O&&!Y&&!y&&t>i||y&&E&&U&&!O&&!Y||u&&E&&U||!o&&U||!d)return 1;if(!u&&!y&&!Y&&t<i||Y&&o&&d&&!u&&!y||O&&o&&d||!E&&d||!U)return-1}return 0}function T0(t,i,o){for(var u=-1,d=t.criteria,y=i.criteria,E=d.length,O=o.length;++u<E;){var U=bh(d[u],y[u]);if(U){if(u>=O)return U;var Y=o[u];return U*(Y=="desc"?-1:1)}}return t.index-i.index}function wh(t,i,o,u){for(var d=-1,y=t.length,E=o.length,O=-1,U=i.length,Y=Kt(y-E,0),X=B(U+Y),Z=!u;++O<U;)X[O]=i[O];for(;++d<E;)(Z||d<y)&&(X[o[d]]=t[d]);for(;Y--;)X[O++]=t[d++];return X}function Eh(t,i,o,u){for(var d=-1,y=t.length,E=-1,O=o.length,U=-1,Y=i.length,X=Kt(y-O,0),Z=B(X+Y),ae=!u;++d<X;)Z[d]=t[d];for(var ve=d;++U<Y;)Z[ve+U]=i[U];for(;++E<O;)(ae||d<y)&&(Z[ve+o[E]]=t[d++]);return Z}function fr(t,i){var o=-1,u=t.length;for(i||(i=B(u));++o<u;)i[o]=t[o];return i}function Xr(t,i,o,u){var d=!o;o||(o={});for(var y=-1,E=i.length;++y<E;){var O=i[y],U=u?u(o[O],t[O],O,o,t):r;U===r&&(U=t[O]),d?ci(o,O,U):kn(o,O,U)}return o}function F0(t,i){return Xr(t,ec(t),i)}function $0(t,i){return Xr(t,$h(t),i)}function ho(t,i){return function(o,u){var d=Ne(o)?qp:i0,y=i?i():{};return d(o,t,me(u,2),y)}}function wn(t){return Ke(function(i,o){var u=-1,d=o.length,y=d>1?o[d-1]:r,E=d>2?o[2]:r;for(y=t.length>3&&typeof y=="function"?(d--,y):r,E&&nr(o[0],o[1],E)&&(y=d<3?r:y,d=1),i=ut(i);++u<d;){var O=o[u];O&&t(i,O,u,y)}return i})}function Dh(t,i){return function(o,u){if(o==null)return o;if(!dr(o))return t(o,u);for(var d=o.length,y=i?d:-1,E=ut(o);(i?y--:++y<d)&&u(E[y],y,E)!==!1;);return o}}function Sh(t){return function(i,o,u){for(var d=-1,y=ut(i),E=u(i),O=E.length;O--;){var U=E[t?O:++d];if(o(y[U],U,y)===!1)break}return i}}function U0(t,i,o){var u=i&K,d=Yn(t);function y(){var E=this&&this!==Xe&&this instanceof y?d:t;return E.apply(u?o:this,arguments)}return y}function Ih(t){return function(i){i=it(i);var o=pn(i)?Br(i):r,u=o?o[0]:i.charAt(0),d=o?xi(o,1).join(""):i.slice(1);return u[t]()+d}}function En(t){return function(i){return _a(Dl(El(i).replace(Mn,"")),t,"")}}function Yn(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=bn(t.prototype),u=t.apply(o,i);return bt(u)?u:o}}function M0(t,i,o){var u=Yn(t);function d(){for(var y=arguments.length,E=B(y),O=y,U=Dn(d);O--;)E[O]=arguments[O];var Y=y<3&&E[0]!==U&&E[y-1]!==U?[]:wi(E,U);if(y-=Y.length,y<o)return Ph(t,i,lo,d.placeholder,r,E,Y,r,r,o-y);var X=this&&this!==Xe&&this instanceof d?u:t;return kt(X,this,E)}return d}function xh(t){return function(i,o,u){var d=ut(i);if(!dr(i)){var y=me(o,3);i=Vt(i),o=function(O){return y(d[O],O,d)}}var E=t(i,o,u);return E>-1?d[y?i[E]:E]:r}}function Oh(t){return hi(function(i){var o=i.length,u=o,d=Pr.prototype.thru;for(t&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new Ar(p);if(d&&!E&&vo(y)=="wrapper")var E=new Pr([],!0)}for(u=E?u:o;++u<o;){y=i[u];var O=vo(y),U=O=="wrapper"?Qa(y):r;U&&rc(U[0])&&U[1]==(c|$|x|_)&&!U[4].length&&U[9]==1?E=E[vo(U[0])].apply(E,U[3]):E=y.length==1&&rc(y)?E[O]():E.thru(y)}return function(){var Y=arguments,X=Y[0];if(E&&Y.length==1&&Ne(X))return E.plant(X).value();for(var Z=0,ae=o?i[Z].apply(this,Y):X;++Z<o;)ae=i[Z].call(this,ae);return ae}})}function lo(t,i,o,u,d,y,E,O,U,Y){var X=i&c,Z=i&K,ae=i&ie,ve=i&($|D),we=i&k,ze=ae?r:Yn(t);function Ee(){for(var Ge=arguments.length,Qe=B(Ge),Er=Ge;Er--;)Qe[Er]=arguments[Er];if(ve)var sr=Dn(Ee),Dr=Jp(Qe,sr);if(u&&(Qe=wh(Qe,u,d,ve)),y&&(Qe=Eh(Qe,y,E,ve)),Ge-=Dr,ve&&Ge<Y){var Nt=wi(Qe,sr);return Ph(t,i,lo,Ee.placeholder,o,Qe,Nt,O,U,Y-Ge)}var kr=Z?o:this,pi=ae?kr[t]:t;return Ge=Qe.length,O?Qe=i1(Qe,O):we&&Ge>1&&Qe.reverse(),X&&U<Ge&&(Qe.length=U),this&&this!==Xe&&this instanceof Ee&&(pi=ze||Yn(pi)),pi.apply(kr,Qe)}return Ee}function Ch(t,i){return function(o,u){return l0(o,t,i(u),{})}}function fo(t,i){return function(o,u){var d;if(o===r&&u===r)return i;if(o!==r&&(d=o),u!==r){if(d===r)return u;typeof o=="string"||typeof u=="string"?(o=br(o),u=br(u)):(o=dh(o),u=dh(u)),d=t(o,u)}return d}}function Wa(t){return hi(function(i){return i=_t(i,mr(me())),Ke(function(o){var u=this;return t(i,function(d){return kt(d,u,o)})})})}function po(t,i){i=i===r?" ":br(i);var o=i.length;if(o<2)return o?za(i,t):i;var u=za(i,Zs(t/gn(i)));return pn(i)?xi(Br(u),0,t).join(""):u.slice(0,t)}function L0(t,i,o,u){var d=i&K,y=Yn(t);function E(){for(var O=-1,U=arguments.length,Y=-1,X=u.length,Z=B(X+U),ae=this&&this!==Xe&&this instanceof E?y:t;++Y<X;)Z[Y]=u[Y];for(;U--;)Z[Y++]=arguments[++O];return kt(ae,d?o:this,Z)}return E}function Ah(t){return function(i,o,u){return u&&typeof u!="number"&&nr(i,o,u)&&(o=u=r),i=di(i),o===r?(o=i,i=0):o=di(o),u=u===r?i<o?1:-1:di(u),D0(i,o,u,t)}}function go(t){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Fr(i),o=Fr(o)),t(i,o)}}function Ph(t,i,o,u,d,y,E,O,U,Y){var X=i&$,Z=X?E:r,ae=X?r:E,ve=X?y:r,we=X?r:y;i|=X?x:m,i&=~(X?m:x),i&C||(i&=~(K|ie));var ze=[t,i,d,ve,Z,we,ae,O,U,Y],Ee=o.apply(r,ze);return rc(t)&&Bh(Ee,ze),Ee.placeholder=u,Hh(Ee,t,i)}function Ja(t){var i=Ht[t];return function(o,u){if(o=Fr(o),u=u==null?0:Xt(Le(u),292),u&&Hu(o)){var d=(it(o)+"e").split("e"),y=i(d[0]+"e"+(+d[1]+u));return d=(it(y)+"e").split("e"),+(d[0]+"e"+(+d[1]-u))}return i(o)}}var j0=_n&&1/Hs(new _n([,-0]))[1]==te?function(t){return new _n(t)}:yc;function Rh(t){return function(i){var o=Qt(i);return o==Se?Ia(i):o==Ie?rg(i):Wp(i,t(i))}}function ui(t,i,o,u,d,y,E,O){var U=i&ie;if(!U&&typeof t!="function")throw new Ar(p);var Y=u?u.length:0;if(Y||(i&=~(x|m),u=d=r),E=E===r?E:Kt(Le(E),0),O=O===r?O:Le(O),Y-=d?d.length:0,i&m){var X=u,Z=d;u=d=r}var ae=U?r:Qa(t),ve=[t,i,o,u,d,X,Z,y,E,O];if(ae&&e1(ve,ae),t=ve[0],i=ve[1],o=ve[2],u=ve[3],d=ve[4],O=ve[9]=ve[9]===r?U?0:t.length:Kt(ve[9]-Y,0),!O&&i&($|D)&&(i&=~($|D)),!i||i==K)var we=U0(t,i,o);else i==$||i==D?we=M0(t,i,O):(i==x||i==(K|x))&&!d.length?we=L0(t,i,o,u):we=lo.apply(r,ve);var ze=ae?lh:Bh;return Hh(ze(we,ve),t,i)}function Nh(t,i,o,u){return t===r||Kr(t,yn[o])&&!nt.call(u,o)?i:t}function Th(t,i,o,u,d,y){return bt(t)&&bt(i)&&(y.set(i,t),ao(t,i,r,Th,y),y.delete(i)),t}function q0(t){return Zn(t)?r:t}function Fh(t,i,o,u,d,y){var E=o&M,O=t.length,U=i.length;if(O!=U&&!(E&&U>O))return!1;var Y=y.get(t),X=y.get(i);if(Y&&X)return Y==i&&X==t;var Z=-1,ae=!0,ve=o&H?new Ki:r;for(y.set(t,i),y.set(i,t);++Z<O;){var we=t[Z],ze=i[Z];if(u)var Ee=E?u(ze,we,Z,i,t,y):u(we,ze,Z,t,i,y);if(Ee!==r){if(Ee)continue;ae=!1;break}if(ve){if(!ma(i,function(Ge,Qe){if(!jn(ve,Qe)&&(we===Ge||d(we,Ge,o,u,y)))return ve.push(Qe)})){ae=!1;break}}else if(!(we===ze||d(we,ze,o,u,y))){ae=!1;break}}return y.delete(t),y.delete(i),ae}function z0(t,i,o,u,d,y,E){switch(o){case Ae:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case De:return!(t.byteLength!=i.byteLength||!y(new Js(t),new Js(i)));case L:case A:case Be:return Kr(+t,+i);case I:return t.name==i.name&&t.message==i.message;case je:case Te:return t==i+"";case Se:var O=Ia;case Ie:var U=u&M;if(O||(O=Hs),t.size!=i.size&&!U)return!1;var Y=E.get(t);if(Y)return Y==i;u|=H,E.set(t,i);var X=Fh(O(t),O(i),u,d,y,E);return E.delete(t),X;case Fe:if(Kn)return Kn.call(t)==Kn.call(i)}return!1}function B0(t,i,o,u,d,y){var E=o&M,O=Ya(t),U=O.length,Y=Ya(i),X=Y.length;if(U!=X&&!E)return!1;for(var Z=U;Z--;){var ae=O[Z];if(!(E?ae in i:nt.call(i,ae)))return!1}var ve=y.get(t),we=y.get(i);if(ve&&we)return ve==i&&we==t;var ze=!0;y.set(t,i),y.set(i,t);for(var Ee=E;++Z<U;){ae=O[Z];var Ge=t[ae],Qe=i[ae];if(u)var Er=E?u(Qe,Ge,ae,i,t,y):u(Ge,Qe,ae,t,i,y);if(!(Er===r?Ge===Qe||d(Ge,Qe,o,u,y):Er)){ze=!1;break}Ee||(Ee=ae=="constructor")}if(ze&&!Ee){var sr=t.constructor,Dr=i.constructor;sr!=Dr&&"constructor"in t&&"constructor"in i&&!(typeof sr=="function"&&sr instanceof sr&&typeof Dr=="function"&&Dr instanceof Dr)&&(ze=!1)}return y.delete(t),y.delete(i),ze}function hi(t){return nc(qh(t,r,Jh),t+"")}function Ya(t){return eh(t,Vt,ec)}function Xa(t){return eh(t,pr,$h)}var Qa=to?function(t){return to.get(t)}:yc;function vo(t){for(var i=t.name+"",o=mn[i],u=nt.call(mn,i)?o.length:0;u--;){var d=o[u],y=d.func;if(y==null||y==t)return d.name}return i}function Dn(t){var i=nt.call(v,"placeholder")?v:t;return i.placeholder}function me(){var t=v.iteratee||gc;return t=t===gc?ih:t,arguments.length?t(arguments[0],arguments[1]):t}function yo(t,i){var o=t.__data__;return Y0(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Za(t){for(var i=Vt(t),o=i.length;o--;){var u=i[o],d=t[u];i[o]=[u,d,Lh(d)]}return i}function Gi(t,i){var o=Zp(t,i);return rh(o)?o:r}function H0(t){var i=nt.call(t,Bi),o=t[Bi];try{t[Bi]=r;var u=!0}catch(y){}var d=Gs.call(t);return u&&(i?t[Bi]=o:delete t[Bi]),d}var ec=Oa?function(t){return t==null?[]:(t=ut(t),mi(Oa(t),function(i){return zu.call(t,i)}))}:_c,$h=Oa?function(t){for(var i=[];t;)bi(i,ec(t)),t=Ys(t);return i}:_c,Qt=ir;(Ca&&Qt(new Ca(new ArrayBuffer(1)))!=Ae||zn&&Qt(new zn)!=Se||Aa&&Qt(Aa.resolve())!=pt||_n&&Qt(new _n)!=Ie||Bn&&Qt(new Bn)!=Ce)&&(Qt=function(t){var i=ir(t),o=i==Me?t.constructor:r,u=o?Wi(o):"";if(u)switch(u){case Ig:return Ae;case xg:return Se;case Og:return pt;case Cg:return Ie;case Ag:return Ce}return i});function K0(t,i,o){for(var u=-1,d=o.length;++u<d;){var y=o[u],E=y.size;switch(y.type){case"drop":t+=E;break;case"dropRight":i-=E;break;case"take":i=Xt(i,t+E);break;case"takeRight":t=Kt(t,i-E);break}}return{start:t,end:i}}function k0(t){var i=t.match(ht);return i?i[1].split(Lt):[]}function Uh(t,i,o){i=Ii(i,t);for(var u=-1,d=i.length,y=!1;++u<d;){var E=Qr(i[u]);if(!(y=t!=null&&o(t,E)))break;t=t[E]}return y||++u!=d?y:(d=t==null?0:t.length,!!d&&So(d)&&li(E,d)&&(Ne(t)||Ji(t)))}function V0(t){var i=t.length,o=new t.constructor(i);return i&&typeof t[0]=="string"&&nt.call(t,"index")&&(o.index=t.index,o.input=t.input),o}function Mh(t){return typeof t.constructor=="function"&&!Xn(t)?bn(Ys(t)):{}}function G0(t,i,o){var u=t.constructor;switch(i){case De:return Ga(t);case L:case A:return new u(+t);case Ae:return P0(t,o);case He:case Oe:case Ve:case We:case et:case tt:case Ye:case er:case hr:return mh(t,o);case Se:return new u;case Be:case Te:return new u(t);case je:return R0(t);case Ie:return new u;case Fe:return N0(t)}}function W0(t,i){var o=i.length;if(!o)return t;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),t.replace(xt,`{
/* [wrapped with `+i+`] */
`)}function J0(t){return Ne(t)||Ji(t)||!!(Bu&&t&&t[Bu])}function li(t,i){var o=typeof t;return i=i!=null?i:W,!!i&&(o=="number"||o!="symbol"&&ia.test(t))&&t>-1&&t%1==0&&t<i}function nr(t,i,o){if(!bt(o))return!1;var u=typeof i;return(u=="number"?dr(o)&&li(i,o.length):u=="string"&&i in o)?Kr(o[i],t):!1}function tc(t,i){if(Ne(t))return!1;var o=typeof t;return o=="number"||o=="symbol"||o=="boolean"||t==null||wr(t)?!0:$t.test(t)||!yt.test(t)||i!=null&&t in ut(i)}function Y0(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function rc(t){var i=vo(t),o=v[i];if(typeof o!="function"||!(i in Je.prototype))return!1;if(t===o)return!0;var u=Qa(o);return!!u&&t===u[0]}function X0(t){return!!Lu&&Lu in t}var Q0=ks?fi:mc;function Xn(t){var i=t&&t.constructor,o=typeof i=="function"&&i.prototype||yn;return t===o}function Lh(t){return t===t&&!bt(t)}function jh(t,i){return function(o){return o==null?!1:o[t]===i&&(i!==r||t in ut(o))}}function Z0(t){var i=Eo(t,function(u){return o.size===w&&o.clear(),u}),o=i.cache;return i}function e1(t,i){var o=t[1],u=i[1],d=o|u,y=d<(K|ie|c),E=u==c&&o==$||u==c&&o==_&&t[7].length<=i[8]||u==(c|_)&&i[7].length<=i[8]&&o==$;if(!(y||E))return t;u&K&&(t[2]=i[2],d|=o&K?0:C);var O=i[3];if(O){var U=t[3];t[3]=U?wh(U,O,i[4]):O,t[4]=U?wi(t[3],S):i[4]}return O=i[5],O&&(U=t[5],t[5]=U?Eh(U,O,i[6]):O,t[6]=U?wi(t[5],S):i[6]),O=i[7],O&&(t[7]=O),u&c&&(t[8]=t[8]==null?i[8]:Xt(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=d,t}function t1(t){var i=[];if(t!=null)for(var o in ut(t))i.push(o);return i}function r1(t){return Gs.call(t)}function qh(t,i,o){return i=Kt(i===r?t.length-1:i,0),function(){for(var u=arguments,d=-1,y=Kt(u.length-i,0),E=B(y);++d<y;)E[d]=u[i+d];d=-1;for(var O=B(i+1);++d<i;)O[d]=u[d];return O[i]=o(E),kt(t,this,O)}}function zh(t,i){return i.length<2?t:Vi(t,Nr(i,0,-1))}function i1(t,i){for(var o=t.length,u=Xt(i.length,o),d=fr(t);u--;){var y=i[u];t[u]=li(y,o)?d[y]:r}return t}function ic(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var Bh=Kh(lh),Qn=_g||function(t,i){return Xe.setTimeout(t,i)},nc=Kh(x0);function Hh(t,i,o){var u=i+"";return nc(t,W0(u,n1(k0(u),o)))}function Kh(t){var i=0,o=0;return function(){var u=Eg(),d=ge-(u-o);if(o=u,d>0){if(++i>=ce)return arguments[0]}else i=0;return t.apply(r,arguments)}}function _o(t,i){var o=-1,u=t.length,d=u-1;for(i=i===r?u:i;++o<i;){var y=qa(o,d),E=t[y];t[y]=t[o],t[o]=E}return t.length=i,t}var kh=Z0(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(Ut,function(o,u,d,y){i.push(d?y.replace(Xo,"$1"):u||o)}),i});function Qr(t){if(typeof t=="string"||wr(t))return t;var i=t+"";return i=="0"&&1/t==-te?"-0":i}function Wi(t){if(t!=null){try{return Vs.call(t)}catch(i){}try{return t+""}catch(i){}}return""}function n1(t,i){return Cr(be,function(o){var u="_."+o[0];i&o[1]&&!zs(t,u)&&t.push(u)}),t.sort()}function Vh(t){if(t instanceof Je)return t.clone();var i=new Pr(t.__wrapped__,t.__chain__);return i.__actions__=fr(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function s1(t,i,o){(o?nr(t,i,o):i===r)?i=1:i=Kt(Le(i),0);var u=t==null?0:t.length;if(!u||i<1)return[];for(var d=0,y=0,E=B(Zs(u/i));d<u;)E[y++]=Nr(t,d,d+=i);return E}function o1(t){for(var i=-1,o=t==null?0:t.length,u=0,d=[];++i<o;){var y=t[i];y&&(d[u++]=y)}return d}function a1(){var t=arguments.length;if(!t)return[];for(var i=B(t-1),o=arguments[0],u=t;u--;)i[u-1]=arguments[u];return bi(Ne(o)?fr(o):[o],Wt(i,1))}var c1=Ke(function(t,i){return Rt(t)?Vn(t,Wt(i,1,Rt,!0)):[]}),u1=Ke(function(t,i){var o=Tr(i);return Rt(o)&&(o=r),Rt(t)?Vn(t,Wt(i,1,Rt,!0),me(o,2)):[]}),h1=Ke(function(t,i){var o=Tr(i);return Rt(o)&&(o=r),Rt(t)?Vn(t,Wt(i,1,Rt,!0),r,o):[]});function l1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Le(i),Nr(t,i<0?0:i,u)):[]}function f1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Le(i),i=u-i,Nr(t,0,i<0?0:i)):[]}function d1(t,i){return t&&t.length?uo(t,me(i,3),!0,!0):[]}function p1(t,i){return t&&t.length?uo(t,me(i,3),!0):[]}function g1(t,i,o,u){var d=t==null?0:t.length;return d?(o&&typeof o!="number"&&nr(t,i,o)&&(o=0,u=d),a0(t,i,o,u)):[]}function Gh(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=o==null?0:Le(o);return d<0&&(d=Kt(u+d,0)),Bs(t,me(i,3),d)}function Wh(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=u-1;return o!==r&&(d=Le(o),d=o<0?Kt(u+d,0):Xt(d,u-1)),Bs(t,me(i,3),d,!0)}function Jh(t){var i=t==null?0:t.length;return i?Wt(t,1):[]}function v1(t){var i=t==null?0:t.length;return i?Wt(t,te):[]}function y1(t,i){var o=t==null?0:t.length;return o?(i=i===r?1:Le(i),Wt(t,i)):[]}function _1(t){for(var i=-1,o=t==null?0:t.length,u={};++i<o;){var d=t[i];u[d[0]]=d[1]}return u}function Yh(t){return t&&t.length?t[0]:r}function m1(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=o==null?0:Le(o);return d<0&&(d=Kt(u+d,0)),dn(t,i,d)}function b1(t){var i=t==null?0:t.length;return i?Nr(t,0,-1):[]}var w1=Ke(function(t){var i=_t(t,ka);return i.length&&i[0]===t[0]?$a(i):[]}),E1=Ke(function(t){var i=Tr(t),o=_t(t,ka);return i===Tr(o)?i=r:o.pop(),o.length&&o[0]===t[0]?$a(o,me(i,2)):[]}),D1=Ke(function(t){var i=Tr(t),o=_t(t,ka);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===t[0]?$a(o,r,i):[]});function S1(t,i){return t==null?"":bg.call(t,i)}function Tr(t){var i=t==null?0:t.length;return i?t[i-1]:r}function I1(t,i,o){var u=t==null?0:t.length;if(!u)return-1;var d=u;return o!==r&&(d=Le(o),d=d<0?Kt(u+d,0):Xt(d,u-1)),i===i?ng(t,i,d):Bs(t,Pu,d,!0)}function x1(t,i){return t&&t.length?ah(t,Le(i)):r}var O1=Ke(Xh);function Xh(t,i){return t&&t.length&&i&&i.length?ja(t,i):t}function C1(t,i,o){return t&&t.length&&i&&i.length?ja(t,i,me(o,2)):t}function A1(t,i,o){return t&&t.length&&i&&i.length?ja(t,i,r,o):t}var P1=hi(function(t,i){var o=t==null?0:t.length,u=Ra(t,i);return hh(t,_t(i,function(d){return li(d,o)?+d:d}).sort(bh)),u});function R1(t,i){var o=[];if(!(t&&t.length))return o;var u=-1,d=[],y=t.length;for(i=me(i,3);++u<y;){var E=t[u];i(E,u,t)&&(o.push(E),d.push(u))}return hh(t,d),o}function sc(t){return t==null?t:Sg.call(t)}function N1(t,i,o){var u=t==null?0:t.length;return u?(o&&typeof o!="number"&&nr(t,i,o)?(i=0,o=u):(i=i==null?0:Le(i),o=o===r?u:Le(o)),Nr(t,i,o)):[]}function T1(t,i){return co(t,i)}function F1(t,i,o){return Ba(t,i,me(o,2))}function $1(t,i){var o=t==null?0:t.length;if(o){var u=co(t,i);if(u<o&&Kr(t[u],i))return u}return-1}function U1(t,i){return co(t,i,!0)}function M1(t,i,o){return Ba(t,i,me(o,2),!0)}function L1(t,i){var o=t==null?0:t.length;if(o){var u=co(t,i,!0)-1;if(Kr(t[u],i))return u}return-1}function j1(t){return t&&t.length?fh(t):[]}function q1(t,i){return t&&t.length?fh(t,me(i,2)):[]}function z1(t){var i=t==null?0:t.length;return i?Nr(t,1,i):[]}function B1(t,i,o){return t&&t.length?(i=o||i===r?1:Le(i),Nr(t,0,i<0?0:i)):[]}function H1(t,i,o){var u=t==null?0:t.length;return u?(i=o||i===r?1:Le(i),i=u-i,Nr(t,i<0?0:i,u)):[]}function K1(t,i){return t&&t.length?uo(t,me(i,3),!1,!0):[]}function k1(t,i){return t&&t.length?uo(t,me(i,3)):[]}var V1=Ke(function(t){return Si(Wt(t,1,Rt,!0))}),G1=Ke(function(t){var i=Tr(t);return Rt(i)&&(i=r),Si(Wt(t,1,Rt,!0),me(i,2))}),W1=Ke(function(t){var i=Tr(t);return i=typeof i=="function"?i:r,Si(Wt(t,1,Rt,!0),r,i)});function J1(t){return t&&t.length?Si(t):[]}function Y1(t,i){return t&&t.length?Si(t,me(i,2)):[]}function X1(t,i){return i=typeof i=="function"?i:r,t&&t.length?Si(t,r,i):[]}function oc(t){if(!(t&&t.length))return[];var i=0;return t=mi(t,function(o){if(Rt(o))return i=Kt(o.length,i),!0}),Da(i,function(o){return _t(t,ba(o))})}function Qh(t,i){if(!(t&&t.length))return[];var o=oc(t);return i==null?o:_t(o,function(u){return kt(i,r,u)})}var Q1=Ke(function(t,i){return Rt(t)?Vn(t,i):[]}),Z1=Ke(function(t){return Ka(mi(t,Rt))}),ev=Ke(function(t){var i=Tr(t);return Rt(i)&&(i=r),Ka(mi(t,Rt),me(i,2))}),tv=Ke(function(t){var i=Tr(t);return i=typeof i=="function"?i:r,Ka(mi(t,Rt),r,i)}),rv=Ke(oc);function iv(t,i){return vh(t||[],i||[],kn)}function nv(t,i){return vh(t||[],i||[],Jn)}var sv=Ke(function(t){var i=t.length,o=i>1?t[i-1]:r;return o=typeof o=="function"?(t.pop(),o):r,Qh(t,o)});function Zh(t){var i=v(t);return i.__chain__=!0,i}function ov(t,i){return i(t),t}function mo(t,i){return i(t)}var av=hi(function(t){var i=t.length,o=i?t[0]:0,u=this.__wrapped__,d=function(y){return Ra(y,t)};return i>1||this.__actions__.length||!(u instanceof Je)||!li(o)?this.thru(d):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:mo,args:[d],thisArg:r}),new Pr(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function cv(){return Zh(this)}function uv(){return new Pr(this.value(),this.__chain__)}function hv(){this.__values__===r&&(this.__values__=dl(this.value()));var t=this.__index__>=this.__values__.length,i=t?r:this.__values__[this.__index__++];return{done:t,value:i}}function lv(){return this}function fv(t){for(var i,o=this;o instanceof io;){var u=Vh(o);u.__index__=0,u.__values__=r,i?d.__wrapped__=u:i=u;var d=u;o=o.__wrapped__}return d.__wrapped__=t,i}function dv(){var t=this.__wrapped__;if(t instanceof Je){var i=t;return this.__actions__.length&&(i=new Je(this)),i=i.reverse(),i.__actions__.push({func:mo,args:[sc],thisArg:r}),new Pr(i,this.__chain__)}return this.thru(sc)}function pv(){return gh(this.__wrapped__,this.__actions__)}var gv=ho(function(t,i,o){nt.call(t,o)?++t[o]:ci(t,o,1)});function vv(t,i,o){var u=Ne(t)?Cu:o0;return o&&nr(t,i,o)&&(i=r),u(t,me(i,3))}function yv(t,i){var o=Ne(t)?mi:Qu;return o(t,me(i,3))}var _v=xh(Gh),mv=xh(Wh);function bv(t,i){return Wt(bo(t,i),1)}function wv(t,i){return Wt(bo(t,i),te)}function Ev(t,i,o){return o=o===r?1:Le(o),Wt(bo(t,i),o)}function el(t,i){var o=Ne(t)?Cr:Di;return o(t,me(i,3))}function tl(t,i){var o=Ne(t)?zp:Xu;return o(t,me(i,3))}var Dv=ho(function(t,i,o){nt.call(t,o)?t[o].push(i):ci(t,o,[i])});function Sv(t,i,o,u){t=dr(t)?t:In(t),o=o&&!u?Le(o):0;var d=t.length;return o<0&&(o=Kt(d+o,0)),Io(t)?o<=d&&t.indexOf(i,o)>-1:!!d&&dn(t,i,o)>-1}var Iv=Ke(function(t,i,o){var u=-1,d=typeof i=="function",y=dr(t)?B(t.length):[];return Di(t,function(E){y[++u]=d?kt(i,E,o):Gn(E,i,o)}),y}),xv=ho(function(t,i,o){ci(t,o,i)});function bo(t,i){var o=Ne(t)?_t:nh;return o(t,me(i,3))}function Ov(t,i,o,u){return t==null?[]:(Ne(i)||(i=i==null?[]:[i]),o=u?r:o,Ne(o)||(o=o==null?[]:[o]),ch(t,i,o))}var Cv=ho(function(t,i,o){t[o?0:1].push(i)},function(){return[[],[]]});function Av(t,i,o){var u=Ne(t)?_a:Nu,d=arguments.length<3;return u(t,me(i,4),o,d,Di)}function Pv(t,i,o){var u=Ne(t)?Bp:Nu,d=arguments.length<3;return u(t,me(i,4),o,d,Xu)}function Rv(t,i){var o=Ne(t)?mi:Qu;return o(t,Do(me(i,3)))}function Nv(t){var i=Ne(t)?Gu:S0;return i(t)}function Tv(t,i,o){(o?nr(t,i,o):i===r)?i=1:i=Le(i);var u=Ne(t)?t0:I0;return u(t,i)}function Fv(t){var i=Ne(t)?r0:O0;return i(t)}function $v(t){if(t==null)return 0;if(dr(t))return Io(t)?gn(t):t.length;var i=Qt(t);return i==Se||i==Ie?t.size:Ma(t).length}function Uv(t,i,o){var u=Ne(t)?ma:C0;return o&&nr(t,i,o)&&(i=r),u(t,me(i,3))}var Mv=Ke(function(t,i){if(t==null)return[];var o=i.length;return o>1&&nr(t,i[0],i[1])?i=[]:o>2&&nr(i[0],i[1],i[2])&&(i=[i[0]]),ch(t,Wt(i,1),[])}),wo=yg||function(){return Xe.Date.now()};function Lv(t,i){if(typeof i!="function")throw new Ar(p);return t=Le(t),function(){if(--t<1)return i.apply(this,arguments)}}function rl(t,i,o){return i=o?r:i,i=t&&i==null?t.length:i,ui(t,c,r,r,r,r,i)}function il(t,i){var o;if(typeof i!="function")throw new Ar(p);return t=Le(t),function(){return--t>0&&(o=i.apply(this,arguments)),t<=1&&(i=r),o}}var ac=Ke(function(t,i,o){var u=K;if(o.length){var d=wi(o,Dn(ac));u|=x}return ui(t,u,i,o,d)}),nl=Ke(function(t,i,o){var u=K|ie;if(o.length){var d=wi(o,Dn(nl));u|=x}return ui(i,u,t,o,d)});function sl(t,i,o){i=o?r:i;var u=ui(t,$,r,r,r,r,r,i);return u.placeholder=sl.placeholder,u}function ol(t,i,o){i=o?r:i;var u=ui(t,D,r,r,r,r,r,i);return u.placeholder=ol.placeholder,u}function al(t,i,o){var u,d,y,E,O,U,Y=0,X=!1,Z=!1,ae=!0;if(typeof t!="function")throw new Ar(p);i=Fr(i)||0,bt(o)&&(X=!!o.leading,Z="maxWait"in o,y=Z?Kt(Fr(o.maxWait)||0,i):y,ae="trailing"in o?!!o.trailing:ae);function ve(Nt){var kr=u,pi=d;return u=d=r,Y=Nt,E=t.apply(pi,kr),E}function we(Nt){return Y=Nt,O=Qn(Ge,i),X?ve(Nt):E}function ze(Nt){var kr=Nt-U,pi=Nt-Y,xl=i-kr;return Z?Xt(xl,y-pi):xl}function Ee(Nt){var kr=Nt-U,pi=Nt-Y;return U===r||kr>=i||kr<0||Z&&pi>=y}function Ge(){var Nt=wo();if(Ee(Nt))return Qe(Nt);O=Qn(Ge,ze(Nt))}function Qe(Nt){return O=r,ae&&u?ve(Nt):(u=d=r,E)}function Er(){O!==r&&yh(O),Y=0,u=U=d=O=r}function sr(){return O===r?E:Qe(wo())}function Dr(){var Nt=wo(),kr=Ee(Nt);if(u=arguments,d=this,U=Nt,kr){if(O===r)return we(U);if(Z)return yh(O),O=Qn(Ge,i),ve(U)}return O===r&&(O=Qn(Ge,i)),E}return Dr.cancel=Er,Dr.flush=sr,Dr}var jv=Ke(function(t,i){return Yu(t,1,i)}),qv=Ke(function(t,i,o){return Yu(t,Fr(i)||0,o)});function zv(t){return ui(t,k)}function Eo(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new Ar(p);var o=function(){var u=arguments,d=i?i.apply(this,u):u[0],y=o.cache;if(y.has(d))return y.get(d);var E=t.apply(this,u);return o.cache=y.set(d,E)||y,E};return o.cache=new(Eo.Cache||ai),o}Eo.Cache=ai;function Do(t){if(typeof t!="function")throw new Ar(p);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function Bv(t){return il(2,t)}var Hv=A0(function(t,i){i=i.length==1&&Ne(i[0])?_t(i[0],mr(me())):_t(Wt(i,1),mr(me()));var o=i.length;return Ke(function(u){for(var d=-1,y=Xt(u.length,o);++d<y;)u[d]=i[d].call(this,u[d]);return kt(t,this,u)})}),cc=Ke(function(t,i){var o=wi(i,Dn(cc));return ui(t,x,r,i,o)}),cl=Ke(function(t,i){var o=wi(i,Dn(cl));return ui(t,m,r,i,o)}),Kv=hi(function(t,i){return ui(t,_,r,r,r,i)});function kv(t,i){if(typeof t!="function")throw new Ar(p);return i=i===r?i:Le(i),Ke(t,i)}function Vv(t,i){if(typeof t!="function")throw new Ar(p);return i=i==null?0:Kt(Le(i),0),Ke(function(o){var u=o[i],d=xi(o,0,i);return u&&bi(d,u),kt(t,this,d)})}function Gv(t,i,o){var u=!0,d=!0;if(typeof t!="function")throw new Ar(p);return bt(o)&&(u="leading"in o?!!o.leading:u,d="trailing"in o?!!o.trailing:d),al(t,i,{leading:u,maxWait:i,trailing:d})}function Wv(t){return rl(t,1)}function Jv(t,i){return cc(Va(i),t)}function Yv(){if(!arguments.length)return[];var t=arguments[0];return Ne(t)?t:[t]}function Xv(t){return Rr(t,P)}function Qv(t,i){return i=typeof i=="function"?i:r,Rr(t,P,i)}function Zv(t){return Rr(t,T|P)}function ey(t,i){return i=typeof i=="function"?i:r,Rr(t,T|P,i)}function ty(t,i){return i==null||Ju(t,i,Vt(i))}function Kr(t,i){return t===i||t!==t&&i!==i}var ry=go(Fa),iy=go(function(t,i){return t>=i}),Ji=th(function(){return arguments}())?th:function(t){return Ot(t)&&nt.call(t,"callee")&&!zu.call(t,"callee")},Ne=B.isArray,ny=rr?mr(rr):f0;function dr(t){return t!=null&&So(t.length)&&!fi(t)}function Rt(t){return Ot(t)&&dr(t)}function sy(t){return t===!0||t===!1||Ot(t)&&ir(t)==L}var Oi=mg||mc,oy=zr?mr(zr):d0;function ay(t){return Ot(t)&&t.nodeType===1&&!Zn(t)}function cy(t){if(t==null)return!0;if(dr(t)&&(Ne(t)||typeof t=="string"||typeof t.splice=="function"||Oi(t)||Sn(t)||Ji(t)))return!t.length;var i=Qt(t);if(i==Se||i==Ie)return!t.size;if(Xn(t))return!Ma(t).length;for(var o in t)if(nt.call(t,o))return!1;return!0}function uy(t,i){return Wn(t,i)}function hy(t,i,o){o=typeof o=="function"?o:r;var u=o?o(t,i):r;return u===r?Wn(t,i,r,o):!!u}function uc(t){if(!Ot(t))return!1;var i=ir(t);return i==I||i==h||typeof t.message=="string"&&typeof t.name=="string"&&!Zn(t)}function ly(t){return typeof t=="number"&&Hu(t)}function fi(t){if(!bt(t))return!1;var i=ir(t);return i==se||i==fe||i==q||i==gt}function ul(t){return typeof t=="number"&&t==Le(t)}function So(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=W}function bt(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function Ot(t){return t!=null&&typeof t=="object"}var hl=Or?mr(Or):g0;function fy(t,i){return t===i||Ua(t,i,Za(i))}function dy(t,i,o){return o=typeof o=="function"?o:r,Ua(t,i,Za(i),o)}function py(t){return ll(t)&&t!=+t}function gy(t){if(Q0(t))throw new Pe(l);return rh(t)}function vy(t){return t===null}function yy(t){return t==null}function ll(t){return typeof t=="number"||Ot(t)&&ir(t)==Be}function Zn(t){if(!Ot(t)||ir(t)!=Me)return!1;var i=Ys(t);if(i===null)return!0;var o=nt.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Vs.call(o)==dg}var hc=Jr?mr(Jr):v0;function _y(t){return ul(t)&&t>=-W&&t<=W}var fl=Ln?mr(Ln):y0;function Io(t){return typeof t=="string"||!Ne(t)&&Ot(t)&&ir(t)==Te}function wr(t){return typeof t=="symbol"||Ot(t)&&ir(t)==Fe}var Sn=zi?mr(zi):_0;function my(t){return t===r}function by(t){return Ot(t)&&Qt(t)==Ce}function wy(t){return Ot(t)&&ir(t)==$e}var Ey=go(La),Dy=go(function(t,i){return t<=i});function dl(t){if(!t)return[];if(dr(t))return Io(t)?Br(t):fr(t);if(qn&&t[qn])return tg(t[qn]());var i=Qt(t),o=i==Se?Ia:i==Ie?Hs:In;return o(t)}function di(t){if(!t)return t===0?t:0;if(t=Fr(t),t===te||t===-te){var i=t<0?-1:1;return i*ee}return t===t?t:0}function Le(t){var i=di(t),o=i%1;return i===i?o?i-o:i:0}function pl(t){return t?ki(Le(t),0,re):0}function Fr(t){if(typeof t=="number")return t;if(wr(t))return J;if(bt(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=bt(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=Tu(t);var o=ea.test(t);return o||ra.test(t)?Re(t.slice(2),o?2:8):Zo.test(t)?J:+t}function gl(t){return Xr(t,pr(t))}function Sy(t){return t?ki(Le(t),-W,W):t===0?t:0}function it(t){return t==null?"":br(t)}var Iy=wn(function(t,i){if(Xn(i)||dr(i)){Xr(i,Vt(i),t);return}for(var o in i)nt.call(i,o)&&kn(t,o,i[o])}),vl=wn(function(t,i){Xr(i,pr(i),t)}),xo=wn(function(t,i,o,u){Xr(i,pr(i),t,u)}),xy=wn(function(t,i,o,u){Xr(i,Vt(i),t,u)}),Oy=hi(Ra);function Cy(t,i){var o=bn(t);return i==null?o:Wu(o,i)}var Ay=Ke(function(t,i){t=ut(t);var o=-1,u=i.length,d=u>2?i[2]:r;for(d&&nr(i[0],i[1],d)&&(u=1);++o<u;)for(var y=i[o],E=pr(y),O=-1,U=E.length;++O<U;){var Y=E[O],X=t[Y];(X===r||Kr(X,yn[Y])&&!nt.call(t,Y))&&(t[Y]=y[Y])}return t}),Py=Ke(function(t){return t.push(r,Th),kt(yl,r,t)});function Ry(t,i){return Au(t,me(i,3),Yr)}function Ny(t,i){return Au(t,me(i,3),Ta)}function Ty(t,i){return t==null?t:Na(t,me(i,3),pr)}function Fy(t,i){return t==null?t:Zu(t,me(i,3),pr)}function $y(t,i){return t&&Yr(t,me(i,3))}function Uy(t,i){return t&&Ta(t,me(i,3))}function My(t){return t==null?[]:oo(t,Vt(t))}function Ly(t){return t==null?[]:oo(t,pr(t))}function lc(t,i,o){var u=t==null?r:Vi(t,i);return u===r?o:u}function jy(t,i){return t!=null&&Uh(t,i,c0)}function fc(t,i){return t!=null&&Uh(t,i,u0)}var qy=Ch(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=Gs.call(i)),t[i]=o},pc(gr)),zy=Ch(function(t,i,o){i!=null&&typeof i.toString!="function"&&(i=Gs.call(i)),nt.call(t,i)?t[i].push(o):t[i]=[o]},me),By=Ke(Gn);function Vt(t){return dr(t)?Vu(t):Ma(t)}function pr(t){return dr(t)?Vu(t,!0):m0(t)}function Hy(t,i){var o={};return i=me(i,3),Yr(t,function(u,d,y){ci(o,i(u,d,y),u)}),o}function Ky(t,i){var o={};return i=me(i,3),Yr(t,function(u,d,y){ci(o,d,i(u,d,y))}),o}var ky=wn(function(t,i,o){ao(t,i,o)}),yl=wn(function(t,i,o,u){ao(t,i,o,u)}),Vy=hi(function(t,i){var o={};if(t==null)return o;var u=!1;i=_t(i,function(y){return y=Ii(y,t),u||(u=y.length>1),y}),Xr(t,Xa(t),o),u&&(o=Rr(o,T|j|P,q0));for(var d=i.length;d--;)Ha(o,i[d]);return o});function Gy(t,i){return _l(t,Do(me(i)))}var Wy=hi(function(t,i){return t==null?{}:w0(t,i)});function _l(t,i){if(t==null)return{};var o=_t(Xa(t),function(u){return[u]});return i=me(i),uh(t,o,function(u,d){return i(u,d[0])})}function Jy(t,i,o){i=Ii(i,t);var u=-1,d=i.length;for(d||(d=1,t=r);++u<d;){var y=t==null?r:t[Qr(i[u])];y===r&&(u=d,y=o),t=fi(y)?y.call(t):y}return t}function Yy(t,i,o){return t==null?t:Jn(t,i,o)}function Xy(t,i,o,u){return u=typeof u=="function"?u:r,t==null?t:Jn(t,i,o,u)}var ml=Rh(Vt),bl=Rh(pr);function Qy(t,i,o){var u=Ne(t),d=u||Oi(t)||Sn(t);if(i=me(i,4),o==null){var y=t&&t.constructor;d?o=u?new y:[]:bt(t)?o=fi(y)?bn(Ys(t)):{}:o={}}return(d?Cr:Yr)(t,function(E,O,U){return i(o,E,O,U)}),o}function Zy(t,i){return t==null?!0:Ha(t,i)}function e_(t,i,o){return t==null?t:ph(t,i,Va(o))}function t_(t,i,o,u){return u=typeof u=="function"?u:r,t==null?t:ph(t,i,Va(o),u)}function In(t){return t==null?[]:Sa(t,Vt(t))}function r_(t){return t==null?[]:Sa(t,pr(t))}function i_(t,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Fr(o),o=o===o?o:0),i!==r&&(i=Fr(i),i=i===i?i:0),ki(Fr(t),i,o)}function n_(t,i,o){return i=di(i),o===r?(o=i,i=0):o=di(o),t=Fr(t),h0(t,i,o)}function s_(t,i,o){if(o&&typeof o!="boolean"&&nr(t,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof t=="boolean"&&(o=t,t=r)),t===r&&i===r?(t=0,i=1):(t=di(t),i===r?(i=t,t=0):i=di(i)),t>i){var u=t;t=i,i=u}if(o||t%1||i%1){var d=Ku();return Xt(t+d*(i-t+at("1e-"+((d+"").length-1))),i)}return qa(t,i)}var o_=En(function(t,i,o){return i=i.toLowerCase(),t+(o?wl(i):i)});function wl(t){return dc(it(t).toLowerCase())}function El(t){return t=it(t),t&&t.replace(ni,Yp).replace(ga,"")}function a_(t,i,o){t=it(t),i=br(i);var u=t.length;o=o===r?u:ki(Le(o),0,u);var d=o;return o-=i.length,o>=0&&t.slice(o,d)==i}function c_(t){return t=it(t),t&&vt.test(t)?t.replace(Ui,Xp):t}function u_(t){return t=it(t),t&&Mt.test(t)?t.replace(St,"\\$&"):t}var h_=En(function(t,i,o){return t+(o?"-":"")+i.toLowerCase()}),l_=En(function(t,i,o){return t+(o?" ":"")+i.toLowerCase()}),f_=Ih("toLowerCase");function d_(t,i,o){t=it(t),i=Le(i);var u=i?gn(t):0;if(!i||u>=i)return t;var d=(i-u)/2;return po(eo(d),o)+t+po(Zs(d),o)}function p_(t,i,o){t=it(t),i=Le(i);var u=i?gn(t):0;return i&&u<i?t+po(i-u,o):t}function g_(t,i,o){t=it(t),i=Le(i);var u=i?gn(t):0;return i&&u<i?po(i-u,o)+t:t}function v_(t,i,o){return o||i==null?i=0:i&&(i=+i),Dg(it(t).replace(It,""),i||0)}function y_(t,i,o){return(o?nr(t,i,o):i===r)?i=1:i=Le(i),za(it(t),i)}function __(){var t=arguments,i=it(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var m_=En(function(t,i,o){return t+(o?"_":"")+i.toLowerCase()});function b_(t,i,o){return o&&typeof o!="number"&&nr(t,i,o)&&(i=o=r),o=o===r?re:o>>>0,o?(t=it(t),t&&(typeof i=="string"||i!=null&&!hc(i))&&(i=br(i),!i&&pn(t))?xi(Br(t),0,o):t.split(i,o)):[]}var w_=En(function(t,i,o){return t+(o?" ":"")+dc(i)});function E_(t,i,o){return t=it(t),o=o==null?0:ki(Le(o),0,t.length),i=br(i),t.slice(o,o+i.length)==i}function D_(t,i,o){var u=v.templateSettings;o&&nr(t,i,o)&&(i=r),t=it(t),i=xo({},i,u,Nh);var d=xo({},i.imports,u.imports,Nh),y=Vt(d),E=Sa(d,y),O,U,Y=0,X=i.interpolate||on,Z="__p += '",ae=xa((i.escape||on).source+"|"+X.source+"|"+(X===mt?Qo:on).source+"|"+(i.evaluate||on).source+"|$","g"),ve="//# sourceURL="+(nt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++va+"]")+`
`;t.replace(ae,function(Ee,Ge,Qe,Er,sr,Dr){return Qe||(Qe=Er),Z+=t.slice(Y,Dr).replace(na,Qp),Ge&&(O=!0,Z+=`' +
__e(`+Ge+`) +
'`),sr&&(U=!0,Z+=`';
`+sr+`;
__p += '`),Qe&&(Z+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),Y=Dr+Ee.length,Ee}),Z+=`';
`;var we=nt.call(i,"variable")&&i.variable;if(!we)Z=`with (obj) {
`+Z+`
}
`;else if(Yo.test(we))throw new Pe(f);Z=(U?Z.replace(Gr,""):Z).replace(tr,"$1").replace(ii,"$1;"),Z="function("+(we||"obj")+`) {
`+(we?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(U?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var ze=Sl(function(){return rt(y,ve+"return "+Z).apply(r,E)});if(ze.source=Z,uc(ze))throw ze;return ze}function S_(t){return it(t).toLowerCase()}function I_(t){return it(t).toUpperCase()}function x_(t,i,o){if(t=it(t),t&&(o||i===r))return Tu(t);if(!t||!(i=br(i)))return t;var u=Br(t),d=Br(i),y=Fu(u,d),E=$u(u,d)+1;return xi(u,y,E).join("")}function O_(t,i,o){if(t=it(t),t&&(o||i===r))return t.slice(0,Mu(t)+1);if(!t||!(i=br(i)))return t;var u=Br(t),d=$u(u,Br(i))+1;return xi(u,0,d).join("")}function C_(t,i,o){if(t=it(t),t&&(o||i===r))return t.replace(It,"");if(!t||!(i=br(i)))return t;var u=Br(t),d=Fu(u,Br(i));return xi(u,d).join("")}function A_(t,i){var o=G,u=oe;if(bt(i)){var d="separator"in i?i.separator:d;o="length"in i?Le(i.length):o,u="omission"in i?br(i.omission):u}t=it(t);var y=t.length;if(pn(t)){var E=Br(t);y=E.length}if(o>=y)return t;var O=o-gn(u);if(O<1)return u;var U=E?xi(E,0,O).join(""):t.slice(0,O);if(d===r)return U+u;if(E&&(O+=U.length-O),hc(d)){if(t.slice(O).search(d)){var Y,X=U;for(d.global||(d=xa(d.source,it(xr.exec(d))+"g")),d.lastIndex=0;Y=d.exec(X);)var Z=Y.index;U=U.slice(0,Z===r?O:Z)}}else if(t.indexOf(br(d),O)!=O){var ae=U.lastIndexOf(d);ae>-1&&(U=U.slice(0,ae))}return U+u}function P_(t){return t=it(t),t&&wt.test(t)?t.replace(yi,sg):t}var R_=En(function(t,i,o){return t+(o?" ":"")+i.toUpperCase()}),dc=Ih("toUpperCase");function Dl(t,i,o){return t=it(t),i=o?r:i,i===r?eg(t)?cg(t):kp(t):t.match(i)||[]}var Sl=Ke(function(t,i){try{return kt(t,r,i)}catch(o){return uc(o)?o:new Pe(o)}}),N_=hi(function(t,i){return Cr(i,function(o){o=Qr(o),ci(t,o,ac(t[o],t))}),t});function T_(t){var i=t==null?0:t.length,o=me();return t=i?_t(t,function(u){if(typeof u[1]!="function")throw new Ar(p);return[o(u[0]),u[1]]}):[],Ke(function(u){for(var d=-1;++d<i;){var y=t[d];if(kt(y[0],this,u))return kt(y[1],this,u)}})}function F_(t){return s0(Rr(t,T))}function pc(t){return function(){return t}}function $_(t,i){return t==null||t!==t?i:t}var U_=Oh(),M_=Oh(!0);function gr(t){return t}function gc(t){return ih(typeof t=="function"?t:Rr(t,T))}function L_(t){return sh(Rr(t,T))}function j_(t,i){return oh(t,Rr(i,T))}var q_=Ke(function(t,i){return function(o){return Gn(o,t,i)}}),z_=Ke(function(t,i){return function(o){return Gn(t,o,i)}});function vc(t,i,o){var u=Vt(i),d=oo(i,u);o==null&&!(bt(i)&&(d.length||!u.length))&&(o=i,i=t,t=this,d=oo(i,Vt(i)));var y=!(bt(o)&&"chain"in o)||!!o.chain,E=fi(t);return Cr(d,function(O){var U=i[O];t[O]=U,E&&(t.prototype[O]=function(){var Y=this.__chain__;if(y||Y){var X=t(this.__wrapped__),Z=X.__actions__=fr(this.__actions__);return Z.push({func:U,args:arguments,thisArg:t}),X.__chain__=Y,X}return U.apply(t,bi([this.value()],arguments))})}),t}function B_(){return Xe._===this&&(Xe._=pg),this}function yc(){}function H_(t){return t=Le(t),Ke(function(i){return ah(i,t)})}var K_=Wa(_t),k_=Wa(Cu),V_=Wa(ma);function Il(t){return tc(t)?ba(Qr(t)):E0(t)}function G_(t){return function(i){return t==null?r:Vi(t,i)}}var W_=Ah(),J_=Ah(!0);function _c(){return[]}function mc(){return!1}function Y_(){return{}}function X_(){return""}function Q_(){return!0}function Z_(t,i){if(t=Le(t),t<1||t>W)return[];var o=re,u=Xt(t,re);i=me(i),t-=re;for(var d=Da(u,i);++o<t;)i(o);return d}function em(t){return Ne(t)?_t(t,Qr):wr(t)?[t]:fr(kh(it(t)))}function tm(t){var i=++fg;return it(t)+i}var rm=fo(function(t,i){return t+i},0),im=Ja("ceil"),nm=fo(function(t,i){return t/i},1),sm=Ja("floor");function om(t){return t&&t.length?so(t,gr,Fa):r}function am(t,i){return t&&t.length?so(t,me(i,2),Fa):r}function cm(t){return Ru(t,gr)}function um(t,i){return Ru(t,me(i,2))}function hm(t){return t&&t.length?so(t,gr,La):r}function lm(t,i){return t&&t.length?so(t,me(i,2),La):r}var fm=fo(function(t,i){return t*i},1),dm=Ja("round"),pm=fo(function(t,i){return t-i},0);function gm(t){return t&&t.length?Ea(t,gr):0}function vm(t,i){return t&&t.length?Ea(t,me(i,2)):0}return v.after=Lv,v.ary=rl,v.assign=Iy,v.assignIn=vl,v.assignInWith=xo,v.assignWith=xy,v.at=Oy,v.before=il,v.bind=ac,v.bindAll=N_,v.bindKey=nl,v.castArray=Yv,v.chain=Zh,v.chunk=s1,v.compact=o1,v.concat=a1,v.cond=T_,v.conforms=F_,v.constant=pc,v.countBy=gv,v.create=Cy,v.curry=sl,v.curryRight=ol,v.debounce=al,v.defaults=Ay,v.defaultsDeep=Py,v.defer=jv,v.delay=qv,v.difference=c1,v.differenceBy=u1,v.differenceWith=h1,v.drop=l1,v.dropRight=f1,v.dropRightWhile=d1,v.dropWhile=p1,v.fill=g1,v.filter=yv,v.flatMap=bv,v.flatMapDeep=wv,v.flatMapDepth=Ev,v.flatten=Jh,v.flattenDeep=v1,v.flattenDepth=y1,v.flip=zv,v.flow=U_,v.flowRight=M_,v.fromPairs=_1,v.functions=My,v.functionsIn=Ly,v.groupBy=Dv,v.initial=b1,v.intersection=w1,v.intersectionBy=E1,v.intersectionWith=D1,v.invert=qy,v.invertBy=zy,v.invokeMap=Iv,v.iteratee=gc,v.keyBy=xv,v.keys=Vt,v.keysIn=pr,v.map=bo,v.mapKeys=Hy,v.mapValues=Ky,v.matches=L_,v.matchesProperty=j_,v.memoize=Eo,v.merge=ky,v.mergeWith=yl,v.method=q_,v.methodOf=z_,v.mixin=vc,v.negate=Do,v.nthArg=H_,v.omit=Vy,v.omitBy=Gy,v.once=Bv,v.orderBy=Ov,v.over=K_,v.overArgs=Hv,v.overEvery=k_,v.overSome=V_,v.partial=cc,v.partialRight=cl,v.partition=Cv,v.pick=Wy,v.pickBy=_l,v.property=Il,v.propertyOf=G_,v.pull=O1,v.pullAll=Xh,v.pullAllBy=C1,v.pullAllWith=A1,v.pullAt=P1,v.range=W_,v.rangeRight=J_,v.rearg=Kv,v.reject=Rv,v.remove=R1,v.rest=kv,v.reverse=sc,v.sampleSize=Tv,v.set=Yy,v.setWith=Xy,v.shuffle=Fv,v.slice=N1,v.sortBy=Mv,v.sortedUniq=j1,v.sortedUniqBy=q1,v.split=b_,v.spread=Vv,v.tail=z1,v.take=B1,v.takeRight=H1,v.takeRightWhile=K1,v.takeWhile=k1,v.tap=ov,v.throttle=Gv,v.thru=mo,v.toArray=dl,v.toPairs=ml,v.toPairsIn=bl,v.toPath=em,v.toPlainObject=gl,v.transform=Qy,v.unary=Wv,v.union=V1,v.unionBy=G1,v.unionWith=W1,v.uniq=J1,v.uniqBy=Y1,v.uniqWith=X1,v.unset=Zy,v.unzip=oc,v.unzipWith=Qh,v.update=e_,v.updateWith=t_,v.values=In,v.valuesIn=r_,v.without=Q1,v.words=Dl,v.wrap=Jv,v.xor=Z1,v.xorBy=ev,v.xorWith=tv,v.zip=rv,v.zipObject=iv,v.zipObjectDeep=nv,v.zipWith=sv,v.entries=ml,v.entriesIn=bl,v.extend=vl,v.extendWith=xo,vc(v,v),v.add=rm,v.attempt=Sl,v.camelCase=o_,v.capitalize=wl,v.ceil=im,v.clamp=i_,v.clone=Xv,v.cloneDeep=Zv,v.cloneDeepWith=ey,v.cloneWith=Qv,v.conformsTo=ty,v.deburr=El,v.defaultTo=$_,v.divide=nm,v.endsWith=a_,v.eq=Kr,v.escape=c_,v.escapeRegExp=u_,v.every=vv,v.find=_v,v.findIndex=Gh,v.findKey=Ry,v.findLast=mv,v.findLastIndex=Wh,v.findLastKey=Ny,v.floor=sm,v.forEach=el,v.forEachRight=tl,v.forIn=Ty,v.forInRight=Fy,v.forOwn=$y,v.forOwnRight=Uy,v.get=lc,v.gt=ry,v.gte=iy,v.has=jy,v.hasIn=fc,v.head=Yh,v.identity=gr,v.includes=Sv,v.indexOf=m1,v.inRange=n_,v.invoke=By,v.isArguments=Ji,v.isArray=Ne,v.isArrayBuffer=ny,v.isArrayLike=dr,v.isArrayLikeObject=Rt,v.isBoolean=sy,v.isBuffer=Oi,v.isDate=oy,v.isElement=ay,v.isEmpty=cy,v.isEqual=uy,v.isEqualWith=hy,v.isError=uc,v.isFinite=ly,v.isFunction=fi,v.isInteger=ul,v.isLength=So,v.isMap=hl,v.isMatch=fy,v.isMatchWith=dy,v.isNaN=py,v.isNative=gy,v.isNil=yy,v.isNull=vy,v.isNumber=ll,v.isObject=bt,v.isObjectLike=Ot,v.isPlainObject=Zn,v.isRegExp=hc,v.isSafeInteger=_y,v.isSet=fl,v.isString=Io,v.isSymbol=wr,v.isTypedArray=Sn,v.isUndefined=my,v.isWeakMap=by,v.isWeakSet=wy,v.join=S1,v.kebabCase=h_,v.last=Tr,v.lastIndexOf=I1,v.lowerCase=l_,v.lowerFirst=f_,v.lt=Ey,v.lte=Dy,v.max=om,v.maxBy=am,v.mean=cm,v.meanBy=um,v.min=hm,v.minBy=lm,v.stubArray=_c,v.stubFalse=mc,v.stubObject=Y_,v.stubString=X_,v.stubTrue=Q_,v.multiply=fm,v.nth=x1,v.noConflict=B_,v.noop=yc,v.now=wo,v.pad=d_,v.padEnd=p_,v.padStart=g_,v.parseInt=v_,v.random=s_,v.reduce=Av,v.reduceRight=Pv,v.repeat=y_,v.replace=__,v.result=Jy,v.round=dm,v.runInContext=F,v.sample=Nv,v.size=$v,v.snakeCase=m_,v.some=Uv,v.sortedIndex=T1,v.sortedIndexBy=F1,v.sortedIndexOf=$1,v.sortedLastIndex=U1,v.sortedLastIndexBy=M1,v.sortedLastIndexOf=L1,v.startCase=w_,v.startsWith=E_,v.subtract=pm,v.sum=gm,v.sumBy=vm,v.template=D_,v.times=Z_,v.toFinite=di,v.toInteger=Le,v.toLength=pl,v.toLower=S_,v.toNumber=Fr,v.toSafeInteger=Sy,v.toString=it,v.toUpper=I_,v.trim=x_,v.trimEnd=O_,v.trimStart=C_,v.truncate=A_,v.unescape=P_,v.uniqueId=tm,v.upperCase=R_,v.upperFirst=dc,v.each=el,v.eachRight=tl,v.first=Yh,vc(v,function(){var t={};return Yr(v,function(i,o){nt.call(v.prototype,o)||(t[o]=i)}),t}(),{chain:!1}),v.VERSION=s,Cr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){v[t].placeholder=v}),Cr(["drop","take"],function(t,i){Je.prototype[t]=function(o){o=o===r?1:Kt(Le(o),0);var u=this.__filtered__&&!i?new Je(this):this.clone();return u.__filtered__?u.__takeCount__=Xt(o,u.__takeCount__):u.__views__.push({size:Xt(o,re),type:t+(u.__dir__<0?"Right":"")}),u},Je.prototype[t+"Right"]=function(o){return this.reverse()[t](o).reverse()}}),Cr(["filter","map","takeWhile"],function(t,i){var o=i+1,u=o==R||o==le;Je.prototype[t]=function(d){var y=this.clone();return y.__iteratees__.push({iteratee:me(d,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),Cr(["head","last"],function(t,i){var o="take"+(i?"Right":"");Je.prototype[t]=function(){return this[o](1).value()[0]}}),Cr(["initial","tail"],function(t,i){var o="drop"+(i?"":"Right");Je.prototype[t]=function(){return this.__filtered__?new Je(this):this[o](1)}}),Je.prototype.compact=function(){return this.filter(gr)},Je.prototype.find=function(t){return this.filter(t).head()},Je.prototype.findLast=function(t){return this.reverse().find(t)},Je.prototype.invokeMap=Ke(function(t,i){return typeof t=="function"?new Je(this):this.map(function(o){return Gn(o,t,i)})}),Je.prototype.reject=function(t){return this.filter(Do(me(t)))},Je.prototype.slice=function(t,i){t=Le(t);var o=this;return o.__filtered__&&(t>0||i<0)?new Je(o):(t<0?o=o.takeRight(-t):t&&(o=o.drop(t)),i!==r&&(i=Le(i),o=i<0?o.dropRight(-i):o.take(i-t)),o)},Je.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Je.prototype.toArray=function(){return this.take(re)},Yr(Je.prototype,function(t,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),d=v[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);d&&(v.prototype[i]=function(){var E=this.__wrapped__,O=u?[1]:arguments,U=E instanceof Je,Y=O[0],X=U||Ne(E),Z=function(Ge){var Qe=d.apply(v,bi([Ge],O));return u&&ae?Qe[0]:Qe};X&&o&&typeof Y=="function"&&Y.length!=1&&(U=X=!1);var ae=this.__chain__,ve=!!this.__actions__.length,we=y&&!ae,ze=U&&!ve;if(!y&&X){E=ze?E:new Je(this);var Ee=t.apply(E,O);return Ee.__actions__.push({func:mo,args:[Z],thisArg:r}),new Pr(Ee,ae)}return we&&ze?t.apply(this,O):(Ee=this.thru(Z),we?u?Ee.value()[0]:Ee.value():Ee)})}),Cr(["pop","push","shift","sort","splice","unshift"],function(t){var i=Ks[t],o=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",u=/^(?:pop|shift)$/.test(t);v.prototype[t]=function(){var d=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(Ne(y)?y:[],d)}return this[o](function(E){return i.apply(Ne(E)?E:[],d)})}}),Yr(Je.prototype,function(t,i){var o=v[i];if(o){var u=o.name+"";nt.call(mn,u)||(mn[u]=[]),mn[u].push({name:i,func:o})}}),mn[lo(r,ie).name]=[{name:"wrapper",func:r}],Je.prototype.clone=Pg,Je.prototype.reverse=Rg,Je.prototype.value=Ng,v.prototype.at=av,v.prototype.chain=cv,v.prototype.commit=uv,v.prototype.next=hv,v.prototype.plant=fv,v.prototype.reverse=dv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=pv,v.prototype.first=v.prototype.head,qn&&(v.prototype[qn]=lv),v},vn=ug();Pt?((Pt.exports=vn)._=vn,ct._=vn):Xe._=vn}).call(ls)})(eu,eu.exports);var q5=Object.defineProperty,z5=Object.defineProperties,B5=Object.getOwnPropertyDescriptors,id=Object.getOwnPropertySymbols,H5=Object.prototype.hasOwnProperty,K5=Object.prototype.propertyIsEnumerable,nd=(n,e,r)=>e in n?q5(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Co=(n,e)=>{for(var r in e||(e={}))H5.call(e,r)&&nd(n,r,e[r]);if(id)for(var r of id(e))K5.call(e,r)&&nd(n,r,e[r]);return n},k5=(n,e)=>z5(n,B5(e));function Mr(n,e,r){let s;const a=tu(n);return e.rpcMap&&(s=e.rpcMap[a]),s||(s=`${j5}?chainId=eip155:${a}&projectId=${r}`),s}function tu(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function Lp(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function V5(n,e){const r=Object.keys(e.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const l=e.namespaces[a].accounts;s.push(...l)}),s}function G5(n={},e={}){const r=sd(n),s=sd(e);return eu.exports.merge(r,s)}function sd(n){var e,r,s,a;const l={};if(!Pn(n))return l;for(const[p,f]of Object.entries(n)){const g=vu(p)?[p]:f.chains,w=f.methods||[],S=f.events||[],T=f.rpcMap||{},j=Ro(p);l[j]=k5(Co(Co({},l[j]),f),{chains:Ic(g,(e=l[j])==null?void 0:e.chains),methods:Ic(w,(r=l[j])==null?void 0:r.methods),events:Ic(S,(s=l[j])==null?void 0:s.events),rpcMap:Co(Co({},T),(a=l[j])==null?void 0:a.rpcMap)})}return l}function W5(n){return n.includes(":")?n.split(":")[2]:n}function J5(n){const e={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],l=s.events||[],p=s.accounts||[],f=vu(r)?[r]:s.chains?s.chains:Lp(s.accounts);e[r]={chains:f,methods:a,events:l,accounts:p}}return e}const jp={},Ft=n=>jp[n],Mc=(n,e)=>{jp[n]=e};class Y5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||Mr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mr(e,this.namespace);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class X5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const s=tu(e);if(!this.httpProviders[s]){const a=r||Mr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,a)}this.chainId=s,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const s=r||Mr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=tu(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,s;let a=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class Q5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||Mr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class Z5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||Mr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class eS{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r);e[r]=this.createHttpProvider(r,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class tS{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||Mr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}class rS{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ft("events"),this.client=Ft("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const s=r||Mr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit($i.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||Mr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Fi(new sn(s,Ft("disableProviderPing")))}}var iS=Object.defineProperty,nS=Object.defineProperties,sS=Object.getOwnPropertyDescriptors,od=Object.getOwnPropertySymbols,oS=Object.prototype.hasOwnProperty,aS=Object.prototype.propertyIsEnumerable,ad=(n,e,r)=>e in n?iS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,Ao=(n,e)=>{for(var r in e||(e={}))oS.call(e,r)&&ad(n,r,e[r]);if(od)for(var r of od(e))aS.call(e,r)&&ad(n,r,e[r]);return n},Lc=(n,e)=>nS(n,sS(e));class xu{constructor(e){this.events=new nu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ze.pino(Ze.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||td})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new xu(e);return await r.initialize(),r}async request(e,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ao({},e),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(e,r,s){this.request(e,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Tt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=J5(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Up)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[s,a]=this.validateChain(e);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ri(r)){for(const s of r)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await T5.init({logger:this.providerOpts.logger||td,relayUrl:this.providerOpts.relayUrl||U5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Ro(r)))];Mc("client",this.client),Mc("events",this.events),Mc("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const s=V5(r,this.session),a=Lp(s),l=G5(this.namespaces,this.optionalNamespaces),p=Lc(Ao({},l[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new X5({namespace:p});break;case"solana":this.rpcProviders[r]=new Q5({namespace:p});break;case"cosmos":this.rpcProviders[r]=new Z5({namespace:p});break;case"polkadot":this.rpcProviders[r]=new Y5({namespace:p});break;case"cip34":this.rpcProviders[r]=new eS({namespace:p});break;case"elrond":this.rpcProviders[r]=new tS({namespace:p});break;case"multiversx":this.rpcProviders[r]=new rS({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&ri(a)&&this.events.emit("accountsChanged",a.map(W5))}else s.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var s;const{namespaces:a}=r,l=(s=this.client)==null?void 0:s.session.get(e);this.session=Lc(Ao({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Lc(Ao({},Tt("USER_DISCONNECTED")),{data:e.topic}))}),this.on($i.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=e;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(e){const[r,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(p=>Ro(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=Ro(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){var s;if(!this.namespaces)return;const[a,l]=this.validateChain(e);r||this.getProvider(a).setDefaultChain(l),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${rd}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${rd}/${e}`)}}const cS=xu,uS="wc",hS="ethereum_provider",lS=`${uS}@2:${hS}:`,fS="https://rpc.walletconnect.com/v1/",ru=["eth_sendTransaction","personal_sign"],dS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],iu=["chainChanged","accountsChanged"],pS=["message","disconnect","connect"];var gS=Object.defineProperty,vS=Object.defineProperties,yS=Object.getOwnPropertyDescriptors,cd=Object.getOwnPropertySymbols,_S=Object.prototype.hasOwnProperty,mS=Object.prototype.propertyIsEnumerable,ud=(n,e,r)=>e in n?gS(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,fs=(n,e)=>{for(var r in e||(e={}))_S.call(e,r)&&ud(n,r,e[r]);if(cd)for(var r of cd(e))mS.call(e,r)&&ud(n,r,e[r]);return n},hd=(n,e)=>vS(n,yS(e));function qo(n){return Number(n[0].split(":")[1])}function jc(n){return`0x${n.toString(16)}`}function bS(n){const{chains:e,optionalChains:r,methods:s,optionalMethods:a,events:l,optionalEvents:p,rpcMap:f}=n;if(!ri(e))throw new Error("Invalid chains");const g={chains:e,methods:s||ru,events:l||iu,rpcMap:fs({},e.length?{[qo(e)]:f[qo(e)]}:{})},w=l==null?void 0:l.filter(P=>!iu.includes(P)),S=s==null?void 0:s.filter(P=>!ru.includes(P));if(!r&&!p&&!a&&!(w!=null&&w.length)&&!(S!=null&&S.length))return{required:e.length?g:void 0};const T=(w==null?void 0:w.length)&&(S==null?void 0:S.length)||!r,j={chains:[...new Set(T?g.chains.concat(r||[]):r)],methods:[...new Set(g.methods.concat(a!=null&&a.length?a:dS))],events:[...new Set(g.events.concat(p||pS))],rpcMap:f};return{required:e.length?g:void 0,optional:r.length?j:void 0}}class Ou{constructor(){this.events=new Lr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=lS,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new Ou;return await r.initialize(e),r}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,r){this.signer.sendAsync(e,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:s}=bS(this.rpc);try{const a=await new Promise(async(p,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(w=>{!w.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(hd(fs({namespaces:fs({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(w=>{p(w)}).catch(w=>{f(new Error(w.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const l=Hw(a.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:jc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",jc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",hd(fs({},Tt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",jc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,s,a]=e.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,s;const a=(r=e==null?void 0:e.chains)!=null?r:[],l=(s=e==null?void 0:e.optionalChains)!=null?s:[],p=a.concat(l);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=a.length?(e==null?void 0:e.methods)||ru:[],g=a.length?(e==null?void 0:e.events)||iu:[],w=(e==null?void 0:e.optionalMethods)||[],S=(e==null?void 0:e.optionalEvents)||[],T=(e==null?void 0:e.rpcMap)||this.buildRpcMap(p,e.projectId),j=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(P=>this.formatChainId(P)),optionalChains:l.map(P=>this.formatChainId(P)),methods:f,events:g,optionalMethods:w,optionalEvents:S,rpcMap:T,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:j,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const s={};return e.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?qo(this.rpc.chains):qo(this.rpc.optionalChains),this.signer=await cS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await mm(()=>import("./index-458ef0e9.js").then(a=>a.i),["assets/index-458ef0e9.js","assets/index-4c8bc759.js","assets/index-55b1abd2.css"]);r=s}catch(s){throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(fs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:s,rpcMap:a}=e;r&&ri(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),s&&ri(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(l=>this.formatChainId(l)),s.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(e,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${fS}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const RS=Ou;export{RS as EthereumProvider,pS as OPTIONAL_EVENTS,dS as OPTIONAL_METHODS,iu as REQUIRED_EVENTS,ru as REQUIRED_METHODS,Ou as default};
